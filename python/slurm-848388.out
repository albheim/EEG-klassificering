data dir
/lunarc/nobackup/users/albheim/EEG-klassificering
script
#!/bin/sh
#SBATCH -t 99:00:00
#SBATCH -J c2d_fix
#SBATCH -A lu2018-2-3
#// SBATCH -o stdout_%j.out
#// SBATCH -e stderr_%j.err

# shold be lu or gpu
#SBATCH -p gpu

# how many gpus, 4 per node, using many seems to crash more often so stick with 1
#SBATCH --gres=gpu:4

# use 5 cores per GPU
#SBATCH -n 20
#SBATCH --mem-per-cpu=3100

DATA_DIR="$(cat ../data_location.txt)"
echo "data dir"
echo $DATA_DIR

echo "script"
cat $0

PY_FILE="conv2d_spect.py"
echo "py file"
cat $PY_FILE

echo "data file"
cat "data.py"

echo "mat file"
cat "../matlab/save transformed/savetf.m"

echo "nvidia smi"
nvidia-smi

echo "start time"
date

cp -r "${DATA_DIR}/DATA" $SNIC_TMP
ls $SNIC_TMP
du -h "${SNIC_TMP}/DATA"

echo "copy done time"
date

#matlab -nodisplay -nosplash -nodesktop -r "run('../matlab/save transformed/savetf.m');"
idxs=(1 2 3 4 5 6 7 8 9 11 12 13 14 15 16 17 18 19)
for i in ${idxs[@]}; do
    python $PY_FILE $SNIC_TMP $i
done

echo "end time"
date
py file
import sys
from datetime import datetime

import numpy as np
from scipy import io

import tensorflow as tf

from keras.models import Model
from keras.layers import Dense, Dropout, Input, GaussianNoise, BatchNormalization
from keras.layers import Lambda
from keras.layers import Conv2D, MaxPooling2D, AveragePooling2D
from keras.layers import ELU, Activation, Flatten

from keras import backend as K
from keras import regularizers as rg

from tensorflow.python.client import device_lib
print(device_lib.list_local_devices())

import data
import util

funcs = ["spec", "wig", "amb", "slep"]#["spec", "wig", "amb", "cwt", "slep"]
sub = int(sys.argv[2])

splits = 10

for func in funcs:
    x, y = data.load_transform([sub], func)
    xt, yt = data.load_transform([sub], func, test=True)

    m_in = Input(shape=x[0][0].shape)

    m_t = Conv2D(4, (8, 4), padding='same')(m_in) #, kernel_regularizer=rg.l1(0.01)
    #m_t = BatchNormalization()(m_t)
    m_t = ELU()(m_t)
    m_t = AveragePooling2D((4, 4))(m_t)
    m_t = Dropout(0.2)(m_t)

    m_t = Conv2D(8, (8, 4), padding='same')(m_t)
    #m_t = BatchNormalization()(m_t)
    m_t = ELU()(m_t)
    m_t = AveragePooling2D((4, 4))(m_t)
    m_t = Dropout(0.3)(m_t)

    m_t = Conv2D(16, (8, 4), padding='same')(m_t)
    #m_t = BatchNormalization()(m_t)
    m_t = ELU()(m_t)
    m_t = AveragePooling2D((4, 4))(m_t)
    m_t = Dropout(0.3)(m_t)

    m_t = Flatten()(m_t)
    m_t = Dense(15, kernel_regularizer=rg.l1(0.01))(m_t)
    #m_t = BatchNormalization()(m_t)
    m_t = Activation('tanh')(m_t)
    m_out = Dense(3, activation='softmax')(m_t)

    model = Model(inputs=m_in, outputs=m_out)

    m_save = model.get_config()
    model.summary()

    acc = 0
    acc2 = 0
    for tr, val in util.kfold(len(x[0]), splits, shuffle=True):

        model = Model.from_config(m_save)
        model.compile(loss='categorical_crossentropy',
                      optimizer='adam',
                      metrics=['accuracy'])
        # fit with next kfold data
        h = model.fit(x[0][tr], y[0][tr],
                      #validation_data=(x[0][val], y[0][val]),
                      batch_size=16, epochs=50, verbose=0)

        _, a = model.evaluate(x[0][val], y[0][val], verbose=0)
        _, a2 = model.evaluate(xt[0], yt[0], verbose=0)
        acc += a
        acc2 += a2

    acc /= splits
    acc2 /= splits

    print("sub {} with {} gave avg accuracy {}/{} over {} splits".format(sub, func, acc, acc2, splits))
data file
import sys

import numpy as np
from scipy import io
import h5py


def load_single_sub(sub, cut=True, study=True, shuffle=True, visual=True, transpose=False, user="Albin"):
    if user=="Damir":
        snic_tmp = "/Users/damir/Documents/EEG-data"
    else:
        snic_tmp = "C:/Users/Albin Heimerson/Desktop/exjobb/DATA"
    if len(sys.argv) > 1:
        snic_tmp = str(sys.argv[1]) + "/DATA"
    xn = None
    yn = None
    names = ["FA", "LM", "OB"]
    for i in range(3):
        name = "Subj{:02}_CleanData_{}_{}".format(sub,
                                                  'study' if study else 'test',
                                                  names[i])
        if not study:
            name += "_{}".format("visual" if visual else "lexical")

        print("loading: ", name)

        m = io.loadmat('{}/{}/{}.mat'.format(snic_tmp,
                                                  "Visual" if visual else "Verbal",
                                                  name))
        trials = m[name][0][0][2][0]
        for j in range(trials.shape[0]):
            if cut is True:
                trials[j] = trials[j][:, 768:1536]
            elif cut is not False:
                trials[j] = trials[j][:, cut[0]:cut[1]]
            if transpose:
                trials[j] = trials[j].T
        labels = np.zeros((trials.shape[0], 3))
        labels[:, i] = 1
        if xn is None:
            xn = trials
            yn = labels
        else:
            xn = np.concatenate((xn, trials), axis=0)
            yn = np.concatenate((yn, labels), axis=0)

    xn = np.stack(xn, axis=0)
    n = xn.shape[0]
    s = np.arange(n)
    if shuffle:
        np.random.shuffle(s)

    return (xn[s], yn[s])


def load_single(idx=None, cut=True, shuffle=True, visual=True, transpose=False,
                study=True):
    x = []
    y = []

    if idx is None:
        if visual:
            idx = [i if i < 10 else i + 1 for i in range(1, 19)]
        else:
            idx = [1, 2, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22]

    for sub in idx:
        xn, yn = load_single_sub(sub, cut, study, shuffle, visual, transpose)
        x.append(xn)
        y.append(yn)

    return (x, y)


def load_all(cut=True, visual=True, study=True, transpose=False):
    x = None
    y = None

    if visual:
        subs = [i if i < 10 else i + 1 for i in range(1, 19)]
    else:
        subs = [1, 2, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22]

    for sub in subs:  # 19 is max
        xn, yn = load_single_sub(sub, cut, study, False, visual, transpose)
        if x is None:
            x = xn
            y = yn
        else:
            x = np.concatenate((x, xn), axis=0)
            y = np.concatenate((y, yn), axis=0)

    print(x.shape, y.shape)
    x = np.stack(x, axis=0)
    print(x.shape)
    s = np.arange(x.shape[0])
    np.random.shuffle(s)

    return (x[s], y[s])


def load_marg(cut=None, visual=True, shuffle=True):
    snic_tmp = "C:/Users/Albin Heimerson/Desktop/exjobb"
    if len(sys.argv) > 1:
        snic_tmp = str(sys.argv[1])
    x = []
    y = []
    if visual:
        subs = [i if i < 10 else i + 1 for i in range(1, 19)]
    else:
        subs = [1, 2, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22]
    for sub in subs:
        xn = None
        yn = None
        for i in range(3):
            name = "Subj{:02}_{}_marg".format(sub, "Visual" if visual else "Verbal")
            print("loading: ", name)
            m = io.loadmat('{}/DATA/Modified/marginal/{}.mat'.format(snic_tmp, name))

            trials = m['data'][0][0][i][:, 0]
            if cut is not None:
                for j in range(trials.shape[0]):
                    trials[j] = trials[j][:, cut[0]:cut[1]]
            labels = np.zeros((trials.shape[0], 3))
            labels[:, i] = 1
            if xn is None:
                xn = trials
                yn = labels
            else:
                xn = np.concatenate((xn, trials), axis=0)
                yn = np.concatenate((yn, labels), axis=0)

        xn = np.stack(xn, axis=0)
        n = xn.shape[0]
        s = np.arange(n)
        if shuffle:
            np.random.shuffle(s)
        x.append(xn[s])
        y.append(yn[s])

    print(x[0].shape)
    return (x, y)


def cut(data, cut=[768, 1536], tcut = None):
    if tcut is not None:
        cut[0] = int(512 * tcut[0] + 768)
        cut[1] = int(512 * tcut[1] + 768)
    print(cut)
    for sub in range(len(data)):
        data[sub] = data[sub][:, :, cut[0]:cut[1]]


def modify(x, y, n, nmult=0, displacement=0, cut=[768, 1536]):
    mdata = [None for i in range(len(x))]
    my = [None for i in range(len(x))]
    for sub in range(len(mdata)):
        s = x[sub].shape[0]
        my[sub] = np.zeros((s * n, 3))
        for j in range(0, s * n, s):
            my[sub][j:j + s] = y[sub]
        mdata[sub] = np.zeros((s * n, x[sub].shape[1], cut[1] - cut[0]))
        mdata[sub][:s, :, :] = x[sub][:, :, cut[0]:cut[1]]
        for j in range(s, s * n, s):
            for i in range(len(x[sub])):
                if displacement > 0:
                    d = np.random.randint(-displacement, displacement + 1)
                    mdata[sub][j:j + s, :, :] = x[sub][:, :, cut[0] + d:cut[1] + d]

                if nmult != 0:
                    for k in range(mdata[sub][i].shape[0]):
                        mdata[sub][j + i, k] += nmult * np.std(mdata[sub][i, k]) * np.random.ranf(mdata[sub][i, k].shape)

    return mdata, my


def load_transform(idx, trans, test=False):
    snic_tmp = "C:/Users/Albin Heimerson/Desktop/exjobb"
    if len(sys.argv) > 1:
        snic_tmp = str(sys.argv[1])
    x = []
    y = []
    for sub in idx:
        fname = '{}/DATA/Modified/spectogram/{}_{:02}{}.mat'.format(snic_tmp, trans, sub, 
                                                                    '_t' if test else '')
        print(fname)
        with h5py.File(fname) as f:
            t = f['Y']
            print(t.shape)
            yn = np.zeros((t.shape[1], 3))
            for i in range(t.shape[1]):
                yn[i, int(t[0, i]) - 1] = 1

            y.append(yn)

            t = f['Xt']
            print(t.shape)
            xn = [None for i in range(t.shape[1])]
            for i in range(t.shape[1]):
                xn[i] = np.array(f[t[0, i]])

            xn = np.stack(xn, 0)

            if len(xn.shape) < 4:
                xn = xn[:, :, :, np.newaxis]
            else:
                xn = np.transpose(xn, (0, 2, 3, 1))

            print(xn.shape)
            print(xn[0].shape)
            x.append(xn)

    return (x, y)


def load_spect_downsample(visual=True, shuffle=True, ds=8):
    snic_tmp = "C:/Users/Albin Heimerson/Desktop/exjobb"
    if len(sys.argv) > 1:
        snic_tmp = str(sys.argv[1])
    x = []
    y = []
    if visual:
        subs = [i if i < 10 else i + 1 for i in range(2, 19)] # change to 1
    else:
        subs = [1, 2, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22]
    for sub in subs:
        xn = None
        yn = None
        for i in range(3):
            name = "Subj{:02}_{}_spec{}".format(sub, "Visual" if visual else "Verbal", ds)
            print("loading: ", name)
            m = io.loadmat('{}/DATA/Modified/spect_downsample/{}.mat'.format(snic_tmp, name))

            trials = m['data'][0][0][i][:, 0]
            labels = np.zeros((trials.shape[0], 3))
            labels[:, i] = 1
            if xn is None:
                xn = trials
                yn = labels
            else:
                xn = np.concatenate((xn, trials), axis=0)
                yn = np.concatenate((yn, labels), axis=0)

        xn = np.stack(xn, axis=0)
        n = xn.shape[0]
        s = np.arange(n)
        if shuffle:
            np.random.shuffle(s)
        x.append(xn[s])
        y.append(yn[s])

    print(x[0].shape)
    return (x, y)
mat file
clear; clc; close all
addpath('..')
addpath('../borrowed code')

for idx = [1 2 3 4 5 6 7 8 9 11 12 13 14 15 16 17 18 19]
    sub = sprintf('%02d', idx);
    [X,Y,n] = aux_load('Visual',sub,1);

    param.L = 32; param.Fs = 512; param.NFFT = 512; param.NSTEP = 1; 
    param.method = 'wig'; param.NW = 3;

    %X = aux_chan(X,[5 24 29]);
    X = aux_extr(X, 769:1536);
    X = aux_deci(X,4);
    %X = aux_svd(X, 1);

    ms = ["spec", "slep", "wig", "amb"];%["spec", "wig", "amb", "cwt", "slep"]
    for method = ms
        Xt = aux_transform(X, method, param);

        for i = 1:length(Xt)
            Xt{i} = real(permute(Xt{i}, [2 3 1]));
        end
        method
        size(Xt{1})

        %save(sprintf('C:\\Users\\Albin Heimerson\\Desktop\\exjobb\\DATA\\Modified\\spectogram\\%s_%s.mat', method, sub), 'Xt', 'Y', '-v7.3')

        save(sprintf('/lunarc/nobackup/users/albheim/EEG-klassificering/DATA/Modified/spectogram/%s_%s_t.mat', method, sub), 'Xt', 'Y', '-v7.3')
    end
end

nvidia smi
Thu May 31 11:03:15 2018       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 390.46                 Driver Version: 390.46                    |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:04:00.0 Off |                    0 |
| N/A   25C    P8    27W / 149W |      0MiB / 11441MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:05:00.0 Off |                    0 |
| N/A   31C    P8    31W / 149W |      0MiB / 11441MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   2  Tesla K80           On   | 00000000:84:00.0 Off |                    0 |
| N/A   24C    P8    26W / 149W |      0MiB / 11441MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   3  Tesla K80           On   | 00000000:85:00.0 Off |                    0 |
| N/A   30C    P8    30W / 149W |      0MiB / 11441MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
start time
Thu May 31 11:03:15 CEST 2018
DATA
2.4G	/local/slurmtmp.848388/DATA/Visual
2.4G	/local/slurmtmp.848388/DATA/Verbal
388M	/local/slurmtmp.848388/DATA/Modified/marginal
302G	/local/slurmtmp.848388/DATA/Modified/spectogram
302G	/local/slurmtmp.848388/DATA/Modified
307G	/local/slurmtmp.848388/DATA
copy done time
Thu May 31 12:00:35 CEST 2018
2018-05-31 12:01:10.215718: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-31 12:01:25.197304: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 12:01:25.363207: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 12:01:25.520996: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 12:01:25.684919: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 12:01:26.369314: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-31 12:01:26.369604: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-31 12:01:26.369670: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-31 12:01:26.369717: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-31 12:01:26.369760: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-31 12:01:26.369838: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-31 12:01:26.369918: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-31 12:01:26.369985: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-31 12:01:26.370036: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-31 12:01:26.370083: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-31 12:03:24.681925: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-31 12:03:24.682408: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-31 12:03:24.682451: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-31 12:03:24.682471: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 11113771784598860613
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 12438971388497272244
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 1716993844017570314
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 5779085889022628792
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 2692561866313787531
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.848388/DATA/Modified/spectogram/spec_01.mat
(1, 185)
(1, 185)
(185, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/spec_01_t.mat
(1, 90)
(1, 90)
(90, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 1 with spec gave avg accuracy 0.6154970794916153/0.3311111126674546 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/wig_01.mat
(1, 185)
(1, 185)
(185, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/wig_01_t.mat
(1, 90)
(1, 90)
(90, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 1 with wig gave avg accuracy 0.5885964959859848/0.3055555589000384 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/amb_01.mat
(1, 185)
(1, 185)
(185, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/amb_01_t.mat
(1, 90)
(1, 90)
(90, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 1 with amb gave avg accuracy 0.6154970914125443/0.29111111260122724 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/slep_01.mat
(1, 185)
(1, 185)
(185, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/slep_01_t.mat
(1, 90)
(1, 90)
(90, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 1 with slep gave avg accuracy 0.552923983335495/0.33888889160421154 over 10 splits
2018-05-31 15:38:42.020626: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-31 15:38:42.236784: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 15:38:42.357625: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 15:38:42.500944: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 15:38:42.649688: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 15:38:42.650675: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-31 15:38:42.650874: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-31 15:38:42.650921: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-31 15:38:42.650954: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-31 15:38:42.651039: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-31 15:38:42.651072: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-31 15:38:42.651121: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-31 15:38:42.651158: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-31 15:38:42.651189: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-31 15:38:42.651219: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-31 15:39:23.928569: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-31 15:39:23.928693: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-31 15:39:23.928717: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-31 15:39:23.928735: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 4194919316520055611
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 14657076254988981384
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 15130304342051783762
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 9152487426400480246
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 16288695394373779181
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.848388/DATA/Modified/spectogram/spec_02.mat
(1, 187)
(1, 187)
(187, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/spec_02_t.mat
(1, 74)
(1, 74)
(74, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 2 with spec gave avg accuracy 0.540350878238678/0.34189189277790694 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/wig_02.mat
(1, 187)
(1, 187)
(187, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/wig_02_t.mat
(1, 74)
(1, 74)
(74, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 2 with wig gave avg accuracy 0.5441520482301712/0.3581081086920726 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/amb_02.mat
(1, 187)
(1, 187)
(187, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/amb_02_t.mat
(1, 74)
(1, 74)
(74, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 2 with amb gave avg accuracy 0.5292397767305375/0.34594594751660884 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/slep_02.mat
(1, 187)
(1, 187)
(187, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/slep_02_t.mat
(1, 74)
(1, 74)
(74, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 2 with slep gave avg accuracy 0.5502924054861069/0.3554054069357949 over 10 splits
2018-05-31 19:20:26.128917: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-31 19:20:26.407535: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 19:20:26.536224: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 19:20:26.676087: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 19:20:26.832593: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 19:20:26.833313: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-31 19:20:26.833419: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-31 19:20:26.833445: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-31 19:20:26.833462: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-31 19:20:26.833499: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-31 19:20:26.833518: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-31 19:20:26.833546: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-31 19:20:26.833568: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-31 19:20:26.833585: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-31 19:20:26.833602: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-31 19:21:15.493671: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-31 19:21:15.493800: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-31 19:21:15.493824: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-31 19:21:15.493842: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 11431770711879414605
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 5716445712706768823
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 9968607267631768791
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 3470116567501789518
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 3449765910064241042
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.848388/DATA/Modified/spectogram/spec_03.mat
(1, 186)
(1, 186)
(186, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/spec_03_t.mat
(1, 130)
(1, 130)
(130, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 3 with spec gave avg accuracy 0.7692982435226441/0.3153846153846154 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/wig_03.mat
(1, 186)
(1, 186)
(186, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/wig_03_t.mat
(1, 130)
(1, 130)
(130, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 3 with wig gave avg accuracy 0.721052634716034/0.31153846153846154 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/amb_03.mat
(1, 186)
(1, 186)
(186, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/amb_03_t.mat
(1, 130)
(1, 130)
(130, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 3 with amb gave avg accuracy 0.7353801250457763/0.32769230769230767 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/slep_03.mat
(1, 186)
(1, 186)
(186, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/slep_03_t.mat
(1, 130)
(1, 130)
(130, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 3 with slep gave avg accuracy 0.6827485352754593/0.30999999999999994 over 10 splits
2018-05-31 23:06:13.752384: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-31 23:06:13.970438: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 23:06:14.089139: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 23:06:14.237526: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 23:06:14.403025: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 23:06:14.404044: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-31 23:06:14.404255: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-31 23:06:14.404303: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-31 23:06:14.404337: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-31 23:06:14.404401: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-31 23:06:14.404437: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-31 23:06:14.404490: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-31 23:06:14.404530: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-31 23:06:14.404565: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-31 23:06:14.404598: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-31 23:06:58.822017: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-31 23:06:58.822143: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-31 23:06:58.822168: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-31 23:06:58.822187: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 10131186125338079634
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 1335357507977900738
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 5262141362212730990
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 14364108085749737904
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 1599926034540645842
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.848388/DATA/Modified/spectogram/spec_04.mat
(1, 185)
(1, 185)
(185, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/spec_04_t.mat
(1, 96)
(1, 96)
(96, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 4 with spec gave avg accuracy 0.5912280738353729/0.3427083333333333 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/wig_04.mat
(1, 185)
(1, 185)
(185, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/wig_04_t.mat
(1, 96)
(1, 96)
(96, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 4 with wig gave avg accuracy 0.679824560880661/0.3541666666666667 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/amb_04.mat
(1, 185)
(1, 185)
(185, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/amb_04_t.mat
(1, 96)
(1, 96)
(96, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 4 with amb gave avg accuracy 0.6766081869602203/0.3322916666666667 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/slep_04.mat
(1, 185)
(1, 185)
(185, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/slep_04_t.mat
(1, 96)
(1, 96)
(96, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 4 with slep gave avg accuracy 0.6055555641651154/0.334375 over 10 splits
2018-06-01 02:46:53.922115: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-06-01 02:46:54.169627: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-01 02:46:54.308765: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-01 02:46:54.470760: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-01 02:46:54.617103: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-01 02:46:54.617801: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-06-01 02:46:54.617920: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-06-01 02:46:54.617950: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-06-01 02:46:54.617978: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-06-01 02:46:54.618023: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-06-01 02:46:54.618044: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-06-01 02:46:54.618077: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-06-01 02:46:54.618103: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-06-01 02:46:54.618124: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-06-01 02:46:54.618144: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-06-01 02:47:56.915700: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-06-01 02:47:56.915814: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-06-01 02:47:56.915839: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-06-01 02:47:56.915857: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 5288059211524721693
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 11963480892810839180
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 5624677515897598869
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 2539636359581079958
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 16764446172665456742
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.848388/DATA/Modified/spectogram/spec_05.mat
(1, 187)
(1, 187)
(187, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/spec_05_t.mat
(1, 109)
(1, 109)
(109, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 5 with spec gave avg accuracy 0.6426900506019593/0.30275229387190367 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/wig_05.mat
(1, 187)
(1, 187)
(187, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/wig_05_t.mat
(1, 109)
(1, 109)
(109, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 5 with wig gave avg accuracy 0.6625730991363525/0.2963302753318887 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/amb_05.mat
(1, 187)
(1, 187)
(187, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/amb_05_t.mat
(1, 109)
(1, 109)
(109, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 5 with amb gave avg accuracy 0.6304093539714813/0.29541284433061926 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/slep_05.mat
(1, 187)
(1, 187)
(187, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/slep_05_t.mat
(1, 109)
(1, 109)
(109, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 5 with slep gave avg accuracy 0.6032163709402084/0.3201834864641001 over 10 splits
2018-06-01 06:28:52.100015: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-06-01 06:28:52.367774: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-01 06:28:52.485170: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-01 06:28:52.631910: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-01 06:28:52.767269: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-01 06:28:52.767973: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-06-01 06:28:52.768092: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-06-01 06:28:52.768121: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-06-01 06:28:52.768164: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-06-01 06:28:52.768186: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-06-01 06:28:52.768203: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-06-01 06:28:52.768237: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-06-01 06:28:52.768262: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-06-01 06:28:52.768284: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-06-01 06:28:52.768304: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-06-01 06:29:40.713277: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-06-01 06:29:40.713394: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-06-01 06:29:40.713417: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-06-01 06:29:40.713435: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 841691949592541345
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 7431020256121488791
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 4850067227060938987
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 13761591046703774303
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 6586550064568405793
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.848388/DATA/Modified/spectogram/spec_06.mat
(1, 184)
(1, 184)
(184, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/spec_06_t.mat
(1, 121)
(1, 121)
(121, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 6 with spec gave avg accuracy 0.55497075766325/0.308264462317317 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/wig_06.mat
(1, 184)
(1, 184)
(184, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/wig_06_t.mat
(1, 121)
(1, 121)
(121, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 6 with wig gave avg accuracy 0.5929824620485306/0.3041322308138382 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/amb_06.mat
(1, 184)
(1, 184)
(184, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/amb_06_t.mat
(1, 121)
(1, 121)
(121, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 6 with amb gave avg accuracy 0.6204678326845169/0.3223140500178022 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/slep_06.mat
(1, 184)
(1, 184)
(184, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/slep_06_t.mat
(1, 121)
(1, 121)
(121, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 6 with slep gave avg accuracy 0.620175439119339/0.3107438004952817 over 10 splits
2018-06-01 10:13:42.692843: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-06-01 10:13:43.027770: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-01 10:13:43.178560: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-01 10:13:43.340333: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-01 10:13:43.490130: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-01 10:13:43.490834: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-06-01 10:13:43.490953: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-06-01 10:13:43.491007: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-06-01 10:13:43.491053: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-06-01 10:13:43.491076: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-06-01 10:13:43.491095: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-06-01 10:13:43.491143: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-06-01 10:13:43.491174: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-06-01 10:13:43.491197: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-06-01 10:13:43.491219: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-06-01 10:14:24.689327: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-06-01 10:14:24.689447: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-06-01 10:14:24.689470: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-06-01 10:14:24.689488: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 6803339854468221817
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 9203582248354510349
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 17956262428452233850
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 8153874809980618188
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 5134786203401219702
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.848388/DATA/Modified/spectogram/spec_07.mat
(1, 188)
(1, 188)
(188, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/spec_07_t.mat
(1, 87)
(1, 87)
(87, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 7 with spec gave avg accuracy 0.6324561476707459/0.3160919538131733 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/wig_07.mat
(1, 188)
(1, 188)
(188, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/wig_07_t.mat
(1, 87)
(1, 87)
(87, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 7 with wig gave avg accuracy 0.6646198838949203/0.3367816091226093 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/amb_07.mat
(1, 188)
(1, 188)
(188, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/amb_07_t.mat
(1, 87)
(1, 87)
(87, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 7 with amb gave avg accuracy 0.6961988389492035/0.3068965512788159 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/slep_07.mat
(1, 188)
(1, 188)
(188, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/slep_07_t.mat
(1, 87)
(1, 87)
(87, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 7 with slep gave avg accuracy 0.6099415242671966/0.3310344832424802 over 10 splits
2018-06-01 13:54:40.644630: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-06-01 13:54:40.869009: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-01 13:54:41.001906: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-01 13:54:41.163525: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-01 13:54:41.311059: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-01 13:54:41.311763: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-06-01 13:54:41.311880: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-06-01 13:54:41.311909: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-06-01 13:54:41.311951: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-06-01 13:54:41.311985: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-06-01 13:54:41.312005: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-06-01 13:54:41.312039: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-06-01 13:54:41.312064: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-06-01 13:54:41.312086: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-06-01 13:54:41.312106: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-06-01 13:55:28.639681: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-06-01 13:55:28.639800: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-06-01 13:55:28.639824: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-06-01 13:55:28.639842: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 16073012855194160872
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 1946216578071321076
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 6455623277178473986
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 2621536663762788692
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 1822883338973141082
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.848388/DATA/Modified/spectogram/spec_08.mat
(1, 190)
(1, 190)
(190, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/spec_08_t.mat
(1, 113)
(1, 113)
(113, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 8 with spec gave avg accuracy 0.6736842155456543/0.34070796476660575 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/wig_08.mat
(1, 190)
(1, 190)
(190, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/wig_08_t.mat
(1, 113)
(1, 113)
(113, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 8 with wig gave avg accuracy 0.6210526317358017/0.3398230095715385 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/amb_08.mat
(1, 190)
(1, 190)
(190, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/amb_08_t.mat
(1, 113)
(1, 113)
(113, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 8 with amb gave avg accuracy 0.6473684221506119/0.3353982307742127 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/slep_08.mat
(1, 190)
(1, 190)
(190, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/slep_08_t.mat
(1, 113)
(1, 113)
(113, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 8 with slep gave avg accuracy 0.6473684191703797/0.3407079652512232 over 10 splits
2018-06-01 17:45:39.169838: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-06-01 17:45:39.392841: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-01 17:45:39.513433: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-01 17:45:39.671559: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-01 17:45:39.820452: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-01 17:45:39.821152: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-06-01 17:45:39.821270: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-06-01 17:45:39.821322: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-06-01 17:45:39.821345: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-06-01 17:45:39.821362: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-06-01 17:45:39.821380: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-06-01 17:45:39.821409: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-06-01 17:45:39.821437: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-06-01 17:45:39.821458: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-06-01 17:45:39.821477: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-06-01 17:46:22.520098: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-06-01 17:46:22.520219: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-06-01 17:46:22.520243: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-06-01 17:46:22.520261: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 6106142598859113755
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 751338706928970776
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 7759381397691841646
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 5880201589362240728
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 627056289985667355
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.848388/DATA/Modified/spectogram/spec_09.mat
(1, 186)
(1, 186)
(186, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/spec_09_t.mat
(1, 83)
(1, 83)
(83, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 9 with spec gave avg accuracy 0.5874269038438797/0.31084337314388844 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/wig_09.mat
(1, 186)
(1, 186)
(186, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/wig_09_t.mat
(1, 83)
(1, 83)
(83, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 9 with wig gave avg accuracy 0.575438603758812/0.31807228998247405 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/amb_09.mat
(1, 186)
(1, 186)
(186, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/amb_09_t.mat
(1, 83)
(1, 83)
(83, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 9 with amb gave avg accuracy 0.6321637481451035/0.33373494001038106 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/slep_09.mat
(1, 186)
(1, 186)
(186, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/slep_09_t.mat
(1, 83)
(1, 83)
(83, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 9 with slep gave avg accuracy 0.5485380113124847/0.32771084346325996 over 10 splits
2018-06-01 21:25:41.205935: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-06-01 21:25:41.435807: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-01 21:25:41.559384: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-01 21:25:41.707915: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-01 21:25:41.844530: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-01 21:25:41.845231: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-06-01 21:25:41.845352: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-06-01 21:25:41.845405: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-06-01 21:25:41.845428: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-06-01 21:25:41.845447: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-06-01 21:25:41.845465: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-06-01 21:25:41.845497: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-06-01 21:25:41.845522: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-06-01 21:25:41.845543: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-06-01 21:25:41.845563: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-06-01 21:26:26.374916: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-06-01 21:26:26.375048: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-06-01 21:26:26.375072: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-06-01 21:26:26.375090: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 10151310793112612027
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 4567922415029241192
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 9935407468179123646
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 1808873477151975230
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 12206336410679379088
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.848388/DATA/Modified/spectogram/spec_11.mat
(1, 182)
(1, 182)
(182, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/spec_11_t.mat
(1, 98)
(1, 98)
(98, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 11 with spec gave avg accuracy 0.5280701875686645/0.32551020408163267 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/wig_11.mat
(1, 182)
(1, 182)
(182, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/wig_11_t.mat
(1, 98)
(1, 98)
(98, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 11 with wig gave avg accuracy 0.5119883060455322/0.3204081632653061 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/amb_11.mat
(1, 182)
(1, 182)
(182, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/amb_11_t.mat
(1, 98)
(1, 98)
(98, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 11 with amb gave avg accuracy 0.5274853885173798/0.3142857142857142 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/slep_11.mat
(1, 182)
(1, 182)
(182, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/slep_11_t.mat
(1, 98)
(1, 98)
(98, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 11 with slep gave avg accuracy 0.4730994164943695/0.31326530612244896 over 10 splits
2018-06-02 01:05:01.606598: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-06-02 01:05:01.839966: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-02 01:05:01.964775: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-02 01:05:02.109514: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-02 01:05:02.242530: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-02 01:05:02.243236: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-06-02 01:05:02.243356: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-06-02 01:05:02.243408: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-06-02 01:05:02.243431: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-06-02 01:05:02.243450: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-06-02 01:05:02.243467: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-06-02 01:05:02.243498: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-06-02 01:05:02.243526: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-06-02 01:05:02.243548: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-06-02 01:05:02.243568: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-06-02 01:05:47.020123: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-06-02 01:05:47.020249: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-06-02 01:05:47.020275: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-06-02 01:05:47.020293: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 17556007979882881994
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 2403096484808012550
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 1683391326900590569
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 8859203738963252463
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 2242700778654350798
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.848388/DATA/Modified/spectogram/spec_12.mat
(1, 190)
(1, 190)
(190, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/spec_12_t.mat
(1, 95)
(1, 95)
(95, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 12 with spec gave avg accuracy 0.6473684310913086/0.2999999992157284 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/wig_12.mat
(1, 190)
(1, 190)
(190, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/wig_12_t.mat
(1, 95)
(1, 95)
(95, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 12 with wig gave avg accuracy 0.6526315867900848/0.3294736817635987 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/amb_12.mat
(1, 190)
(1, 190)
(190, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/amb_12_t.mat
(1, 95)
(1, 95)
(95, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 12 with amb gave avg accuracy 0.5894736856222152/0.35684210341227685 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/slep_12.mat
(1, 190)
(1, 190)
(190, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/slep_12_t.mat
(1, 95)
(1, 95)
(95, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 12 with slep gave avg accuracy 0.5789473712444305/0.2947368395955939 over 10 splits
2018-06-02 04:50:58.666360: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-06-02 04:50:58.912436: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-02 04:50:59.042429: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-02 04:50:59.201089: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-02 04:50:59.335448: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-02 04:50:59.336137: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-06-02 04:50:59.336278: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-06-02 04:50:59.336309: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-06-02 04:50:59.336329: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-06-02 04:50:59.336347: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-06-02 04:50:59.336365: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-06-02 04:50:59.336397: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-06-02 04:50:59.336423: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-06-02 04:50:59.336444: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-06-02 04:50:59.336464: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-06-02 04:51:47.019748: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-06-02 04:51:47.019872: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-06-02 04:51:47.019895: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-06-02 04:51:47.019913: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 9644806742923281638
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 7857953055352923356
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 7924451357915144852
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 9895758397212184671
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 2030570425988993680
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.848388/DATA/Modified/spectogram/spec_13.mat
(1, 188)
(1, 188)
(188, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/spec_13_t.mat
(1, 113)
(1, 113)
(113, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 13 with spec gave avg accuracy 0.6540935724973679/0.3061946903182342 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/wig_13.mat
(1, 188)
(1, 188)
(188, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/wig_13_t.mat
(1, 113)
(1, 113)
(113, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 13 with wig gave avg accuracy 0.5429824620485306/0.29292035482955714 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/amb_13.mat
(1, 188)
(1, 188)
(188, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/amb_13_t.mat
(1, 113)
(1, 113)
(113, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 13 with amb gave avg accuracy 0.6014619827270508/0.3176991156937011 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/slep_13.mat
(1, 188)
(1, 188)
(188, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/slep_13_t.mat
(1, 113)
(1, 113)
(113, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 13 with slep gave avg accuracy 0.669590637087822/0.3061946904303226 over 10 splits
2018-06-02 08:39:04.843068: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-06-02 08:39:05.145317: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-02 08:39:05.278730: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-02 08:39:05.428402: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-02 08:39:05.587420: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-02 08:39:05.588124: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-06-02 08:39:05.588270: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-06-02 08:39:05.588301: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-06-02 08:39:05.588321: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-06-02 08:39:05.588340: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-06-02 08:39:05.588357: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-06-02 08:39:05.588390: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-06-02 08:39:05.588415: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-06-02 08:39:05.588436: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-06-02 08:39:05.588456: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-06-02 08:39:48.569883: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-06-02 08:39:48.570018: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-06-02 08:39:48.570043: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-06-02 08:39:48.570061: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 737570181332295355
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 12460401774851532662
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 16865550173647587146
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 8862380272981017111
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 9942200377885099319
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.848388/DATA/Modified/spectogram/spec_14.mat
(1, 191)
(1, 191)
(191, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/spec_14_t.mat
(1, 74)
(1, 74)
(74, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 14 with spec gave avg accuracy 0.5092105269432068/0.3256756757159491 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/wig_14.mat
(1, 191)
(1, 191)
(191, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/wig_14_t.mat
(1, 74)
(1, 74)
(74, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 14 with wig gave avg accuracy 0.586578956246376/0.3351351359003299 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/amb_14.mat
(1, 191)
(1, 191)
(191, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/amb_14_t.mat
(1, 74)
(1, 74)
(74, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 14 with amb gave avg accuracy 0.6494736850261689/0.3662162167800439 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/slep_14.mat
(1, 191)
(1, 191)
(191, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/slep_14_t.mat
(1, 74)
(1, 74)
(74, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 14 with slep gave avg accuracy 0.5339473754167556/0.3351351367863448 over 10 splits
2018-06-02 12:28:47.736322: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-06-02 12:28:47.969158: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-02 12:28:48.105083: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-02 12:28:48.265678: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-02 12:28:48.403610: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-02 12:28:48.404336: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-06-02 12:28:48.404480: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-06-02 12:28:48.404511: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-06-02 12:28:48.404531: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-06-02 12:28:48.404548: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-06-02 12:28:48.404565: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-06-02 12:28:48.404596: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-06-02 12:28:48.404623: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-06-02 12:28:48.404644: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-06-02 12:28:48.404664: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-06-02 12:29:36.921514: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-06-02 12:29:36.921636: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-06-02 12:29:36.921661: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-06-02 12:29:36.921678: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 11353891386353745945
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 6564207307579205731
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 2404493674973352479
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 12813934895413763845
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 17523393126391255353
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.848388/DATA/Modified/spectogram/spec_15.mat
(1, 181)
(1, 181)
(181, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/spec_15_t.mat
(1, 125)
(1, 125)
(125, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 15 with spec gave avg accuracy 0.6356725186109543/0.3543999989748001 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/wig_15.mat
(1, 181)
(1, 181)
(181, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/wig_15_t.mat
(1, 125)
(1, 125)
(125, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 15 with wig gave avg accuracy 0.6529239803552628/0.4063999977111816 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/amb_15.mat
(1, 181)
(1, 181)
(181, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/amb_15_t.mat
(1, 125)
(1, 125)
(125, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 15 with amb gave avg accuracy 0.6403508812189103/0.39679999961853024 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/slep_15.mat
(1, 181)
(1, 181)
(181, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/slep_15_t.mat
(1, 125)
(1, 125)
(125, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 15 with slep gave avg accuracy 0.6570175528526306/0.35839999964237207 over 10 splits
2018-06-02 16:09:52.418007: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-06-02 16:09:52.639478: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-02 16:09:52.759197: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-02 16:09:52.906759: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-02 16:09:53.053592: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-02 16:09:53.054318: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-06-02 16:09:53.054440: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-06-02 16:09:53.054470: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-06-02 16:09:53.054490: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-06-02 16:09:53.054507: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-06-02 16:09:53.054525: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-06-02 16:09:53.054555: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-06-02 16:09:53.054583: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-06-02 16:09:53.054604: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-06-02 16:09:53.054625: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-06-02 16:10:32.440905: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-06-02 16:10:32.441031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-06-02 16:10:32.441056: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-06-02 16:10:32.441075: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 14249698369490451583
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 5804938951199794927
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 1872385010772865466
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 12259984540604230214
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 1092038014203464522
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.848388/DATA/Modified/spectogram/spec_16.mat
(1, 192)
(1, 192)
(192, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/spec_16_t.mat
(1, 62)
(1, 62)
(62, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 16 with spec gave avg accuracy 0.45842105746269224/0.3129032310458922 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/wig_16.mat
(1, 192)
(1, 192)
(192, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/wig_16_t.mat
(1, 62)
(1, 62)
(62, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 16 with wig gave avg accuracy 0.4331578999757767/0.33064516600101224 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/amb_16.mat
(1, 192)
(1, 192)
(192, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/amb_16_t.mat
(1, 62)
(1, 62)
(62, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 16 with amb gave avg accuracy 0.4313157916069031/0.3580645193736399 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/slep_16.mat
(1, 192)
(1, 192)
(192, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/slep_16_t.mat
(1, 62)
(1, 62)
(62, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 16 with slep gave avg accuracy 0.4421052664518356/0.2774193585399658 over 10 splits
2018-06-02 20:05:07.333590: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-06-02 20:05:07.568847: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-02 20:05:07.695884: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-02 20:05:07.841304: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-02 20:05:07.977007: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-02 20:05:07.977758: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-06-02 20:05:07.977880: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-06-02 20:05:07.977910: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-06-02 20:05:07.977930: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-06-02 20:05:07.977949: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-06-02 20:05:07.977987: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-06-02 20:05:07.978021: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-06-02 20:05:07.978051: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-06-02 20:05:07.978074: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-06-02 20:05:07.978096: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-06-02 20:05:50.586432: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-06-02 20:05:50.586561: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-06-02 20:05:50.586586: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-06-02 20:05:50.586605: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 12153498768968404590
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 13678569556024683524
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 4448220768562428764
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 1035885704107654021
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 11915537388300128203
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.848388/DATA/Modified/spectogram/spec_17.mat
(1, 190)
(1, 190)
(190, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/spec_17_t.mat
(1, 68)
(1, 68)
(68, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 17 with spec gave avg accuracy 0.7105263203382493/0.3411764705882353 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/wig_17.mat
(1, 190)
(1, 190)
(190, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/wig_17_t.mat
(1, 68)
(1, 68)
(68, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 17 with wig gave avg accuracy 0.7157894790172576/0.3147058823529412 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/amb_17.mat
(1, 190)
(1, 190)
(190, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/amb_17_t.mat
(1, 68)
(1, 68)
(68, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 17 with amb gave avg accuracy 0.6263157814741135/0.30882352941176466 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/slep_17.mat
(1, 190)
(1, 190)
(190, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/slep_17_t.mat
(1, 68)
(1, 68)
(68, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 17 with slep gave avg accuracy 0.6052631616592408/0.3558823529411764 over 10 splits
2018-06-02 23:53:05.115367: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-06-02 23:53:05.354545: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-02 23:53:05.490880: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-02 23:53:05.637225: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-02 23:53:05.771875: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-02 23:53:05.772593: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-06-02 23:53:05.772716: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-06-02 23:53:05.772746: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-06-02 23:53:05.772766: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-06-02 23:53:05.772784: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-06-02 23:53:05.772801: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-06-02 23:53:05.772832: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-06-02 23:53:05.772857: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-06-02 23:53:05.772878: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-06-02 23:53:05.772897: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-06-02 23:53:45.279072: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-06-02 23:53:45.279199: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-06-02 23:53:45.279222: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-06-02 23:53:45.279240: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 10338221588648046202
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 583706607901312397
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 7797742021423884961
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 14155775324511199574
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 15936875388416954023
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.848388/DATA/Modified/spectogram/spec_18.mat
(1, 185)
(1, 185)
(185, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/spec_18_t.mat
(1, 70)
(1, 70)
(70, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 18 with spec gave avg accuracy 0.6251461952924728/0.3400000003405979 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/wig_18.mat
(1, 185)
(1, 185)
(185, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/wig_18_t.mat
(1, 70)
(1, 70)
(70, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 18 with wig gave avg accuracy 0.649122804403305/0.2957142860123089 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/amb_18.mat
(1, 185)
(1, 185)
(185, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/amb_18_t.mat
(1, 70)
(1, 70)
(70, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 18 with amb gave avg accuracy 0.5517544001340866/0.30000000017029893 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/slep_18.mat
(1, 185)
(1, 185)
(185, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/slep_18_t.mat
(1, 70)
(1, 70)
(70, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 18 with slep gave avg accuracy 0.6269005864858628/0.34285714285714286 over 10 splits
2018-06-03 03:39:18.205345: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-06-03 03:39:18.419138: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-03 03:39:18.539443: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-03 03:39:18.685668: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-03 03:39:18.823554: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-06-03 03:39:18.824279: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-06-03 03:39:18.824400: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-06-03 03:39:18.824430: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-06-03 03:39:18.824450: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-06-03 03:39:18.824468: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-06-03 03:39:18.824487: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-06-03 03:39:18.824518: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-06-03 03:39:18.824546: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-06-03 03:39:18.824568: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-06-03 03:39:18.824589: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-06-03 03:40:01.590563: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-06-03 03:40:01.590682: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-06-03 03:40:01.590708: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-06-03 03:40:01.590729: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 17575167711396703025
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 6411222309526962665
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 14657693456912763075
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 8336583786975712762
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 1785738817779969398
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.848388/DATA/Modified/spectogram/spec_19.mat
(1, 181)
(1, 181)
(181, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/spec_19_t.mat
(1, 91)
(1, 91)
(91, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 19 with spec gave avg accuracy 0.6798245698213577/0.33406593296881565 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/wig_19.mat
(1, 181)
(1, 181)
(181, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/wig_19_t.mat
(1, 91)
(1, 91)
(91, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 19 with wig gave avg accuracy 0.6307017713785171/0.35054945019739014 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/amb_19.mat
(1, 181)
(1, 181)
(181, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/amb_19_t.mat
(1, 91)
(1, 91)
(91, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 19 with amb gave avg accuracy 0.6745614022016525/0.3142857144822132 over 10 splits
/local/slurmtmp.848388/DATA/Modified/spectogram/slep_19.mat
(1, 181)
(1, 181)
(181, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.848388/DATA/Modified/spectogram/slep_19_t.mat
(1, 91)
(1, 91)
(91, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 19 with slep gave avg accuracy 0.618421059846878/0.33516483455077634 over 10 splits
end time
Sun Jun  3 07:15:32 CEST 2018
