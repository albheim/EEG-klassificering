data dir
/lunarc/nobackup/users/albheim/EEG-klassificering
script
#!/bin/sh
#SBATCH -t 60:00:00
#SBATCH -J 1st_cwtb
#SBATCH -A lu2018-2-3
#// SBATCH -o stdout_%j.out
#// SBATCH -e stderr_%j.err

# shold be lu or gpu
#SBATCH -p gpu

# how many gpus, 4 per node, using many seems to crash more often so stick with 1
#SBATCH --gres=gpu:4

# use 5 cores per GPU
#SBATCH -n 20
#SBATCH --mem-per-cpu=3100

DATA_DIR="$(cat ../data_location.txt)"
echo "data dir"
echo $DATA_DIR

echo "script"
cat $0

PY_FILE="conv2d_spect.py"
echo "py file"
cat $PY_FILE

echo "data file"
cat "data.py"

echo "mat file"
cat "../matlab/save transformed/savetf.m"

echo "nvidia smi"
nvidia-smi

echo "start time"
date

cp -r "${DATA_DIR}/DATA" $SNIC_TMP
ls $SNIC_TMP
du -h "${SNIC_TMP}/DATA"

echo "copy done time"
date

#matlab -nodisplay -nosplash -nodesktop -r "run('../matlab/save transformed/savetf.m');"
idxs=(1 2 3 4 5 6 7 8 9 11 12 13 14)
for i in ${idxs[@]}; do
    python $PY_FILE $SNIC_TMP $i
done

echo "end time"
date
py file
import sys
from datetime import datetime

import numpy as np
from scipy import io

import tensorflow as tf

from keras.models import Model
from keras.layers import Dense, Dropout, Input, GaussianNoise, BatchNormalization
from keras.layers import Lambda
from keras.layers import Conv2D, MaxPooling2D, AveragePooling2D
from keras.layers import ELU, Activation, Flatten

from keras import backend as K
from keras import regularizers as rg

from tensorflow.python.client import device_lib
print(device_lib.list_local_devices())

import data
import util

funcs = ["spec", "wig", "amb", "cwt", "slep"]
sub = int(sys.argv[2])

splits = 10

for func in funcs:
    x, y = data.load_transform([sub], func)
    xt, yt = data.load_transform([sub], func, test=True)

    m_in = Input(shape=x[0][0].shape)

    m_t = Conv2D(4, (4, 8), padding='same')(m_in) #, kernel_regularizer=rg.l1(0.01)
    #m_t = BatchNormalization()(m_t)
    m_t = ELU()(m_t)
    m_t = AveragePooling2D((2, 4))(m_t)
    m_t = Dropout(0.2)(m_t)

    m_t = Conv2D(8, (4, 8), padding='same')(m_t)
    #m_t = BatchNormalization()(m_t)
    m_t = ELU()(m_t)
    m_t = AveragePooling2D((2, 4))(m_t)
    m_t = Dropout(0.3)(m_t)

    m_t = Conv2D(16, (4, 8), padding='same')(m_t)
    #m_t = BatchNormalization()(m_t)
    m_t = ELU()(m_t)
    m_t = AveragePooling2D((2, 2))(m_t)
    m_t = Dropout(0.3)(m_t)

    m_t = Flatten()(m_t)
    m_t = Dense(15, kernel_regularizer=rg.l1(0.01))(m_t)
    #m_t = BatchNormalization()(m_t)
    m_t = Activation('tanh')(m_t)
    m_out = Dense(3, activation='softmax')(m_t)

    model = Model(inputs=m_in, outputs=m_out)

    m_save = model.get_config()
    model.summary()

    acc = 0
    acc2 = 0
    for tr, val in util.kfold(len(x[0]), splits, shuffle=True):

        model = Model.from_config(m_save)
        model.compile(loss='categorical_crossentropy',
                      optimizer='adam',
                      metrics=['accuracy'])
        # fit with next kfold data
        h = model.fit(x[0][tr], y[0][tr],
                      #validation_data=(x[0][val], y[0][val]),
                      batch_size=16, epochs=50, verbose=0)

        _, a = model.evaluate(x[0][val], y[0][val], verbose=0)
        _, a2 = model.evaluate(xt[0], yt[0], verbose=0)
        acc += a
        acc2 += a2

    acc /= splits
    acc2 /= splits

    print("sub {} with {} gave avg accuracy {}/{} over {} splits".format(sub, func, acc, acc2, splits))
data file
import sys

import numpy as np
from scipy import io
import h5py


def load_single_sub(sub, cut=True, study=True, shuffle=True, visual=True, transpose=False, user="Albin"):
    if user=="Damir":
        snic_tmp = "/Users/damir/Documents/EEG-data"
    else:
        snic_tmp = "C:/Users/Albin Heimerson/Desktop/exjobb/DATA"
    if len(sys.argv) > 1:
        snic_tmp = str(sys.argv[1]) + "/DATA"
    xn = None
    yn = None
    names = ["FA", "LM", "OB"]
    for i in range(3):
        name = "Subj{:02}_CleanData_{}_{}".format(sub,
                                                  'study' if study else 'test',
                                                  names[i])
        if not study:
            name += "_{}".format("visual" if visual else "lexical")

        print("loading: ", name)

        m = io.loadmat('{}/{}/{}.mat'.format(snic_tmp,
                                                  "Visual" if visual else "Verbal",
                                                  name))
        trials = m[name][0][0][2][0]
        for j in range(trials.shape[0]):
            if cut is True:
                trials[j] = trials[j][:, 768:1536]
            elif cut is not False:
                trials[j] = trials[j][:, cut[0]:cut[1]]
            if transpose:
                trials[j] = trials[j].T
        labels = np.zeros((trials.shape[0], 3))
        labels[:, i] = 1
        if xn is None:
            xn = trials
            yn = labels
        else:
            xn = np.concatenate((xn, trials), axis=0)
            yn = np.concatenate((yn, labels), axis=0)

    xn = np.stack(xn, axis=0)
    n = xn.shape[0]
    s = np.arange(n)
    if shuffle:
        np.random.shuffle(s)

    return (xn[s], yn[s])


def load_single(idx=None, cut=True, shuffle=True, visual=True, transpose=False,
                study=True):
    x = []
    y = []

    if idx is None:
        if visual:
            idx = [i if i < 10 else i + 1 for i in range(1, 19)]
        else:
            idx = [1, 2, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22]

    for sub in idx:
        xn, yn = load_single_sub(sub, cut, study, shuffle, visual, transpose)
        x.append(xn)
        y.append(yn)

    return (x, y)


def load_all(cut=True, visual=True, study=True, transpose=False):
    x = None
    y = None

    if visual:
        subs = [i if i < 10 else i + 1 for i in range(1, 19)]
    else:
        subs = [1, 2, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22]

    for sub in subs:  # 19 is max
        xn, yn = load_single_sub(sub, cut, study, False, visual, transpose)
        if x is None:
            x = xn
            y = yn
        else:
            x = np.concatenate((x, xn), axis=0)
            y = np.concatenate((y, yn), axis=0)

    print(x.shape, y.shape)
    x = np.stack(x, axis=0)
    print(x.shape)
    s = np.arange(x.shape[0])
    np.random.shuffle(s)

    return (x[s], y[s])


def load_marg(cut=None, visual=True, shuffle=True):
    snic_tmp = "C:/Users/Albin Heimerson/Desktop/exjobb"
    if len(sys.argv) > 1:
        snic_tmp = str(sys.argv[1])
    x = []
    y = []
    if visual:
        subs = [i if i < 10 else i + 1 for i in range(1, 19)]
    else:
        subs = [1, 2, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22]
    for sub in subs:
        xn = None
        yn = None
        for i in range(3):
            name = "Subj{:02}_{}_marg".format(sub, "Visual" if visual else "Verbal")
            print("loading: ", name)
            m = io.loadmat('{}/DATA/Modified/marginal/{}.mat'.format(snic_tmp, name))

            trials = m['data'][0][0][i][:, 0]
            if cut is not None:
                for j in range(trials.shape[0]):
                    trials[j] = trials[j][:, cut[0]:cut[1]]
            labels = np.zeros((trials.shape[0], 3))
            labels[:, i] = 1
            if xn is None:
                xn = trials
                yn = labels
            else:
                xn = np.concatenate((xn, trials), axis=0)
                yn = np.concatenate((yn, labels), axis=0)

        xn = np.stack(xn, axis=0)
        n = xn.shape[0]
        s = np.arange(n)
        if shuffle:
            np.random.shuffle(s)
        x.append(xn[s])
        y.append(yn[s])

    print(x[0].shape)
    return (x, y)


def cut(data, cut=[768, 1536], tcut = None):
    if tcut is not None:
        cut[0] = int(512 * tcut[0] + 768)
        cut[1] = int(512 * tcut[1] + 768)
    print(cut)
    for sub in range(len(data)):
        data[sub] = data[sub][:, :, cut[0]:cut[1]]


def modify(x, y, n, nmult=0, displacement=0, cut=[768, 1536]):
    mdata = [None for i in range(len(x))]
    my = [None for i in range(len(x))]
    for sub in range(len(mdata)):
        s = x[sub].shape[0]
        my[sub] = np.zeros((s * n, 3))
        for j in range(0, s * n, s):
            my[sub][j:j + s] = y[sub]
        mdata[sub] = np.zeros((s * n, x[sub].shape[1], cut[1] - cut[0]))
        mdata[sub][:s, :, :] = x[sub][:, :, cut[0]:cut[1]]
        for j in range(s, s * n, s):
            for i in range(len(x[sub])):
                if displacement > 0:
                    d = np.random.randint(-displacement, displacement + 1)
                    mdata[sub][j:j + s, :, :] = x[sub][:, :, cut[0] + d:cut[1] + d]

                if nmult != 0:
                    for k in range(mdata[sub][i].shape[0]):
                        mdata[sub][j + i, k] += nmult * np.std(mdata[sub][i, k]) * np.random.ranf(mdata[sub][i, k].shape)

    return mdata, my


def load_transform(idx, trans, test=False):
    snic_tmp = "C:/Users/Albin Heimerson/Desktop/exjobb"
    if len(sys.argv) > 1:
        snic_tmp = str(sys.argv[1])
    x = []
    y = []
    for sub in idx:
        fname = '{}/DATA/Modified/spectogram/{}_{:02}{}.mat'.format(snic_tmp, trans, sub, 
                                                                    '_t' if test else '')
        print(fname)
        with h5py.File(fname) as f:
            t = f['Y']
            print(t.shape)
            yn = np.zeros((t.shape[1], 3))
            for i in range(t.shape[1]):
                yn[i, int(t[0, i]) - 1] = 1

            y.append(yn)

            t = f['Xt']
            print(t.shape)
            xn = [None for i in range(t.shape[1])]
            for i in range(t.shape[1]):
                xn[i] = np.array(f[t[0, i]])

            xn = np.stack(xn, 0)

            if len(xn.shape) < 4:
                xn = xn[:, :, :, np.newaxis]
            else:
                xn = np.transpose(xn, (0, 2, 3, 1))

            print(xn.shape)
            print(xn[0].shape)
            x.append(xn)

    return (x, y)


def load_spect_downsample(visual=True, shuffle=True, ds=8):
    snic_tmp = "C:/Users/Albin Heimerson/Desktop/exjobb"
    if len(sys.argv) > 1:
        snic_tmp = str(sys.argv[1])
    x = []
    y = []
    if visual:
        subs = [i if i < 10 else i + 1 for i in range(2, 19)] # change to 1
    else:
        subs = [1, 2, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22]
    for sub in subs:
        xn = None
        yn = None
        for i in range(3):
            name = "Subj{:02}_{}_spec{}".format(sub, "Visual" if visual else "Verbal", ds)
            print("loading: ", name)
            m = io.loadmat('{}/DATA/Modified/spect_downsample/{}.mat'.format(snic_tmp, name))

            trials = m['data'][0][0][i][:, 0]
            labels = np.zeros((trials.shape[0], 3))
            labels[:, i] = 1
            if xn is None:
                xn = trials
                yn = labels
            else:
                xn = np.concatenate((xn, trials), axis=0)
                yn = np.concatenate((yn, labels), axis=0)

        xn = np.stack(xn, axis=0)
        n = xn.shape[0]
        s = np.arange(n)
        if shuffle:
            np.random.shuffle(s)
        x.append(xn[s])
        y.append(yn[s])

    print(x[0].shape)
    return (x, y)
mat file
clear; clc; close all
addpath('..')
addpath('../borrowed code')

for idx = [1 2 3 4 5 6 7 8 9 11 12 13 14 15 16 17 18 19]
    sub = sprintf('%02d', idx);
    [X,Y,n] = aux_load('Visual',sub);

    param.L = 8; param.Fs = 512; param.NFFT = 512; param.NSTEP = 1; 
    param.method = 'l-ind'; param.NW = 3;

    %X = aux_chan(X,[5 24 29]);
    X = aux_extr(X, 769:1536);
    X = aux_deci(X,4);
    %X = aux_svd(X, 1);

    ms = ["spec", "wig", "amb", "cwt", "slep"]
    for method = ms
        Xt = aux_transform(X, method, param);

        for i = 1:length(Xt)
            Xt{i} = real(permute(Xt{i}, [2 3 1]));
        end
        method
        size(Xt{1})

        %save(sprintf('C:\\Users\\Albin Heimerson\\Desktop\\exjobb\\DATA\\Modified\\spectogram\\%s_%s.mat', method, sub), 'Xt', 'Y', '-v7.3')

        save(sprintf('/lunarc/nobackup/users/albheim/EEG-klassificering/DATA/Modified/spectogram/%s_%s.mat', method, sub), 'Xt', 'Y', '-v7.3')
    end
end

nvidia smi
Sun May 20 11:06:01 2018       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 390.46                 Driver Version: 390.46                    |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:04:00.0 Off |                    0 |
| N/A   25C    P8    26W / 149W |      0MiB / 11441MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:05:00.0 Off |                    0 |
| N/A   29C    P8    29W / 149W |      0MiB / 11441MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   2  Tesla K80           On   | 00000000:84:00.0 Off |                    0 |
| N/A   24C    P8    26W / 149W |      0MiB / 11441MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   3  Tesla K80           On   | 00000000:85:00.0 Off |                    0 |
| N/A   31C    P8    29W / 149W |      0MiB / 11441MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
start time
Sun May 20 11:06:01 CEST 2018
DATA
2.4G	/local/slurmtmp.784577/DATA/Visual
2.4G	/local/slurmtmp.784577/DATA/Verbal
388M	/local/slurmtmp.784577/DATA/Modified/marginal
302G	/local/slurmtmp.784577/DATA/Modified/spectogram
302G	/local/slurmtmp.784577/DATA/Modified
307G	/local/slurmtmp.784577/DATA
copy done time
Sun May 20 12:14:54 CEST 2018
2018-05-20 12:15:32.023489: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-20 12:15:35.704789: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-20 12:15:35.859308: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-20 12:15:36.008633: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-20 12:15:36.164494: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-20 12:15:36.165505: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-20 12:15:36.165631: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-20 12:15:36.165663: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-20 12:15:36.165684: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-20 12:15:36.165702: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-20 12:15:36.165743: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-20 12:15:36.165777: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-20 12:15:36.165801: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-20 12:15:36.165821: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-20 12:15:36.165840: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-20 12:17:31.278364: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-20 12:17:31.278518: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-20 12:17:31.278565: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-20 12:17:31.278584: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 6721683145655197774
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 14181122982270415128
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323080704
locality {
  bus_id: 1
}
incarnation: 17756999126927831642
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 2
}
incarnation: 17281605299738068621
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 4314037056887983689
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.784577/DATA/Modified/spectogram/spec_01.mat
(1, 185)
(1, 185)
(185, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/spec_01_t.mat
(1, 90)
(1, 90)
(90, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 1 with spec gave avg accuracy 0.6119883060455322/0.31222222487131757 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/wig_01.mat
(1, 185)
(1, 185)
(185, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/wig_01_t.mat
(1, 90)
(1, 90)
(90, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 1 with wig gave avg accuracy 0.6052631556987762/0.325555557873514 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/amb_01.mat
(1, 185)
(1, 185)
(185, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/amb_01_t.mat
(1, 90)
(1, 90)
(90, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 96, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 96, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 96, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 96, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 48, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 48, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 48, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 48, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 24, 16, 16)        0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 24, 16, 16)        0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 6144)              0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                92175     
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 101,339
Trainable params: 101,339
Non-trainable params: 0
_________________________________________________________________
sub 1 with amb gave avg accuracy 0.5725146204233169/0.29444444667961867 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/cwt_01.mat
(1, 185)
(1, 185)
(185, 192, 47, 31)
(192, 47, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/cwt_01_t.mat
(1, 90)
(1, 90)
(90, 192, 47, 31)
(192, 47, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 192, 47, 31)       0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 192, 47, 4)        3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 192, 47, 4)        0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 96, 11, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 96, 11, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 96, 11, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 96, 11, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 48, 2, 8)          0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 48, 2, 8)          0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 48, 2, 16)         4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 48, 2, 16)         0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 24, 1, 16)         0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 24, 1, 16)         0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 1 with cwt gave avg accuracy 0.6040935724973678/0.3666666691170798 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/slep_01.mat
(1, 185)
(1, 185)
(185, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/slep_01_t.mat
(1, 90)
(1, 90)
(90, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_5 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_13 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_13 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_13 (Averag (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_13 (Dropout)         (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_14 (Conv2D)           (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_14 (ELU)                 (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_14 (Averag (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_14 (Dropout)         (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_15 (Conv2D)           (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_15 (ELU)                 (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_15 (Averag (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_15 (Dropout)         (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_5 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_9 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_5 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_10 (Dense)             (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 1 with slep gave avg accuracy 0.5941520392894745/0.29888889147175685 over 10 splits
2018-05-20 16:03:44.238012: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-20 16:03:44.446113: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-20 16:03:44.563914: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-20 16:03:44.708184: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-20 16:03:44.842235: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-20 16:03:44.842976: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-20 16:03:44.843111: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-20 16:03:44.843145: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-20 16:03:44.843167: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-20 16:03:44.843188: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-20 16:03:44.843208: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-20 16:03:44.843247: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-20 16:03:44.843275: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-20 16:03:44.843300: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-20 16:03:44.843323: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-20 16:04:24.129343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-20 16:04:24.129471: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-20 16:04:24.129509: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-20 16:04:24.129530: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 14537917400945229099
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 804426887680587394
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323080704
locality {
  bus_id: 1
}
incarnation: 6064349001870645846
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 2
}
incarnation: 845709819015051699
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 14755745839857923721
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.784577/DATA/Modified/spectogram/spec_02.mat
(1, 187)
(1, 187)
(187, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/spec_02_t.mat
(1, 74)
(1, 74)
(74, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 2 with spec gave avg accuracy 0.5359649121761322/0.37837837966712745 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/wig_02.mat
(1, 187)
(1, 187)
(187, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/wig_02_t.mat
(1, 74)
(1, 74)
(74, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 2 with wig gave avg accuracy 0.48508772552013396/0.36621621714250463 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/amb_02.mat
(1, 187)
(1, 187)
(187, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/amb_02_t.mat
(1, 74)
(1, 74)
(74, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 96, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 96, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 96, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 96, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 48, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 48, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 48, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 48, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 24, 16, 16)        0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 24, 16, 16)        0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 6144)              0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                92175     
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 101,339
Trainable params: 101,339
Non-trainable params: 0
_________________________________________________________________
sub 2 with amb gave avg accuracy 0.5087719351053238/0.3351351362627905 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/cwt_02.mat
(1, 187)
(1, 187)
(187, 192, 47, 31)
(192, 47, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/cwt_02_t.mat
(1, 74)
(1, 74)
(74, 192, 47, 31)
(192, 47, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 192, 47, 31)       0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 192, 47, 4)        3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 192, 47, 4)        0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 96, 11, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 96, 11, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 96, 11, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 96, 11, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 48, 2, 8)          0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 48, 2, 8)          0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 48, 2, 16)         4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 48, 2, 16)         0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 24, 1, 16)         0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 24, 1, 16)         0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 2 with cwt gave avg accuracy 0.6169590651988983/0.443243244209805 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/slep_02.mat
(1, 187)
(1, 187)
(187, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/slep_02_t.mat
(1, 74)
(1, 74)
(74, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_5 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_13 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_13 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_13 (Averag (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_13 (Dropout)         (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_14 (Conv2D)           (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_14 (ELU)                 (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_14 (Averag (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_14 (Dropout)         (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_15 (Conv2D)           (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_15 (ELU)                 (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_15 (Averag (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_15 (Dropout)         (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_5 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_9 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_5 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_10 (Dense)             (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 2 with slep gave avg accuracy 0.4830409407615662/0.39189189310009415 over 10 splits
2018-05-20 19:51:54.736686: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-20 19:51:54.948882: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-20 19:51:55.065587: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-20 19:51:55.199175: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-20 19:51:55.342268: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-20 19:51:55.342960: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-20 19:51:55.343078: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-20 19:51:55.343108: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-20 19:51:55.343128: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-20 19:51:55.343146: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-20 19:51:55.343163: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-20 19:51:55.343192: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-20 19:51:55.343215: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-20 19:51:55.343242: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-20 19:51:55.343263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-20 19:53:00.454737: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-20 19:53:00.454867: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-20 19:53:00.454891: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-20 19:53:00.454909: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 16970319218002675986
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 11099794037547247578
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323080704
locality {
  bus_id: 1
}
incarnation: 18256005183896921333
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 2
}
incarnation: 3774452649558271409
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 3642368514747452860
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.784577/DATA/Modified/spectogram/spec_03.mat
(1, 186)
(1, 186)
(186, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/spec_03_t.mat
(1, 130)
(1, 130)
(130, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 3 with spec gave avg accuracy 0.6453216403722764/0.3138461538461538 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/wig_03.mat
(1, 186)
(1, 186)
(186, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/wig_03_t.mat
(1, 130)
(1, 130)
(130, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 3 with wig gave avg accuracy 0.6555555552244187/0.2953846153846154 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/amb_03.mat
(1, 186)
(1, 186)
(186, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/amb_03_t.mat
(1, 130)
(1, 130)
(130, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 96, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 96, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 96, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 96, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 48, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 48, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 48, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 48, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 24, 16, 16)        0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 24, 16, 16)        0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 6144)              0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                92175     
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 101,339
Trainable params: 101,339
Non-trainable params: 0
_________________________________________________________________
sub 3 with amb gave avg accuracy 0.7368421077728271/0.3323076923076923 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/cwt_03.mat
(1, 186)
(1, 186)
(186, 192, 47, 31)
(192, 47, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/cwt_03_t.mat
(1, 130)
(1, 130)
(130, 192, 47, 31)
(192, 47, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 192, 47, 31)       0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 192, 47, 4)        3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 192, 47, 4)        0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 96, 11, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 96, 11, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 96, 11, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 96, 11, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 48, 2, 8)          0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 48, 2, 8)          0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 48, 2, 16)         4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 48, 2, 16)         0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 24, 1, 16)         0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 24, 1, 16)         0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 3 with cwt gave avg accuracy 0.828947377204895/0.35692307692307695 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/slep_03.mat
(1, 186)
(1, 186)
(186, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/slep_03_t.mat
(1, 130)
(1, 130)
(130, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_5 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_13 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_13 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_13 (Averag (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_13 (Dropout)         (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_14 (Conv2D)           (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_14 (ELU)                 (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_14 (Averag (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_14 (Dropout)         (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_15 (Conv2D)           (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_15 (ELU)                 (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_15 (Averag (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_15 (Dropout)         (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_5 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_9 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_5 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_10 (Dense)             (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 3 with slep gave avg accuracy 0.6292397737503052/0.2907692307692308 over 10 splits
2018-05-20 23:41:52.572279: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-20 23:41:52.812861: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-20 23:41:52.942565: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-20 23:41:53.102689: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-20 23:41:53.249640: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-20 23:41:53.250415: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-20 23:41:53.250554: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-20 23:41:53.250588: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-20 23:41:53.250612: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-20 23:41:53.250634: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-20 23:41:53.250655: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-20 23:41:53.250689: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-20 23:41:53.250717: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-20 23:41:53.250741: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-20 23:41:53.250765: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-20 23:42:36.689666: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-20 23:42:36.689788: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-20 23:42:36.689815: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-20 23:42:36.689834: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 11554187980549106413
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 527049815661540039
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323080704
locality {
  bus_id: 1
}
incarnation: 15952332701524417193
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 2
}
incarnation: 13092906118054387659
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 9954052189657837209
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.784577/DATA/Modified/spectogram/spec_04.mat
(1, 185)
(1, 185)
(185, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/spec_04_t.mat
(1, 96)
(1, 96)
(96, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 4 with spec gave avg accuracy 0.6915204703807831/0.30416666666666664 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/wig_04.mat
(1, 185)
(1, 185)
(185, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/wig_04_t.mat
(1, 96)
(1, 96)
(96, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 4 with wig gave avg accuracy 0.6973684310913086/0.325 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/amb_04.mat
(1, 185)
(1, 185)
(185, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/amb_04_t.mat
(1, 96)
(1, 96)
(96, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 96, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 96, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 96, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 96, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 48, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 48, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 48, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 48, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 24, 16, 16)        0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 24, 16, 16)        0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 6144)              0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                92175     
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 101,339
Trainable params: 101,339
Non-trainable params: 0
_________________________________________________________________
sub 4 with amb gave avg accuracy 0.7198830425739289/0.36875 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/cwt_04.mat
(1, 185)
(1, 185)
(185, 192, 47, 31)
(192, 47, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/cwt_04_t.mat
(1, 96)
(1, 96)
(96, 192, 47, 31)
(192, 47, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 192, 47, 31)       0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 192, 47, 4)        3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 192, 47, 4)        0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 96, 11, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 96, 11, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 96, 11, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 96, 11, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 48, 2, 8)          0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 48, 2, 8)          0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 48, 2, 16)         4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 48, 2, 16)         0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 24, 1, 16)         0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 24, 1, 16)         0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 4 with cwt gave avg accuracy 0.6692982584238052/0.4020833333333334 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/slep_04.mat
(1, 185)
(1, 185)
(185, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/slep_04_t.mat
(1, 96)
(1, 96)
(96, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_5 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_13 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_13 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_13 (Averag (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_13 (Dropout)         (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_14 (Conv2D)           (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_14 (ELU)                 (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_14 (Averag (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_14 (Dropout)         (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_15 (Conv2D)           (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_15 (ELU)                 (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_15 (Averag (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_15 (Dropout)         (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_5 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_9 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_5 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_10 (Dense)             (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 4 with slep gave avg accuracy 0.6809941589832306/0.3145833333333333 over 10 splits
2018-05-21 03:30:43.127397: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-21 03:30:43.392626: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-21 03:30:43.527442: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-21 03:30:43.685071: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-21 03:30:43.821513: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-21 03:30:43.822271: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-21 03:30:43.822409: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-21 03:30:43.822444: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-21 03:30:43.822466: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-21 03:30:43.822487: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-21 03:30:43.822507: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-21 03:30:43.822540: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-21 03:30:43.822567: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-21 03:30:43.822591: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-21 03:30:43.822638: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-21 03:31:24.711343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-21 03:31:24.711467: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-21 03:31:24.711491: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-21 03:31:24.711508: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 4480036351431432731
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 12370637667877780871
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323080704
locality {
  bus_id: 1
}
incarnation: 7216343324256533354
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 2
}
incarnation: 11334503364183074282
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 1462668767015108684
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.784577/DATA/Modified/spectogram/spec_05.mat
(1, 187)
(1, 187)
(187, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/spec_05_t.mat
(1, 109)
(1, 109)
(109, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 5 with spec gave avg accuracy 0.5885964870452881/0.3559633034495039 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/wig_05.mat
(1, 187)
(1, 187)
(187, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/wig_05_t.mat
(1, 109)
(1, 109)
(109, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 5 with wig gave avg accuracy 0.6856725066900253/0.31559633078104865 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/amb_05.mat
(1, 187)
(1, 187)
(187, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/amb_05_t.mat
(1, 109)
(1, 109)
(109, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 96, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 96, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 96, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 96, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 48, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 48, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 48, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 48, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 24, 16, 16)        0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 24, 16, 16)        0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 6144)              0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                92175     
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 101,339
Trainable params: 101,339
Non-trainable params: 0
_________________________________________________________________
sub 5 with amb gave avg accuracy 0.6467836201190948/0.30733945006077446 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/cwt_05.mat
(1, 187)
(1, 187)
(187, 192, 47, 31)
(192, 47, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/cwt_05_t.mat
(1, 109)
(1, 109)
(109, 192, 47, 31)
(192, 47, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 192, 47, 31)       0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 192, 47, 4)        3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 192, 47, 4)        0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 96, 11, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 96, 11, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 96, 11, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 96, 11, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 48, 2, 8)          0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 48, 2, 8)          0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 48, 2, 16)         4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 48, 2, 16)         0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 24, 1, 16)         0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 24, 1, 16)         0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 5 with cwt gave avg accuracy 0.7535087764263153/0.3495412847932872 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/slep_05.mat
(1, 187)
(1, 187)
(187, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/slep_05_t.mat
(1, 109)
(1, 109)
(109, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_5 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_13 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_13 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_13 (Averag (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_13 (Dropout)         (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_14 (Conv2D)           (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_14 (ELU)                 (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_14 (Averag (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_14 (Dropout)         (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_15 (Conv2D)           (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_15 (ELU)                 (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_15 (Averag (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_15 (Dropout)         (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_5 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_9 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_5 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_10 (Dense)             (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 5 with slep gave avg accuracy 0.6149122804403305/0.3522935787608864 over 10 splits
2018-05-21 07:20:32.282032: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-21 07:20:32.602353: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-21 07:20:32.741598: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-21 07:20:32.901421: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-21 07:20:33.047121: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-21 07:20:33.047816: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-21 07:20:33.047937: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-21 07:20:33.047968: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-21 07:20:33.047990: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-21 07:20:33.048009: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-21 07:20:33.048028: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-21 07:20:33.048058: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-21 07:20:33.048082: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-21 07:20:33.048104: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-21 07:20:33.048126: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-21 07:21:15.023553: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-21 07:21:15.023680: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-21 07:21:15.023707: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-21 07:21:15.023727: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 597386865661164663
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 3750286064129537397
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323080704
locality {
  bus_id: 1
}
incarnation: 13603214146063738979
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 2
}
incarnation: 7992967325133157717
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 12776003787233126831
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.784577/DATA/Modified/spectogram/spec_06.mat
(1, 184)
(1, 184)
(184, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/spec_06_t.mat
(1, 121)
(1, 121)
(121, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 6 with spec gave avg accuracy 0.6453216463327408/0.29586776840415874 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/wig_06.mat
(1, 184)
(1, 184)
(184, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/wig_06_t.mat
(1, 121)
(1, 121)
(121, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 6 with wig gave avg accuracy 0.6146198868751526/0.3198347104359265 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/amb_06.mat
(1, 184)
(1, 184)
(184, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/amb_06_t.mat
(1, 121)
(1, 121)
(121, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 96, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 96, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 96, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 96, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 48, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 48, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 48, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 48, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 24, 16, 16)        0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 24, 16, 16)        0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 6144)              0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                92175     
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 101,339
Trainable params: 101,339
Non-trainable params: 0
_________________________________________________________________
sub 6 with amb gave avg accuracy 0.5935672581195831/0.3256198351787142 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/cwt_06.mat
(1, 184)
(1, 184)
(184, 192, 47, 31)
(192, 47, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/cwt_06_t.mat
(1, 121)
(1, 121)
(121, 192, 47, 31)
(192, 47, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 192, 47, 31)       0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 192, 47, 4)        3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 192, 47, 4)        0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 96, 11, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 96, 11, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 96, 11, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 96, 11, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 48, 2, 8)          0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 48, 2, 8)          0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 48, 2, 16)         4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 48, 2, 16)         0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 24, 1, 16)         0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 24, 1, 16)         0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 6 with cwt gave avg accuracy 0.5377193063497543/0.35867768575337317 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/slep_06.mat
(1, 184)
(1, 184)
(184, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/slep_06_t.mat
(1, 121)
(1, 121)
(121, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_5 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_13 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_13 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_13 (Averag (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_13 (Dropout)         (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_14 (Conv2D)           (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_14 (ELU)                 (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_14 (Averag (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_14 (Dropout)         (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_15 (Conv2D)           (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_15 (ELU)                 (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_15 (Averag (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_15 (Dropout)         (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_5 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_9 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_5 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_10 (Dense)             (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 6 with slep gave avg accuracy 0.6777777791023254/0.3314049589917186 over 10 splits
2018-05-21 11:07:28.482576: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-21 11:07:28.774953: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-21 11:07:28.911943: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-21 11:07:29.072135: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-21 11:07:29.218572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-21 11:07:29.219266: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-21 11:07:29.219387: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-21 11:07:29.219417: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-21 11:07:29.219437: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-21 11:07:29.219455: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-21 11:07:29.219472: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-21 11:07:29.219501: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-21 11:07:29.219525: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-21 11:07:29.219546: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-21 11:07:29.219566: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-21 11:08:22.660716: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-21 11:08:22.660837: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-21 11:08:22.660860: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-21 11:08:22.660878: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 4756818234308769612
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 757248141268860385
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323080704
locality {
  bus_id: 1
}
incarnation: 14721540840201314259
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 2
}
incarnation: 1104607394501710941
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 7629099943477324616
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.784577/DATA/Modified/spectogram/spec_07.mat
(1, 188)
(1, 188)
(188, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/spec_07_t.mat
(1, 87)
(1, 87)
(87, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 7 with spec gave avg accuracy 0.5994152009487153/0.2839080446538912 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/wig_07.mat
(1, 188)
(1, 188)
(188, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/wig_07_t.mat
(1, 87)
(1, 87)
(87, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 7 with wig gave avg accuracy 0.670175439119339/0.33448275892042567 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/amb_07.mat
(1, 188)
(1, 188)
(188, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/amb_07_t.mat
(1, 87)
(1, 87)
(87, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 96, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 96, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 96, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 96, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 48, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 48, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 48, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 48, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 24, 16, 16)        0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 24, 16, 16)        0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 6144)              0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                92175     
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 101,339
Trainable params: 101,339
Non-trainable params: 0
_________________________________________________________________
sub 7 with amb gave avg accuracy 0.6172514617443084/0.3321839075407077 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/cwt_07.mat
(1, 188)
(1, 188)
(188, 192, 47, 31)
(192, 47, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/cwt_07_t.mat
(1, 87)
(1, 87)
(87, 192, 47, 31)
(192, 47, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 192, 47, 31)       0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 192, 47, 4)        3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 192, 47, 4)        0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 96, 11, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 96, 11, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 96, 11, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 96, 11, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 48, 2, 8)          0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 48, 2, 8)          0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 48, 2, 16)         4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 48, 2, 16)         0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 24, 1, 16)         0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 24, 1, 16)         0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 7 with cwt gave avg accuracy 0.7508771896362305/0.3206896532369756 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/slep_07.mat
(1, 188)
(1, 188)
(188, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/slep_07_t.mat
(1, 87)
(1, 87)
(87, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_5 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_13 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_13 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_13 (Averag (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_13 (Dropout)         (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_14 (Conv2D)           (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_14 (ELU)                 (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_14 (Averag (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_14 (Dropout)         (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_15 (Conv2D)           (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_15 (ELU)                 (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_15 (Averag (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_15 (Dropout)         (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_5 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_9 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_5 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_10 (Dense)             (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 7 with slep gave avg accuracy 0.5909356743097305/0.2942528733748129 over 10 splits
2018-05-21 14:59:36.424069: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-21 14:59:36.669411: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-21 14:59:36.792709: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-21 14:59:36.941178: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-21 14:59:37.077692: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-21 14:59:37.078387: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-21 14:59:37.078508: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-21 14:59:37.078539: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-21 14:59:37.078560: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-21 14:59:37.078579: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-21 14:59:37.078598: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-21 14:59:37.078651: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-21 14:59:37.078678: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-21 14:59:37.078700: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-21 14:59:37.078721: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-21 15:00:26.029757: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-21 15:00:26.029884: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-21 15:00:26.029909: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-21 15:00:26.029928: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 9516476333104986227
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 3479165231973860423
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323080704
locality {
  bus_id: 1
}
incarnation: 8506904141641780314
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 2
}
incarnation: 15860225938510579483
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 10075380284564037501
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.784577/DATA/Modified/spectogram/spec_08.mat
(1, 190)
(1, 190)
(190, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/spec_08_t.mat
(1, 113)
(1, 113)
(113, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 8 with spec gave avg accuracy 0.6736842036247254/0.35486725709870853 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/wig_08.mat
(1, 190)
(1, 190)
(190, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/wig_08_t.mat
(1, 113)
(1, 113)
(113, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 8 with wig gave avg accuracy 0.6736842066049575/0.3442477883128202 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/amb_08.mat
(1, 190)
(1, 190)
(190, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/amb_08_t.mat
(1, 113)
(1, 113)
(113, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 96, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 96, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 96, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 96, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 48, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 48, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 48, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 48, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 24, 16, 16)        0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 24, 16, 16)        0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 6144)              0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                92175     
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 101,339
Trainable params: 101,339
Non-trainable params: 0
_________________________________________________________________
sub 8 with amb gave avg accuracy 0.5421052724123001/0.33185840837855257 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/cwt_08.mat
(1, 190)
(1, 190)
(190, 192, 47, 31)
(192, 47, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/cwt_08_t.mat
(1, 113)
(1, 113)
(113, 192, 47, 31)
(192, 47, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 192, 47, 31)       0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 192, 47, 4)        3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 192, 47, 4)        0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 96, 11, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 96, 11, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 96, 11, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 96, 11, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 48, 2, 8)          0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 48, 2, 8)          0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 48, 2, 16)         4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 48, 2, 16)         0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 24, 1, 16)         0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 24, 1, 16)         0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 8 with cwt gave avg accuracy 0.7105263233184814/0.3185840711689892 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/slep_08.mat
(1, 190)
(1, 190)
(190, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/slep_08_t.mat
(1, 113)
(1, 113)
(113, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_5 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_13 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_13 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_13 (Averag (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_13 (Dropout)         (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_14 (Conv2D)           (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_14 (ELU)                 (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_14 (Averag (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_14 (Dropout)         (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_15 (Conv2D)           (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_15 (ELU)                 (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_15 (Averag (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_15 (Dropout)         (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_5 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_9 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_5 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_10 (Dense)             (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 8 with slep gave avg accuracy 0.6157894790172577/0.3601769919911053 over 10 splits
2018-05-21 18:50:52.082064: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-21 18:50:52.291803: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-21 18:50:52.409124: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-21 18:50:52.542899: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-21 18:50:52.688320: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-21 18:50:52.689034: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-21 18:50:52.689156: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-21 18:50:52.689187: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-21 18:50:52.689207: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-21 18:50:52.689233: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-21 18:50:52.689255: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-21 18:50:52.689285: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-21 18:50:52.689310: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-21 18:50:52.689331: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-21 18:50:52.689351: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-21 18:51:34.777389: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-21 18:51:34.777515: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-21 18:51:34.777554: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-21 18:51:34.777576: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 4847952600122369324
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 9121244225909101074
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323080704
locality {
  bus_id: 1
}
incarnation: 9524076802530558419
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 2
}
incarnation: 16549364029866160160
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 13902306444487700862
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.784577/DATA/Modified/spectogram/spec_09.mat
(1, 186)
(1, 186)
(186, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/spec_09_t.mat
(1, 83)
(1, 83)
(83, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 9 with spec gave avg accuracy 0.5801169574260712/0.35542168789599315 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/wig_09.mat
(1, 186)
(1, 186)
(186, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/wig_09_t.mat
(1, 83)
(1, 83)
(83, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 9 with wig gave avg accuracy 0.5040935769677162/0.35180722875408377 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/amb_09.mat
(1, 186)
(1, 186)
(186, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/amb_09_t.mat
(1, 83)
(1, 83)
(83, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 96, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 96, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 96, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 96, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 48, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 48, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 48, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 48, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 24, 16, 16)        0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 24, 16, 16)        0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 6144)              0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                92175     
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 101,339
Trainable params: 101,339
Non-trainable params: 0
_________________________________________________________________
sub 9 with amb gave avg accuracy 0.501461997628212/0.31445783114576914 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/cwt_09.mat
(1, 186)
(1, 186)
(186, 192, 47, 31)
(192, 47, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/cwt_09_t.mat
(1, 83)
(1, 83)
(83, 192, 47, 31)
(192, 47, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 192, 47, 31)       0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 192, 47, 4)        3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 192, 47, 4)        0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 96, 11, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 96, 11, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 96, 11, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 96, 11, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 48, 2, 8)          0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 48, 2, 8)          0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 48, 2, 16)         4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 48, 2, 16)         0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 24, 1, 16)         0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 24, 1, 16)         0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 9 with cwt gave avg accuracy 0.6988304078578949/0.35662650596126017 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/slep_09.mat
(1, 186)
(1, 186)
(186, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/slep_09_t.mat
(1, 83)
(1, 83)
(83, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_5 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_13 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_13 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_13 (Averag (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_13 (Dropout)         (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_14 (Conv2D)           (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_14 (ELU)                 (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_14 (Averag (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_14 (Dropout)         (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_15 (Conv2D)           (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_15 (ELU)                 (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_15 (Averag (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_15 (Dropout)         (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_5 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_9 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_5 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_10 (Dense)             (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 9 with slep gave avg accuracy 0.5631578892469407/0.36987951778503786 over 10 splits
2018-05-21 22:40:43.307637: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-21 22:40:43.578786: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-21 22:40:43.712831: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-21 22:40:43.871544: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-21 22:40:44.018770: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-21 22:40:44.019531: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-21 22:40:44.019663: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-21 22:40:44.019695: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-21 22:40:44.019717: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-21 22:40:44.019736: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-21 22:40:44.019755: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-21 22:40:44.019786: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-21 22:40:44.019812: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-21 22:40:44.019834: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-21 22:40:44.019856: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-21 22:41:27.279089: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-21 22:41:27.279212: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-21 22:41:27.279255: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-21 22:41:27.279276: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 16136719162801992161
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 14758618922361311145
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323080704
locality {
  bus_id: 1
}
incarnation: 4579342935124430645
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 2
}
incarnation: 3898299943523518193
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 9076996933889661130
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.784577/DATA/Modified/spectogram/spec_11.mat
(1, 182)
(1, 182)
(182, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/spec_11_t.mat
(1, 98)
(1, 98)
(98, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 11 with spec gave avg accuracy 0.5546783655881882/0.3142857142857143 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/wig_11.mat
(1, 182)
(1, 182)
(182, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/wig_11_t.mat
(1, 98)
(1, 98)
(98, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 11 with wig gave avg accuracy 0.48888890296220777/0.33163265306122447 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/amb_11.mat
(1, 182)
(1, 182)
(182, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/amb_11_t.mat
(1, 98)
(1, 98)
(98, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 96, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 96, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 96, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 96, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 48, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 48, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 48, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 48, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 24, 16, 16)        0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 24, 16, 16)        0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 6144)              0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                92175     
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 101,339
Trainable params: 101,339
Non-trainable params: 0
_________________________________________________________________
sub 11 with amb gave avg accuracy 0.45000000596046447/0.32142857142857145 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/cwt_11.mat
(1, 182)
(1, 182)
(182, 192, 47, 31)
(192, 47, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/cwt_11_t.mat
(1, 98)
(1, 98)
(98, 192, 47, 31)
(192, 47, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 192, 47, 31)       0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 192, 47, 4)        3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 192, 47, 4)        0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 96, 11, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 96, 11, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 96, 11, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 96, 11, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 48, 2, 8)          0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 48, 2, 8)          0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 48, 2, 16)         4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 48, 2, 16)         0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 24, 1, 16)         0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 24, 1, 16)         0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 11 with cwt gave avg accuracy 0.6324561387300491/0.3459183673469388 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/slep_11.mat
(1, 182)
(1, 182)
(182, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/slep_11_t.mat
(1, 98)
(1, 98)
(98, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_5 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_13 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_13 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_13 (Averag (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_13 (Dropout)         (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_14 (Conv2D)           (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_14 (ELU)                 (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_14 (Averag (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_14 (Dropout)         (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_15 (Conv2D)           (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_15 (ELU)                 (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_15 (Averag (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_15 (Dropout)         (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_5 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_9 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_5 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_10 (Dense)             (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 11 with slep gave avg accuracy 0.554385969042778/0.30612244897959184 over 10 splits
2018-05-22 02:26:56.928421: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-22 02:26:57.189602: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-22 02:26:57.309984: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-22 02:26:57.470398: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-22 02:26:57.617094: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-22 02:26:57.617842: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-22 02:26:57.617964: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-22 02:26:57.617995: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-22 02:26:57.618014: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-22 02:26:57.618032: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-22 02:26:57.618050: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-22 02:26:57.618079: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-22 02:26:57.618103: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-22 02:26:57.618123: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-22 02:26:57.618143: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-22 02:27:52.326382: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-22 02:27:52.326513: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-22 02:27:52.326540: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-22 02:27:52.326561: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 13348233947013476937
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 11766995548254377976
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323080704
locality {
  bus_id: 1
}
incarnation: 11252343564351953723
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 2
}
incarnation: 7112044604409411066
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 7461397561813498285
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.784577/DATA/Modified/spectogram/spec_12.mat
(1, 190)
(1, 190)
(190, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/spec_12_t.mat
(1, 95)
(1, 95)
(95, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 12 with spec gave avg accuracy 0.5631578981876373/0.31684210171825006 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/wig_12.mat
(1, 190)
(1, 190)
(190, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/wig_12_t.mat
(1, 95)
(1, 95)
(95, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 12 with wig gave avg accuracy 0.5210526257753372/0.31052631384448004 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/amb_12.mat
(1, 190)
(1, 190)
(190, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/amb_12_t.mat
(1, 95)
(1, 95)
(95, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 96, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 96, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 96, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 96, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 48, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 48, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 48, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 48, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 24, 16, 16)        0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 24, 16, 16)        0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 6144)              0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                92175     
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 101,339
Trainable params: 101,339
Non-trainable params: 0
_________________________________________________________________
sub 12 with amb gave avg accuracy 0.5315789580345154/0.3463157871522401 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/cwt_12.mat
(1, 190)
(1, 190)
(190, 192, 47, 31)
(192, 47, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/cwt_12_t.mat
(1, 95)
(1, 95)
(95, 192, 47, 31)
(192, 47, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 192, 47, 31)       0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 192, 47, 4)        3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 192, 47, 4)        0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 96, 11, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 96, 11, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 96, 11, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 96, 11, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 48, 2, 8)          0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 48, 2, 8)          0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 48, 2, 16)         4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 48, 2, 16)         0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 24, 1, 16)         0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 24, 1, 16)         0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 12 with cwt gave avg accuracy 0.684210529923439/0.32842105068658534 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/slep_12.mat
(1, 190)
(1, 190)
(190, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/slep_12_t.mat
(1, 95)
(1, 95)
(95, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_5 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_13 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_13 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_13 (Averag (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_13 (Dropout)         (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_14 (Conv2D)           (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_14 (ELU)                 (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_14 (Averag (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_14 (Dropout)         (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_15 (Conv2D)           (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_15 (ELU)                 (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_15 (Averag (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_15 (Dropout)         (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_5 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_9 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_5 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_10 (Dense)             (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 12 with slep gave avg accuracy 0.5947368502616882/0.32210525992669553 over 10 splits
2018-05-22 06:25:37.119888: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-22 06:25:37.367013: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-22 06:25:37.492112: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-22 06:25:37.651439: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-22 06:25:37.803447: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-22 06:25:37.804178: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-22 06:25:37.804324: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-22 06:25:37.804359: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-22 06:25:37.804382: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-22 06:25:37.804403: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-22 06:25:37.804423: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-22 06:25:37.804454: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-22 06:25:37.804481: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-22 06:25:37.804505: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-22 06:25:37.804553: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-22 06:26:26.642609: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-22 06:26:26.642735: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-22 06:26:26.642761: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-22 06:26:26.642779: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 11738894875414161542
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 242376641732330257
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323080704
locality {
  bus_id: 1
}
incarnation: 6178337810961768373
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 2
}
incarnation: 310640070992476203
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 17348224529292918175
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.784577/DATA/Modified/spectogram/spec_13.mat
(1, 188)
(1, 188)
(188, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/spec_13_t.mat
(1, 113)
(1, 113)
(113, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 13 with spec gave avg accuracy 0.6380116939544678/0.3451327438870099 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/wig_13.mat
(1, 188)
(1, 188)
(188, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/wig_13_t.mat
(1, 113)
(1, 113)
(113, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 13 with wig gave avg accuracy 0.5543859630823136/0.2938053100246244 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/amb_13.mat
(1, 188)
(1, 188)
(188, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/amb_13_t.mat
(1, 113)
(1, 113)
(113, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 96, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 96, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 96, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 96, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 48, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 48, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 48, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 48, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 24, 16, 16)        0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 24, 16, 16)        0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 6144)              0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                92175     
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 101,339
Trainable params: 101,339
Non-trainable params: 0
_________________________________________________________________
sub 13 with amb gave avg accuracy 0.6236842125654221/0.3345132751472756 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/cwt_13.mat
(1, 188)
(1, 188)
(188, 192, 47, 31)
(192, 47, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/cwt_13_t.mat
(1, 113)
(1, 113)
(113, 192, 47, 31)
(192, 47, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 192, 47, 31)       0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 192, 47, 4)        3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 192, 47, 4)        0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 96, 11, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 96, 11, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 96, 11, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 96, 11, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 48, 2, 8)          0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 48, 2, 8)          0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 48, 2, 16)         4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 48, 2, 16)         0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 24, 1, 16)         0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 24, 1, 16)         0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 13 with cwt gave avg accuracy 0.7178362667560577/0.30353982350995057 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/slep_13.mat
(1, 188)
(1, 188)
(188, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/slep_13_t.mat
(1, 113)
(1, 113)
(113, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_5 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_13 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_13 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_13 (Averag (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_13 (Dropout)         (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_14 (Conv2D)           (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_14 (ELU)                 (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_14 (Averag (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_14 (Dropout)         (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_15 (Conv2D)           (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_15 (ELU)                 (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_15 (Averag (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_15 (Dropout)         (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_5 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_9 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_5 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_10 (Dense)             (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 13 with slep gave avg accuracy 0.5748538076877594/0.3380530980440368 over 10 splits
2018-05-22 10:17:11.186979: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-22 10:17:11.506067: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-22 10:17:11.649749: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-22 10:17:11.801397: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-22 10:17:11.943273: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-22 10:17:11.943951: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-22 10:17:11.944059: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-22 10:17:11.944086: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-22 10:17:11.944104: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-22 10:17:11.944119: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-22 10:17:11.944135: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-22 10:17:11.944160: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-22 10:17:11.944180: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-22 10:17:11.944198: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-22 10:17:11.944215: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-22 10:17:48.881786: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-22 10:17:48.881912: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-22 10:17:48.881937: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-22 10:17:48.881955: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 7644325224772170625
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 2216734709507889356
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323080704
locality {
  bus_id: 1
}
incarnation: 12216120740284440614
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 2
}
incarnation: 9230650377078776982
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 10081460636044402427
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.784577/DATA/Modified/spectogram/spec_14.mat
(1, 191)
(1, 191)
(191, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/spec_14_t.mat
(1, 74)
(1, 74)
(74, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 14 with spec gave avg accuracy 0.5813157856464386/0.3486486489708359 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/wig_14.mat
(1, 191)
(1, 191)
(191, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/wig_14_t.mat
(1, 74)
(1, 74)
(74, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 14 with wig gave avg accuracy 0.5552631586790084/0.31756756841330913 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/amb_14.mat
(1, 191)
(1, 191)
(191, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/amb_14_t.mat
(1, 74)
(1, 74)
(74, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 96, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 96, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 96, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 96, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 48, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 48, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 48, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 48, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 24, 16, 16)        0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 24, 16, 16)        0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 6144)              0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                92175     
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 101,339
Trainable params: 101,339
Non-trainable params: 0
_________________________________________________________________
sub 14 with amb gave avg accuracy 0.4457894772291183/0.3445945949167819 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/cwt_14.mat
(1, 191)
(1, 191)
(191, 192, 47, 31)
(192, 47, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/cwt_14_t.mat
(1, 74)
(1, 74)
(74, 192, 47, 31)
(192, 47, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 192, 47, 31)       0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 192, 47, 4)        3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 192, 47, 4)        0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 96, 11, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 96, 11, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 96, 11, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 96, 11, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 48, 2, 8)          0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 48, 2, 8)          0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 48, 2, 16)         4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 48, 2, 16)         0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 24, 1, 16)         0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 24, 1, 16)         0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 14 with cwt gave avg accuracy 0.5926315695047378/0.3689189198452073 over 10 splits
/local/slurmtmp.784577/DATA/Modified/spectogram/slep_14.mat
(1, 191)
(1, 191)
(191, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.784577/DATA/Modified/spectogram/slep_14_t.mat
(1, 74)
(1, 74)
(74, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_5 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_13 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_13 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_13 (Averag (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_13 (Dropout)         (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_14 (Conv2D)           (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_14 (ELU)                 (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_14 (Averag (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_14 (Dropout)         (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_15 (Conv2D)           (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_15 (ELU)                 (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_15 (Averag (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_15 (Dropout)         (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_5 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_9 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_5 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_10 (Dense)             (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 14 with slep gave avg accuracy 0.5863157957792282/0.35540540604977994 over 10 splits
/local/slurmtmp.778338/DATA/Modified/spectogram/spec_15.mat
(1, 181)
(1, 181)
(181, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.778338/DATA/Modified/spectogram/spec_15_t.mat
(1, 125)
(1, 125)
(125, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 15 with spec gave avg accuracy 0.6143274873495101/0.3775999990940094 over 10 splits
/local/slurmtmp.778338/DATA/Modified/spectogram/wig_15.mat
(1, 181)
(1, 181)
(181, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.778338/DATA/Modified/spectogram/wig_15_t.mat
(1, 125)
(1, 125)
(125, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 15 with wig gave avg accuracy 0.605847954750061/0.3680000011444092 over 10 splits
/local/slurmtmp.778338/DATA/Modified/spectogram/amb_15.mat
(1, 181)
(1, 181)
(181, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.778338/DATA/Modified/spectogram/amb_15_t.mat
(1, 125)
(1, 125)
(125, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 96, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 96, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 96, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 96, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 48, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 48, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 48, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 48, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 24, 16, 16)        0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 24, 16, 16)        0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 6144)              0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                92175     
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 101,339
Trainable params: 101,339
Non-trainable params: 0
_________________________________________________________________
sub 15 with amb gave avg accuracy 0.5690058574080468/0.36719999904632566 over 10 splits
/local/slurmtmp.778338/DATA/Modified/spectogram/cwt_15.mat
(1, 181)
(1, 181)
(181, 192, 47, 31)
(192, 47, 31)
/local/slurmtmp.778338/DATA/Modified/spectogram/cwt_15_t.mat
(1, 125)
(1, 125)
(125, 192, 47, 31)
(192, 47, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 192, 47, 31)       0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 192, 47, 4)        3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 192, 47, 4)        0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 96, 11, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 96, 11, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 96, 11, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 96, 11, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 48, 2, 8)          0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 48, 2, 8)          0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 48, 2, 16)         4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 48, 2, 16)         0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 24, 1, 16)         0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 24, 1, 16)         0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 15 with cwt gave avg accuracy 0.7520467817783356/0.33039999969005585 over 10 splits
/local/slurmtmp.778338/DATA/Modified/spectogram/slep_15.mat
(1, 181)
(1, 181)
(181, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.778338/DATA/Modified/spectogram/slep_15_t.mat
(1, 125)
(1, 125)
(125, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_5 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_13 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_13 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_13 (Averag (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_13 (Dropout)         (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_14 (Conv2D)           (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_14 (ELU)                 (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_14 (Averag (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_14 (Dropout)         (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_15 (Conv2D)           (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_15 (ELU)                 (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_15 (Averag (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_15 (Dropout)         (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_5 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_9 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_5 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_10 (Dense)             (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 15 with slep gave avg accuracy 0.6347953289747238/0.3535999984979629 over 10 splits
2018-05-18 13:21:06.229667: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-18 13:21:06.444450: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-18 13:21:06.564582: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-18 13:21:06.712238: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-18 13:21:06.845602: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-18 13:21:06.846302: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-18 13:21:06.846423: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-18 13:21:06.846451: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-18 13:21:06.846470: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-18 13:21:06.846488: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-18 13:21:06.846505: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-18 13:21:06.846537: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-18 13:21:06.846561: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-18 13:21:06.846582: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-18 13:21:06.846601: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-18 13:21:50.546093: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-18 13:21:50.546224: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-18 13:21:50.546274: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-18 13:21:50.546294: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 7368243369100162652
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 12435208216452033840
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 14544285175489273729
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 9356084883289904703
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 3374434722329441512
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.778338/DATA/Modified/spectogram/spec_16.mat
(1, 192)
(1, 192)
(192, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.778338/DATA/Modified/spectogram/spec_16_t.mat
(1, 62)
(1, 62)
(62, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 16 with spec gave avg accuracy 0.437105268239975/0.33548387380376943 over 10 splits
/local/slurmtmp.778338/DATA/Modified/spectogram/wig_16.mat
(1, 192)
(1, 192)
(192, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.778338/DATA/Modified/spectogram/wig_16_t.mat
(1, 62)
(1, 62)
(62, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 16 with wig gave avg accuracy 0.47894737124443054/0.38225806826545344 over 10 splits
/local/slurmtmp.778338/DATA/Modified/spectogram/amb_16.mat
(1, 192)
(1, 192)
(192, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.778338/DATA/Modified/spectogram/amb_16_t.mat
(1, 62)
(1, 62)
(62, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 96, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 96, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 96, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 96, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 48, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 48, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 48, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 48, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 24, 16, 16)        0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 24, 16, 16)        0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 6144)              0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                92175     
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 101,339
Trainable params: 101,339
Non-trainable params: 0
_________________________________________________________________
sub 16 with amb gave avg accuracy 0.43342105597257613/0.34516129253372074 over 10 splits
/local/slurmtmp.778338/DATA/Modified/spectogram/cwt_16.mat
(1, 192)
(1, 192)
(192, 192, 47, 31)
(192, 47, 31)
/local/slurmtmp.778338/DATA/Modified/spectogram/cwt_16_t.mat
(1, 62)
(1, 62)
(62, 192, 47, 31)
(192, 47, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 192, 47, 31)       0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 192, 47, 4)        3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 192, 47, 4)        0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 96, 11, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 96, 11, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 96, 11, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 96, 11, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 48, 2, 8)          0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 48, 2, 8)          0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 48, 2, 16)         4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 48, 2, 16)         0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 24, 1, 16)         0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 24, 1, 16)         0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 16 with cwt gave avg accuracy 0.6502631604671478/0.362903229363503 over 10 splits
/local/slurmtmp.778338/DATA/Modified/spectogram/slep_16.mat
(1, 192)
(1, 192)
(192, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.778338/DATA/Modified/spectogram/slep_16_t.mat
(1, 62)
(1, 62)
(62, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_5 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_13 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_13 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_13 (Averag (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_13 (Dropout)         (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_14 (Conv2D)           (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_14 (ELU)                 (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_14 (Averag (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_14 (Dropout)         (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_15 (Conv2D)           (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_15 (ELU)                 (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_15 (Averag (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_15 (Dropout)         (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_5 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_9 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_5 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_10 (Dense)             (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 16 with slep gave avg accuracy 0.453157901763916/0.3354838744767251 over 10 splits
2018-05-18 17:16:39.224349: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-18 17:16:39.461691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-18 17:16:39.596673: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-18 17:16:39.740751: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-18 17:16:39.875212: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-18 17:16:39.875948: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-18 17:16:39.876090: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-18 17:16:39.876123: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-18 17:16:39.876145: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-18 17:16:39.876166: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-18 17:16:39.876186: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-18 17:16:39.876221: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-18 17:16:39.876248: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-18 17:16:39.876273: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-18 17:16:39.876295: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-18 17:17:23.032195: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-18 17:17:23.032313: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-18 17:17:23.032336: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-18 17:17:23.032353: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 16463630168527925161
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 15441854215389183710
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 5793603984308505191
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 16579016987005095862
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 11683460965503717812
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.778338/DATA/Modified/spectogram/spec_17.mat
(1, 190)
(1, 190)
(190, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.778338/DATA/Modified/spectogram/spec_17_t.mat
(1, 68)
(1, 68)
(68, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 17 with spec gave avg accuracy 0.6736842185258866/0.3279411764705883 over 10 splits
/local/slurmtmp.778338/DATA/Modified/spectogram/wig_17.mat
(1, 190)
(1, 190)
(190, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.778338/DATA/Modified/spectogram/wig_17_t.mat
(1, 68)
(1, 68)
(68, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 17 with wig gave avg accuracy 0.6105263143777847/0.2941176470588235 over 10 splits
/local/slurmtmp.778338/DATA/Modified/spectogram/amb_17.mat
(1, 190)
(1, 190)
(190, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.778338/DATA/Modified/spectogram/amb_17_t.mat
(1, 68)
(1, 68)
(68, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 96, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 96, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 96, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 96, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 48, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 48, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 48, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 48, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 24, 16, 16)        0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 24, 16, 16)        0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 6144)              0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                92175     
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 101,339
Trainable params: 101,339
Non-trainable params: 0
_________________________________________________________________
sub 17 with amb gave avg accuracy 0.5947368443012238/0.34558823529411764 over 10 splits
/local/slurmtmp.778338/DATA/Modified/spectogram/cwt_17.mat
(1, 190)
(1, 190)
(190, 192, 47, 31)
(192, 47, 31)
/local/slurmtmp.778338/DATA/Modified/spectogram/cwt_17_t.mat
(1, 68)
(1, 68)
(68, 192, 47, 31)
(192, 47, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 192, 47, 31)       0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 192, 47, 4)        3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 192, 47, 4)        0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 96, 11, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 96, 11, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 96, 11, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 96, 11, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 48, 2, 8)          0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 48, 2, 8)          0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 48, 2, 16)         4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 48, 2, 16)         0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 24, 1, 16)         0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 24, 1, 16)         0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 17 with cwt gave avg accuracy 0.7736842036247253/0.2985294117647059 over 10 splits
/local/slurmtmp.778338/DATA/Modified/spectogram/slep_17.mat
(1, 190)
(1, 190)
(190, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.778338/DATA/Modified/spectogram/slep_17_t.mat
(1, 68)
(1, 68)
(68, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_5 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_13 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_13 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_13 (Averag (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_13 (Dropout)         (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_14 (Conv2D)           (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_14 (ELU)                 (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_14 (Averag (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_14 (Dropout)         (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_15 (Conv2D)           (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_15 (ELU)                 (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_15 (Averag (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_15 (Dropout)         (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_5 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_9 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_5 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_10 (Dense)             (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 17 with slep gave avg accuracy 0.678947365283966/0.32205882352941173 over 10 splits
2018-05-18 21:06:18.394379: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-18 21:06:18.633044: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-18 21:06:18.756633: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-18 21:06:18.902034: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-18 21:06:19.048729: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-18 21:06:19.049447: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-18 21:06:19.049566: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-18 21:06:19.049595: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-18 21:06:19.049615: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-18 21:06:19.049633: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-18 21:06:19.049650: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-18 21:06:19.049681: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-18 21:06:19.049706: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-18 21:06:19.049727: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-18 21:06:19.049747: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-18 21:07:02.381097: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-18 21:07:02.381219: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-18 21:07:02.381243: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-18 21:07:02.381260: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 12656588306905208798
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 8592949092708547103
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 12799043894018770175
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 10095758293892807920
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 10241540714841247796
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.778338/DATA/Modified/spectogram/spec_18.mat
(1, 185)
(1, 185)
(185, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.778338/DATA/Modified/spectogram/spec_18_t.mat
(1, 70)
(1, 70)
(70, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 18 with spec gave avg accuracy 0.5853801250457764/0.3128571430700166 over 10 splits
/local/slurmtmp.778338/DATA/Modified/spectogram/wig_18.mat
(1, 185)
(1, 185)
(185, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.778338/DATA/Modified/spectogram/wig_18_t.mat
(1, 70)
(1, 70)
(70, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 18 with wig gave avg accuracy 0.6210526347160339/0.3071428579517773 over 10 splits
/local/slurmtmp.778338/DATA/Modified/spectogram/amb_18.mat
(1, 185)
(1, 185)
(185, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.778338/DATA/Modified/spectogram/amb_18_t.mat
(1, 70)
(1, 70)
(70, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 96, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 96, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 96, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 96, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 48, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 48, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 48, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 48, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 24, 16, 16)        0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 24, 16, 16)        0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 6144)              0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                92175     
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 101,339
Trainable params: 101,339
Non-trainable params: 0
_________________________________________________________________
sub 18 with amb gave avg accuracy 0.6251462042331696/0.294285714668887 over 10 splits
/local/slurmtmp.778338/DATA/Modified/spectogram/cwt_18.mat
(1, 185)
(1, 185)
(185, 192, 47, 31)
(192, 47, 31)
/local/slurmtmp.778338/DATA/Modified/spectogram/cwt_18_t.mat
(1, 70)
(1, 70)
(70, 192, 47, 31)
(192, 47, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 192, 47, 31)       0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 192, 47, 4)        3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 192, 47, 4)        0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 96, 11, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 96, 11, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 96, 11, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 96, 11, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 48, 2, 8)          0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 48, 2, 8)          0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 48, 2, 16)         4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 48, 2, 16)         0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 24, 1, 16)         0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 24, 1, 16)         0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 18 with cwt gave avg accuracy 0.7792397737503052/0.31285714332546505 over 10 splits
/local/slurmtmp.778338/DATA/Modified/spectogram/slep_18.mat
(1, 185)
(1, 185)
(185, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.778338/DATA/Modified/spectogram/slep_18_t.mat
(1, 70)
(1, 70)
(70, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_5 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_13 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_13 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_13 (Averag (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_13 (Dropout)         (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_14 (Conv2D)           (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_14 (ELU)                 (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_14 (Averag (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_14 (Dropout)         (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_15 (Conv2D)           (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_15 (ELU)                 (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_15 (Averag (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_15 (Dropout)         (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_5 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_9 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_5 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_10 (Dense)             (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 18 with slep gave avg accuracy 0.5807017505168914/0.2828571429422923 over 10 splits
2018-05-19 00:52:27.029373: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-19 00:52:27.274630: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-19 00:52:27.402335: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-19 00:52:27.558754: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-19 00:52:27.702814: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-19 00:52:27.703506: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-19 00:52:27.703623: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-19 00:52:27.703652: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-19 00:52:27.703671: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-19 00:52:27.703689: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-19 00:52:27.703707: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-19 00:52:27.703739: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-19 00:52:27.703764: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-19 00:52:27.703785: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-19 00:52:27.703828: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-19 00:53:14.755943: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-19 00:53:14.756072: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-19 00:53:14.756096: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-19 00:53:14.756114: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 1024896055781042102
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 13667148593710162391
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 3724327519525964578
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 14172510690195583001
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 2678627103094398983
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.778338/DATA/Modified/spectogram/spec_19.mat
(1, 181)
(1, 181)
(181, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.778338/DATA/Modified/spectogram/spec_19_t.mat
(1, 91)
(1, 91)
(91, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 19 with spec gave avg accuracy 0.662865498661995/0.33626373644386015 over 10 splits
/local/slurmtmp.778338/DATA/Modified/spectogram/wig_19.mat
(1, 181)
(1, 181)
(181, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.778338/DATA/Modified/spectogram/wig_19_t.mat
(1, 91)
(1, 91)
(91, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 19 with wig gave avg accuracy 0.641228073835373/0.3362637355514281 over 10 splits
/local/slurmtmp.778338/DATA/Modified/spectogram/amb_19.mat
(1, 181)
(1, 181)
(181, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.778338/DATA/Modified/spectogram/amb_19_t.mat
(1, 91)
(1, 91)
(91, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 96, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 96, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 96, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 96, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 48, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 48, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 48, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 48, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 24, 16, 16)        0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 24, 16, 16)        0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 6144)              0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                92175     
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 101,339
Trainable params: 101,339
Non-trainable params: 0
_________________________________________________________________
sub 19 with amb gave avg accuracy 0.6517543852329254/0.28571428507566454 over 10 splits
/local/slurmtmp.778338/DATA/Modified/spectogram/cwt_19.mat
(1, 181)
(1, 181)
(181, 192, 47, 31)
(192, 47, 31)
/local/slurmtmp.778338/DATA/Modified/spectogram/cwt_19_t.mat
(1, 91)
(1, 91)
(91, 192, 47, 31)
(192, 47, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 192, 47, 31)       0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 192, 47, 4)        3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 192, 47, 4)        0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 96, 11, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 96, 11, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 96, 11, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 96, 11, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 48, 2, 8)          0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 48, 2, 8)          0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 48, 2, 16)         4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 48, 2, 16)         0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 24, 1, 16)         0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 24, 1, 16)         0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 19 with cwt gave avg accuracy 0.6967836260795593/0.29230769247962873 over 10 splits
/local/slurmtmp.778338/DATA/Modified/spectogram/slep_19.mat
(1, 181)
(1, 181)
(181, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.778338/DATA/Modified/spectogram/slep_19_t.mat
(1, 91)
(1, 91)
(91, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_5 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_13 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_13 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_13 (Averag (None, 128, 48, 4)        0         
_________________________________________________________________
dropout_13 (Dropout)         (None, 128, 48, 4)        0         
_________________________________________________________________
conv2d_14 (Conv2D)           (None, 128, 48, 8)        1032      
_________________________________________________________________
elu_14 (ELU)                 (None, 128, 48, 8)        0         
_________________________________________________________________
average_pooling2d_14 (Averag (None, 64, 12, 8)         0         
_________________________________________________________________
dropout_14 (Dropout)         (None, 64, 12, 8)         0         
_________________________________________________________________
conv2d_15 (Conv2D)           (None, 64, 12, 16)        4112      
_________________________________________________________________
elu_15 (ELU)                 (None, 64, 12, 16)        0         
_________________________________________________________________
average_pooling2d_15 (Averag (None, 32, 6, 16)         0         
_________________________________________________________________
dropout_15 (Dropout)         (None, 32, 6, 16)         0         
_________________________________________________________________
flatten_5 (Flatten)          (None, 3072)              0         
_________________________________________________________________
dense_9 (Dense)              (None, 15)                46095     
_________________________________________________________________
activation_5 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_10 (Dense)             (None, 3)                 48        
=================================================================
Total params: 55,259
Trainable params: 55,259
Non-trainable params: 0
_________________________________________________________________
sub 19 with slep gave avg accuracy 0.6026315867900849/0.3461538455807246 over 10 splits
end time
Sat May 19 04:37:39 CEST 2018
