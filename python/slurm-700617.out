data dir
/lunarc/nobackup/users/albheim/EEG-klassificering
script
#!/bin/sh
#SBATCH -t 60:00:00
#SBATCH -J all5big
#SBATCH -A lu2018-2-3
#// SBATCH -o stdout_%j.out
#// SBATCH -e stderr_%j.err

# shold be lu or gpu
#SBATCH -p gpu

# how many gpus, 4 per node, using many seems to crash more often so stick with 1
#SBATCH --gres=gpu:4

# use 5 cores per GPU
#SBATCH -n 20
#SBATCH --mem-per-cpu=3100

DATA_DIR="$(cat ../data_location.txt)"
echo "data dir"
echo $DATA_DIR

echo "script"
cat $0

PY_FILE="conv2d_spect.py"
echo "py file"
cat $PY_FILE

echo "data file"
cat "data.py"

echo "mat file"
cat "../matlab/save transformed/savetf.m"

echo "nvidia smi"
nvidia-smi

echo "start time"
date

cp -r "${DATA_DIR}/DATA" $SNIC_TMP
ls $SNIC_TMP
du -h "${SNIC_TMP}/DATA"

echo "copy done time"
date

#matlab -nodisplay -nosplash -nodesktop -r "run('../matlab/save transformed/savetf.m');"
idxs=(1 2 3 4 5 6 7 8 9 11 12 13 14 15 16 17 18 19)
for i in ${idxs[@]}; do
    python $PY_FILE $SNIC_TMP $i
done

echo "end time"
date
py file
import sys
from datetime import datetime

import numpy as np
from scipy import io

import tensorflow as tf

from keras.models import Model
from keras.layers import Dense, Dropout, Input, GaussianNoise, BatchNormalization
from keras.layers import Lambda
from keras.layers import Conv2D, MaxPooling2D, AveragePooling2D
from keras.layers import ELU, Activation, Flatten

from keras import backend as K
from keras import regularizers as rg

from tensorflow.python.client import device_lib
print(device_lib.list_local_devices())

import data
import util

funcs = ["spec", "wig", "amb", "cwt", "slep"]
sub = int(sys.argv[2])

splits = 10

for func in funcs:
    x, y = data.load_transform([sub], func)
    xt, yt = data.load_transform([sub], func, test=True)

    m_in = Input(shape=x[0][0].shape)

    m_t = Conv2D(4, (8, 4), padding='same')(m_in) #, kernel_regularizer=rg.l1(0.01)
    #m_t = BatchNormalization()(m_t)
    m_t = ELU()(m_t)
    m_t = AveragePooling2D((4, 1 if func == "cwt" else 4))(m_t)
    m_t = Dropout(0.2)(m_t)

    m_t = Conv2D(8, (8, 4), padding='same')(m_t)
    #m_t = BatchNormalization()(m_t)
    m_t = ELU()(m_t)
    m_t = AveragePooling2D((4, 1 if func == "cwt" else 4))(m_t)
    m_t = Dropout(0.3)(m_t)

    m_t = Conv2D(16, (8, 4), padding='same')(m_t)
    #m_t = BatchNormalization()(m_t)
    m_t = ELU()(m_t)
    m_t = AveragePooling2D((4, 1 if func == "cwt" else 4))(m_t)
    m_t = Dropout(0.3)(m_t)

    m_t = Flatten()(m_t)
    m_t = Dense(10, kernel_regularizer=rg.l1(0.01))(m_t)
    #m_t = BatchNormalization()(m_t)
    m_t = Activation('tanh')(m_t)
    m_out = Dense(3, activation='softmax')(m_t)

    model = Model(inputs=m_in, outputs=m_out)

    m_save = model.get_config()
    model.summary()

    acc = 0
    acc2 = 0
    for tr, val in util.kfold(len(x[0]), splits, shuffle=True):

        model = Model.from_config(m_save)
        model.compile(loss='categorical_crossentropy',
                      optimizer='adam',
                      metrics=['accuracy'])
        # fit with next kfold data
        h = model.fit(x[0][tr], y[0][tr],
                      #validation_data=(x[0][val], y[0][val]),
                      batch_size=16, epochs=50, verbose=0)

        _, a = model.evaluate(x[0][val], y[0][val], verbose=0)
        _, a2 = model.evaluate(xt[0], yt[0], verbose=0)
        acc += a
        acc2 += a2

    acc /= splits
    acc2 /= splits

    print("sub {} with {} gave avg accuracy {}/{} over {} splits".format(sub, func, acc, acc2, splits))
data file
import sys

import numpy as np
from scipy import io
import h5py


def load_single_sub(sub, cut=True, study=True, shuffle=True, visual=True, transpose=False):
    snic_tmp = "C:/Users/Albin Heimerson/Desktop/exjobb"
    if len(sys.argv) > 1:
        snic_tmp = str(sys.argv[1])
    xn = None
    yn = None
    names = ["FA", "LM", "OB"]
    for i in range(3):
        name = "Subj{:02}_CleanData_{}_{}".format(sub,
                                                  'study' if study else 'test',
                                                  names[i])
        if not study:
            name += "_{}".format("visual" if visual else "lexical")

        print("loading: ", name)
        m = io.loadmat('{}/DATA/{}/{}.mat'.format(snic_tmp,
                                                  "Visual" if visual else "Verbal",
                                                  name))
        trials = m[name][0][0][2][0]
        for j in range(trials.shape[0]):
            if cut:
                trials[j] = trials[j][:, 768:1536]
            if transpose:
                trials[j] = trials[j].T
        labels = np.zeros((trials.shape[0], 3))
        labels[:, i] = 1
        if xn is None:
            xn = trials
            yn = labels
        else:
            xn = np.concatenate((xn, trials), axis=0)
            yn = np.concatenate((yn, labels), axis=0)

    xn = np.stack(xn, axis=0)
    n = xn.shape[0]
    s = np.arange(n)
    if shuffle:
        np.random.shuffle(s)

    return (xn[s], yn[s])


def load_single(idx=None, cut=True, shuffle=True, visual=True, transpose=False,
                study=True):
    x = []
    y = []

    if idx is None:
        if visual:
            idx = [i if i < 10 else i + 1 for i in range(1, 19)]
        else:
            idx = [1, 2, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22]

    for sub in idx:
        xn, yn = load_single_sub(sub, cut, study, shuffle, visual, transpose)
        x.append(xn)
        y.append(yn)

    return (x, y)


def load_all(cut=True, visual=True, study=True, transpose=False):
    x = None
    y = None

    if visual:
        subs = [i if i < 10 else i + 1 for i in range(1, 19)]
    else:
        subs = [1, 2, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22]

    for sub in subs:  # 19 is max
        xn, yn = load_single_sub(sub, cut, study, False, visual, transpose)
        if x is None:
            x = xn
            y = yn
        else:
            x = np.concatenate((x, x), axis=0)
            y = np.concatenate((y, y), axis=0)

    print(x.shape, y.shape)
    x = np.stack(x, axis=0)
    print(x.shape)
    s = np.arange(x.shape[0])
    np.random.shuffle(s)

    return (x[s], y[s])


def load_marg(cut=None, visual=True, shuffle=True):
    snic_tmp = "C:/Users/Albin Heimerson/Desktop/exjobb"
    if len(sys.argv) > 1:
        snic_tmp = str(sys.argv[1])
    x = []
    y = []
    if visual:
        subs = [i if i < 10 else i + 1 for i in range(1, 19)]
    else:
        subs = [1, 2, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22]
    for sub in subs:
        xn = None
        yn = None
        for i in range(3):
            name = "Subj{:02}_{}_marg".format(sub, "Visual" if visual else "Verbal")
            print("loading: ", name)
            m = io.loadmat('{}/DATA/Modified/marginal/{}.mat'.format(snic_tmp, name))

            trials = m['data'][0][0][i][:, 0]
            if cut is not None:
                for j in range(trials.shape[0]):
                    trials[j] = trials[j][:, cut[0]:cut[1]]
            labels = np.zeros((trials.shape[0], 3))
            labels[:, i] = 1
            if xn is None:
                xn = trials
                yn = labels
            else:
                xn = np.concatenate((xn, trials), axis=0)
                yn = np.concatenate((yn, labels), axis=0)

        xn = np.stack(xn, axis=0)
        n = xn.shape[0]
        s = np.arange(n)
        if shuffle:
            np.random.shuffle(s)
        x.append(xn[s])
        y.append(yn[s])

    print(x[0].shape)
    return (x, y)


def cut(data, cut=[768, 1536], tcut = None):
    if tcut is not None:
        cut[0] = int(512 * tcut[0] + 768)
        cut[1] = int(512 * tcut[1] + 768)
    print(cut)
    for sub in range(len(data)):
        data[sub] = data[sub][:, :, cut[0]:cut[1]]


def modify(x, y, n, nmult=0, displacement=0, cut=[768, 1536]):
    mdata = [None for i in range(len(x))]
    my = [None for i in range(len(x))]
    for sub in range(len(mdata)):
        s = x[sub].shape[0]
        my[sub] = np.zeros((s * n, 3))
        for j in range(0, s * n, s):
            my[sub][j:j + s] = y[sub]
        mdata[sub] = np.zeros((s * n, x[sub].shape[1], cut[1] - cut[0]))
        mdata[sub][:s, :, :] = x[sub][:, :, cut[0]:cut[1]]
        for j in range(s, s * n, s):
            for i in range(len(x[sub])):
                if displacement > 0:
                    d = np.random.randint(-displacement, displacement + 1)
                    mdata[sub][j:j + s, :, :] = x[sub][:, :, cut[0] + d:cut[1] + d]

                if nmult != 0:
                    for k in range(mdata[sub][i].shape[0]):
                        mdata[sub][j + i, k] += nmult * np.std(mdata[sub][i, k]) * np.random.ranf(mdata[sub][i, k].shape)

    return mdata, my


def load_transform(idx, trans, test=False):
    snic_tmp = "C:/Users/Albin Heimerson/Desktop/exjobb"
    if len(sys.argv) > 1:
        snic_tmp = str(sys.argv[1])
    x = []
    y = []
    for sub in idx:
        fname = '{}/DATA/Modified/spectogram/{}_{:02}{}.mat'.format(snic_tmp, trans, sub, 
                                                                    '_t' if test else '')
        print(fname)
        with h5py.File(fname) as f:
            t = f['Y']
            print(t.shape)
            yn = np.zeros((t.shape[1], 3))
            for i in range(t.shape[1]):
                yn[i, int(t[0, i]) - 1] = 1

            y.append(yn)

            t = f['Xt']
            print(t.shape)
            xn = [None for i in range(t.shape[1])]
            for i in range(t.shape[1]):
                xn[i] = np.array(f[t[0, i]])

            xn = np.stack(xn, 0)

            if len(xn.shape) < 4:
                xn = xn[:, :, :, np.newaxis]
            else:
                xn = np.transpose(xn, (0, 2, 3, 1))

            print(xn.shape)
            print(xn[0].shape)
            x.append(xn)

    return (x, y)


def load_spect_downsample(visual=True, shuffle=True, ds=8):
    snic_tmp = "C:/Users/Albin Heimerson/Desktop/exjobb"
    if len(sys.argv) > 1:
        snic_tmp = str(sys.argv[1])
    x = []
    y = []
    if visual:
        subs = [i if i < 10 else i + 1 for i in range(2, 19)] # change to 1
    else:
        subs = [1, 2, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22]
    for sub in subs:
        xn = None
        yn = None
        for i in range(3):
            name = "Subj{:02}_{}_spec{}".format(sub, "Visual" if visual else "Verbal", ds)
            print("loading: ", name)
            m = io.loadmat('{}/DATA/Modified/spect_downsample/{}.mat'.format(snic_tmp, name))

            trials = m['data'][0][0][i][:, 0]
            labels = np.zeros((trials.shape[0], 3))
            labels[:, i] = 1
            if xn is None:
                xn = trials
                yn = labels
            else:
                xn = np.concatenate((xn, trials), axis=0)
                yn = np.concatenate((yn, labels), axis=0)

        xn = np.stack(xn, axis=0)
        n = xn.shape[0]
        s = np.arange(n)
        if shuffle:
            np.random.shuffle(s)
        x.append(xn[s])
        y.append(yn[s])

    print(x[0].shape)
    return (x, y)
mat file
clear; clc; close all
addpath('..')
addpath('../borrowed code')

for idx = [1 2 3 4 5 6 7 8 9 11 12 13 14 15 16 17 18 19]
    sub = sprintf('%02d', idx);
    [X,Y,n] = aux_load('Visual',sub);

    param.L = 8; param.Fs = 512; param.NFFT = 512; param.NSTEP = 1; 
    param.method = 'l-ind'; param.NW = 3;

    %X = aux_chan(X,[5 24 29]);
    X = aux_extr(X, 769:1536);
    X = aux_deci(X,4);
    %X = aux_svd(X, 1);

    ms = ["spec", "wig", "amb", "cwt", "slep"]
    for method = ms
        Xt = aux_transform(X, method, param);

        for i = 1:length(Xt)
            Xt{i} = real(permute(Xt{i}, [2 3 1]));
        end
        method
        size(Xt{1})

        %save(sprintf('C:\\Users\\Albin Heimerson\\Desktop\\exjobb\\DATA\\Modified\\spectogram\\%s_%s.mat', method, sub), 'Xt', 'Y', '-v7.3')

        save(sprintf('/lunarc/nobackup/users/albheim/EEG-klassificering/DATA/Modified/spectogram/%s_%s.mat', method, sub), 'Xt', 'Y', '-v7.3')
    end
end

nvidia smi
Wed May  2 16:42:13 2018       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 390.46                 Driver Version: 390.46                    |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:04:00.0 Off |                    0 |
| N/A   24C    P8    27W / 149W |      0MiB / 11441MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:05:00.0 Off |                    0 |
| N/A   30C    P8    31W / 149W |      0MiB / 11441MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   2  Tesla K80           On   | 00000000:84:00.0 Off |                    0 |
| N/A   24C    P8    25W / 149W |      0MiB / 11441MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   3  Tesla K80           On   | 00000000:85:00.0 Off |                    0 |
| N/A   31C    P8    30W / 149W |      0MiB / 11441MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
start time
Wed May  2 16:42:13 CEST 2018
DATA
2.4G	/local/slurmtmp.700617/DATA/Visual
2.4G	/local/slurmtmp.700617/DATA/Verbal
388M	/local/slurmtmp.700617/DATA/Modified/marginal
302G	/local/slurmtmp.700617/DATA/Modified/spectogram
302G	/local/slurmtmp.700617/DATA/Modified
307G	/local/slurmtmp.700617/DATA
copy done time
Wed May  2 17:52:08 CEST 2018
2018-05-02 17:52:25.756212: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-02 17:52:26.081334: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-02 17:52:26.253269: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-02 17:52:26.470991: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-02 17:52:26.634762: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-02 17:52:26.635510: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-02 17:52:26.635642: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-02 17:52:26.635675: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-02 17:52:26.635697: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-02 17:52:26.635717: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-02 17:52:26.635737: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-02 17:52:26.635770: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-02 17:52:26.635819: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-02 17:52:26.635846: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-02 17:52:26.635869: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-02 17:53:46.171978: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-02 17:53:46.172103: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-02 17:53:46.172127: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-02 17:53:46.172145: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 2884087859386810978
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 9014305298096974509
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 10750555375153843105
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 579284877748487899
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 9732110939672666677
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.700617/DATA/Modified/spectogram/spec_01.mat
(1, 185)
(1, 185)
(185, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/spec_01_t.mat
(1, 90)
(1, 90)
(90, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 10)                1930      
_________________________________________________________________
activation_1 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 33        
=================================================================
Total params: 11,079
Trainable params: 11,079
Non-trainable params: 0
_________________________________________________________________
sub 1 with spec gave avg accuracy 0.6046783626079559/0.3133333355022801 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/wig_01.mat
(1, 185)
(1, 185)
(185, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/wig_01_t.mat
(1, 90)
(1, 90)
(90, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 10)                1930      
_________________________________________________________________
activation_2 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 33        
=================================================================
Total params: 11,079
Trainable params: 11,079
Non-trainable params: 0
_________________________________________________________________
sub 1 with wig gave avg accuracy 0.6271929860115051/0.31333333442608513 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/amb_01.mat
(1, 185)
(1, 185)
(185, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/amb_01_t.mat
(1, 90)
(1, 90)
(90, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 10)                3850      
_________________________________________________________________
activation_3 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 33        
=================================================================
Total params: 12,999
Trainable params: 12,999
Non-trainable params: 0
_________________________________________________________________
sub 1 with amb gave avg accuracy 0.649122816324234/0.2822222236957815 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/cwt_01.mat
(1, 185)
(1, 185)
(185, 192, 47, 31)
(192, 47, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/cwt_01_t.mat
(1, 90)
(1, 90)
(90, 192, 47, 31)
(192, 47, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 192, 47, 31)       0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 192, 47, 4)        3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 192, 47, 4)        0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 48, 47, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 48, 47, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 48, 47, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 48, 47, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 12, 47, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 12, 47, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 12, 47, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 12, 47, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 3, 47, 16)         0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 3, 47, 16)         0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 2256)              0         
_________________________________________________________________
dense_7 (Dense)              (None, 10)                22570     
_________________________________________________________________
activation_4 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 33        
=================================================================
Total params: 31,719
Trainable params: 31,719
Non-trainable params: 0
_________________________________________________________________
sub 1 with cwt gave avg accuracy 0.5529239803552628/0.38555555876758363 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/slep_01.mat
(1, 185)
(1, 185)
(185, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/slep_01_t.mat
(1, 90)
(1, 90)
(90, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_5 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_13 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_13 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_13 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_13 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_14 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_14 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_14 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_14 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_15 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_15 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_15 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_15 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_5 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_9 (Dense)              (None, 10)                1930      
_________________________________________________________________
activation_5 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_10 (Dense)             (None, 3)                 33        
=================================================================
Total params: 11,079
Trainable params: 11,079
Non-trainable params: 0
_________________________________________________________________
sub 1 with slep gave avg accuracy 0.5581871449947358/0.3122222241924869 over 10 splits
2018-05-02 21:36:02.768067: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-02 21:36:03.003453: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-02 21:36:03.130679: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-02 21:36:03.271903: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-02 21:36:03.404504: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-02 21:36:03.405205: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-02 21:36:03.405323: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-02 21:36:03.405352: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-02 21:36:03.405372: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-02 21:36:03.405390: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-02 21:36:03.405407: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-02 21:36:03.405436: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-02 21:36:03.405460: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-02 21:36:03.405481: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-02 21:36:03.405501: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-02 21:36:47.057228: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-02 21:36:47.057363: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-02 21:36:47.057404: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-02 21:36:47.057425: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 15868467826944880817
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 3871652607633987645
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 12909800512150361319
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 9285465995391308240
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 6459897034778912966
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.700617/DATA/Modified/spectogram/spec_02.mat
(1, 187)
(1, 187)
(187, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/spec_02_t.mat
(1, 74)
(1, 74)
(74, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 10)                1930      
_________________________________________________________________
activation_1 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 33        
=================================================================
Total params: 11,079
Trainable params: 11,079
Non-trainable params: 0
_________________________________________________________________
sub 2 with spec gave avg accuracy 0.5236842185258865/0.3486486494138433 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/wig_02.mat
(1, 187)
(1, 187)
(187, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/wig_02_t.mat
(1, 74)
(1, 74)
(74, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 10)                1930      
_________________________________________________________________
activation_2 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 33        
=================================================================
Total params: 11,079
Trainable params: 11,079
Non-trainable params: 0
_________________________________________________________________
sub 2 with wig gave avg accuracy 0.5190058559179306/0.3783783803719122 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/amb_02.mat
(1, 187)
(1, 187)
(187, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/amb_02_t.mat
(1, 74)
(1, 74)
(74, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 10)                3850      
_________________________________________________________________
activation_3 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 33        
=================================================================
Total params: 12,999
Trainable params: 12,999
Non-trainable params: 0
_________________________________________________________________
sub 2 with amb gave avg accuracy 0.5558479577302933/0.3581081102023253 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/cwt_02.mat
(1, 187)
(1, 187)
(187, 192, 47, 31)
(192, 47, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/cwt_02_t.mat
(1, 74)
(1, 74)
(74, 192, 47, 31)
(192, 47, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 192, 47, 31)       0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 192, 47, 4)        3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 192, 47, 4)        0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 48, 47, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 48, 47, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 48, 47, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 48, 47, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 12, 47, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 12, 47, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 12, 47, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 12, 47, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 3, 47, 16)         0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 3, 47, 16)         0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 2256)              0         
_________________________________________________________________
dense_7 (Dense)              (None, 10)                22570     
_________________________________________________________________
activation_4 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 33        
=================================================================
Total params: 31,719
Trainable params: 31,719
Non-trainable params: 0
_________________________________________________________________
sub 2 with cwt gave avg accuracy 0.45029241144657134/0.35810810951767735 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/slep_02.mat
(1, 187)
(1, 187)
(187, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/slep_02_t.mat
(1, 74)
(1, 74)
(74, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_5 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_13 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_13 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_13 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_13 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_14 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_14 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_14 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_14 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_15 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_15 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_15 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_15 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_5 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_9 (Dense)              (None, 10)                1930      
_________________________________________________________________
activation_5 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_10 (Dense)             (None, 3)                 33        
=================================================================
Total params: 11,079
Trainable params: 11,079
Non-trainable params: 0
_________________________________________________________________
sub 2 with slep gave avg accuracy 0.5081871390342713/0.36351351460089554 over 10 splits
2018-05-03 01:21:25.656071: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-03 01:21:25.913738: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-03 01:21:26.041786: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-03 01:21:26.202859: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-03 01:21:26.339444: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-03 01:21:26.340142: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-03 01:21:26.340261: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-03 01:21:26.340290: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-03 01:21:26.340309: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-03 01:21:26.340327: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-03 01:21:26.340344: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-03 01:21:26.340373: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-03 01:21:26.340396: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-03 01:21:26.340416: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-03 01:21:26.340436: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-03 01:22:32.245126: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-03 01:22:32.245265: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-03 01:22:32.245289: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-03 01:22:32.245307: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 6845984387489126096
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 15994384413260198862
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 3378329741703941627
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 16987471627626936228
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 13182901626991031715
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.700617/DATA/Modified/spectogram/spec_03.mat
(1, 186)
(1, 186)
(186, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/spec_03_t.mat
(1, 130)
(1, 130)
(130, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 10)                1930      
_________________________________________________________________
activation_1 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 33        
=================================================================
Total params: 11,079
Trainable params: 11,079
Non-trainable params: 0
_________________________________________________________________
sub 3 with spec gave avg accuracy 0.7108187139034271/0.3261538461538462 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/wig_03.mat
(1, 186)
(1, 186)
(186, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/wig_03_t.mat
(1, 130)
(1, 130)
(130, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 10)                1930      
_________________________________________________________________
activation_2 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 33        
=================================================================
Total params: 11,079
Trainable params: 11,079
Non-trainable params: 0
_________________________________________________________________
sub 3 with wig gave avg accuracy 0.7090643227100373/0.2892307692307692 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/amb_03.mat
(1, 186)
(1, 186)
(186, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/amb_03_t.mat
(1, 130)
(1, 130)
(130, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 10)                3850      
_________________________________________________________________
activation_3 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 33        
=================================================================
Total params: 12,999
Trainable params: 12,999
Non-trainable params: 0
_________________________________________________________________
sub 3 with amb gave avg accuracy 0.7192982494831085/0.3330769230769231 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/cwt_03.mat
(1, 186)
(1, 186)
(186, 192, 47, 31)
(192, 47, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/cwt_03_t.mat
(1, 130)
(1, 130)
(130, 192, 47, 31)
(192, 47, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 192, 47, 31)       0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 192, 47, 4)        3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 192, 47, 4)        0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 48, 47, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 48, 47, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 48, 47, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 48, 47, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 12, 47, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 12, 47, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 12, 47, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 12, 47, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 3, 47, 16)         0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 3, 47, 16)         0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 2256)              0         
_________________________________________________________________
dense_7 (Dense)              (None, 10)                22570     
_________________________________________________________________
activation_4 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 33        
=================================================================
Total params: 31,719
Trainable params: 31,719
Non-trainable params: 0
_________________________________________________________________
sub 3 with cwt gave avg accuracy 0.7473684251308441/0.3007692307692308 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/slep_03.mat
(1, 186)
(1, 186)
(186, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/slep_03_t.mat
(1, 130)
(1, 130)
(130, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_5 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_13 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_13 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_13 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_13 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_14 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_14 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_14 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_14 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_15 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_15 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_15 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_15 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_5 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_9 (Dense)              (None, 10)                1930      
_________________________________________________________________
activation_5 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_10 (Dense)             (None, 3)                 33        
=================================================================
Total params: 11,079
Trainable params: 11,079
Non-trainable params: 0
_________________________________________________________________
sub 3 with slep gave avg accuracy 0.6002923905849457/0.3123076923076923 over 10 splits
2018-05-03 05:09:49.661631: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-03 05:09:49.910865: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-03 05:09:50.079317: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-03 05:09:50.244120: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-03 05:09:50.402286: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-03 05:09:50.402980: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-03 05:09:50.403121: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-03 05:09:50.403152: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-03 05:09:50.403172: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-03 05:09:50.403190: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-03 05:09:50.403208: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-03 05:09:50.403237: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-03 05:09:50.403260: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-03 05:09:50.403282: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-03 05:09:50.403302: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-03 05:10:33.672401: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-03 05:10:33.672529: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-03 05:10:33.672553: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-03 05:10:33.672572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 10340264284754996408
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 15571460134605613723
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 8027072440907771855
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 1489188994302740382
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 1948100515390983128
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.700617/DATA/Modified/spectogram/spec_04.mat
(1, 185)
(1, 185)
(185, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/spec_04_t.mat
(1, 96)
(1, 96)
(96, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 10)                1930      
_________________________________________________________________
activation_1 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 33        
=================================================================
Total params: 11,079
Trainable params: 11,079
Non-trainable params: 0
_________________________________________________________________
sub 4 with spec gave avg accuracy 0.6146198868751526/0.3375 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/wig_04.mat
(1, 185)
(1, 185)
(185, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/wig_04_t.mat
(1, 96)
(1, 96)
(96, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 10)                1930      
_________________________________________________________________
activation_2 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 33        
=================================================================
Total params: 11,079
Trainable params: 11,079
Non-trainable params: 0
_________________________________________________________________
sub 4 with wig gave avg accuracy 0.6052631676197052/0.375 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/amb_04.mat
(1, 185)
(1, 185)
(185, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/amb_04_t.mat
(1, 96)
(1, 96)
(96, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 10)                3850      
_________________________________________________________________
activation_3 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 33        
=================================================================
Total params: 12,999
Trainable params: 12,999
Non-trainable params: 0
_________________________________________________________________
sub 4 with amb gave avg accuracy 0.6546783596277237/0.346875 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/cwt_04.mat
(1, 185)
(1, 185)
(185, 192, 47, 31)
(192, 47, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/cwt_04_t.mat
(1, 96)
(1, 96)
(96, 192, 47, 31)
(192, 47, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 192, 47, 31)       0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 192, 47, 4)        3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 192, 47, 4)        0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 48, 47, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 48, 47, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 48, 47, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 48, 47, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 12, 47, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 12, 47, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 12, 47, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 12, 47, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 3, 47, 16)         0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 3, 47, 16)         0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 2256)              0         
_________________________________________________________________
dense_7 (Dense)              (None, 10)                22570     
_________________________________________________________________
activation_4 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 33        
=================================================================
Total params: 31,719
Trainable params: 31,719
Non-trainable params: 0
_________________________________________________________________
sub 4 with cwt gave avg accuracy 0.5073099464178086/0.37083333333333335 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/slep_04.mat
(1, 185)
(1, 185)
(185, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/slep_04_t.mat
(1, 96)
(1, 96)
(96, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_5 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_13 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_13 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_13 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_13 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_14 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_14 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_14 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_14 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_15 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_15 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_15 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_15 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_5 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_9 (Dense)              (None, 10)                1930      
_________________________________________________________________
activation_5 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_10 (Dense)             (None, 3)                 33        
=================================================================
Total params: 11,079
Trainable params: 11,079
Non-trainable params: 0
_________________________________________________________________
sub 4 with slep gave avg accuracy 0.605263152718544/0.34479166666666666 over 10 splits
2018-05-03 08:57:49.835056: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-03 08:57:50.126017: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-03 08:57:50.258557: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-03 08:57:50.420186: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-03 08:57:50.568719: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-03 08:57:50.569415: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-03 08:57:50.569534: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-03 08:57:50.569563: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-03 08:57:50.569583: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-03 08:57:50.569601: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-03 08:57:50.569618: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-03 08:57:50.569647: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-03 08:57:50.569670: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-03 08:57:50.569691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-03 08:57:50.569710: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-03 08:58:29.639697: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-03 08:58:29.639815: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-03 08:58:29.639838: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-03 08:58:29.639855: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 14851369059634812631
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 14960265369447757929
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 1766789364814622295
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 16621813809390128772
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 1906343968833789383
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.700617/DATA/Modified/spectogram/spec_05.mat
(1, 187)
(1, 187)
(187, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/spec_05_t.mat
(1, 109)
(1, 109)
(109, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 10)                1930      
_________________________________________________________________
activation_1 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 33        
=================================================================
Total params: 11,079
Trainable params: 11,079
Non-trainable params: 0
_________________________________________________________________
sub 5 with spec gave avg accuracy 0.6307017564773559/0.3403669730238958 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/wig_05.mat
(1, 187)
(1, 187)
(187, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/wig_05_t.mat
(1, 109)
(1, 109)
(109, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 10)                1930      
_________________________________________________________________
activation_2 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 33        
=================================================================
Total params: 11,079
Trainable params: 11,079
Non-trainable params: 0
_________________________________________________________________
sub 5 with wig gave avg accuracy 0.6906432777643203/0.29357798171973015 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/amb_05.mat
(1, 187)
(1, 187)
(187, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/amb_05_t.mat
(1, 109)
(1, 109)
(109, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 10)                3850      
_________________________________________________________________
activation_3 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 33        
=================================================================
Total params: 12,999
Trainable params: 12,999
Non-trainable params: 0
_________________________________________________________________
sub 5 with amb gave avg accuracy 0.5780701816082001/0.3256880739823394 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/cwt_05.mat
(1, 187)
(1, 187)
(187, 192, 47, 31)
(192, 47, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/cwt_05_t.mat
(1, 109)
(1, 109)
(109, 192, 47, 31)
(192, 47, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 192, 47, 31)       0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 192, 47, 4)        3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 192, 47, 4)        0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 48, 47, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 48, 47, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 48, 47, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 48, 47, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 12, 47, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 12, 47, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 12, 47, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 12, 47, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 3, 47, 16)         0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 3, 47, 16)         0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 2256)              0         
_________________________________________________________________
dense_7 (Dense)              (None, 10)                22570     
_________________________________________________________________
activation_4 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 33        
=================================================================
Total params: 31,719
Trainable params: 31,719
Non-trainable params: 0
_________________________________________________________________
sub 5 with cwt gave avg accuracy 0.6318713426589966/0.31284403772255703 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/slep_05.mat
(1, 187)
(1, 187)
(187, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/slep_05_t.mat
(1, 109)
(1, 109)
(109, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_5 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_13 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_13 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_13 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_13 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_14 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_14 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_14 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_14 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_15 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_15 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_15 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_15 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_5 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_9 (Dense)              (None, 10)                1930      
_________________________________________________________________
activation_5 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_10 (Dense)             (None, 3)                 33        
=================================================================
Total params: 11,079
Trainable params: 11,079
Non-trainable params: 0
_________________________________________________________________
sub 5 with slep gave avg accuracy 0.6090643316507339/0.3366972481302165 over 10 splits
2018-05-03 12:47:52.472202: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-03 12:47:52.756431: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-03 12:47:52.891599: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-03 12:47:53.054028: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-03 12:47:53.199518: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-03 12:47:53.200387: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-03 12:47:53.200506: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-03 12:47:53.200535: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-03 12:47:53.200554: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-03 12:47:53.200572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-03 12:47:53.200590: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-03 12:47:53.200618: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-03 12:47:53.200641: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-03 12:47:53.200661: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-03 12:47:53.200680: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-03 12:48:34.292834: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-03 12:48:34.292969: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-03 12:48:34.292995: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-03 12:48:34.293014: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 5352779498659983621
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 18027334028061110910
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 11043200201361764839
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 6948644808330895047
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 6599026161439757947
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.700617/DATA/Modified/spectogram/spec_06.mat
(1, 184)
(1, 184)
(184, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/spec_06_t.mat
(1, 121)
(1, 121)
(121, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 10)                1930      
_________________________________________________________________
activation_1 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 33        
=================================================================
Total params: 11,079
Trainable params: 11,079
Non-trainable params: 0
_________________________________________________________________
sub 6 with spec gave avg accuracy 0.6192982465028762/0.3107438013511748 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/wig_06.mat
(1, 184)
(1, 184)
(184, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/wig_06_t.mat
(1, 121)
(1, 121)
(121, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 10)                1930      
_________________________________________________________________
activation_2 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 33        
=================================================================
Total params: 11,079
Trainable params: 11,079
Non-trainable params: 0
_________________________________________________________________
sub 6 with wig gave avg accuracy 0.591520470380783/0.3305785112883434 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/amb_06.mat
(1, 184)
(1, 184)
(184, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/amb_06_t.mat
(1, 121)
(1, 121)
(121, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 10)                3850      
_________________________________________________________________
activation_3 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 33        
=================================================================
Total params: 12,999
Trainable params: 12,999
Non-trainable params: 0
_________________________________________________________________
sub 6 with amb gave avg accuracy 0.6304093599319458/0.2933884288900155 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/cwt_06.mat
(1, 184)
(1, 184)
(184, 192, 47, 31)
(192, 47, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/cwt_06_t.mat
(1, 121)
(1, 121)
(121, 192, 47, 31)
(192, 47, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 192, 47, 31)       0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 192, 47, 4)        3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 192, 47, 4)        0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 48, 47, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 48, 47, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 48, 47, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 48, 47, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 12, 47, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 12, 47, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 12, 47, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 12, 47, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 3, 47, 16)         0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 3, 47, 16)         0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 2256)              0         
_________________________________________________________________
dense_7 (Dense)              (None, 10)                22570     
_________________________________________________________________
activation_4 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 33        
=================================================================
Total params: 31,719
Trainable params: 31,719
Non-trainable params: 0
_________________________________________________________________
sub 6 with cwt gave avg accuracy 0.5479532226920127/0.34876033118810534 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/slep_06.mat
(1, 184)
(1, 184)
(184, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/slep_06_t.mat
(1, 121)
(1, 121)
(121, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_5 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_13 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_13 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_13 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_13 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_14 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_14 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_14 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_14 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_15 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_15 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_15 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_15 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_5 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_9 (Dense)              (None, 10)                1930      
_________________________________________________________________
activation_5 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_10 (Dense)             (None, 3)                 33        
=================================================================
Total params: 11,079
Trainable params: 11,079
Non-trainable params: 0
_________________________________________________________________
sub 6 with slep gave avg accuracy 0.5935672461986542/0.3363636368931818 over 10 splits
2018-05-03 16:27:30.232412: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-03 16:27:30.495885: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-03 16:27:30.628286: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-03 16:27:30.774613: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-03 16:27:30.920588: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-03 16:27:30.921317: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-03 16:27:30.921435: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-03 16:27:30.921465: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-03 16:27:30.921484: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-03 16:27:30.921502: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-03 16:27:30.921519: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-03 16:27:30.921549: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-03 16:27:30.921571: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-03 16:27:30.921592: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-03 16:27:30.921611: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-03 16:28:23.040485: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-03 16:28:23.040610: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-03 16:28:23.040634: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-03 16:28:23.040652: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 2803118337411180415
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 6695664206922223444
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 8900216491722161609
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 6659526090759172289
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 3885769191530237302
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.700617/DATA/Modified/spectogram/spec_07.mat
(1, 188)
(1, 188)
(188, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/spec_07_t.mat
(1, 87)
(1, 87)
(87, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 10)                1930      
_________________________________________________________________
activation_1 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 33        
=================================================================
Total params: 11,079
Trainable params: 11,079
Non-trainable params: 0
_________________________________________________________________
sub 7 with spec gave avg accuracy 0.666374272108078/0.33908045927340963 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/wig_07.mat
(1, 188)
(1, 188)
(188, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/wig_07_t.mat
(1, 87)
(1, 87)
(87, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 10)                1930      
_________________________________________________________________
activation_2 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 33        
=================================================================
Total params: 11,079
Trainable params: 11,079
Non-trainable params: 0
_________________________________________________________________
sub 7 with wig gave avg accuracy 0.6637426972389221/0.3402298851131365 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/amb_07.mat
(1, 188)
(1, 188)
(188, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/amb_07_t.mat
(1, 87)
(1, 87)
(87, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 10)                3850      
_________________________________________________________________
activation_3 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 33        
=================================================================
Total params: 12,999
Trainable params: 12,999
Non-trainable params: 0
_________________________________________________________________
sub 7 with amb gave avg accuracy 0.6815789461135864/0.30689655207525723 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/cwt_07.mat
(1, 188)
(1, 188)
(188, 192, 47, 31)
(192, 47, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/cwt_07_t.mat
(1, 87)
(1, 87)
(87, 192, 47, 31)
(192, 47, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 192, 47, 31)       0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 192, 47, 4)        3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 192, 47, 4)        0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 48, 47, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 48, 47, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 48, 47, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 48, 47, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 12, 47, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 12, 47, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 12, 47, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 12, 47, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 3, 47, 16)         0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 3, 47, 16)         0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 2256)              0         
_________________________________________________________________
dense_7 (Dense)              (None, 10)                22570     
_________________________________________________________________
activation_4 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 33        
=================================================================
Total params: 31,719
Trainable params: 31,719
Non-trainable params: 0
_________________________________________________________________
sub 7 with cwt gave avg accuracy 0.6391812860965729/0.33448275843228414 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/slep_07.mat
(1, 188)
(1, 188)
(188, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/slep_07_t.mat
(1, 87)
(1, 87)
(87, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_5 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_13 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_13 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_13 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_13 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_14 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_14 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_14 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_14 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_15 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_15 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_15 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_15 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_5 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_9 (Dense)              (None, 10)                1930      
_________________________________________________________________
activation_5 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_10 (Dense)             (None, 3)                 33        
=================================================================
Total params: 11,079
Trainable params: 11,079
Non-trainable params: 0
_________________________________________________________________
sub 7 with slep gave avg accuracy 0.6140350937843323/0.3609195393563688 over 10 splits
2018-05-03 20:10:45.367692: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-03 20:10:45.604421: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-03 20:10:45.730315: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-03 20:10:45.878076: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-03 20:10:46.012855: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-03 20:10:46.013554: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-03 20:10:46.013672: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-03 20:10:46.013701: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-03 20:10:46.013720: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-03 20:10:46.013738: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-03 20:10:46.013756: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-03 20:10:46.013785: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-03 20:10:46.013830: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-03 20:10:46.013854: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-03 20:10:46.013873: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-03 20:11:34.756849: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-03 20:11:34.756984: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-03 20:11:34.757009: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-03 20:11:34.757026: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 15185772483230086458
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 11541407864047133538
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 9080172672358882764
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 11950325317504177170
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 6366038054957881513
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.700617/DATA/Modified/spectogram/spec_08.mat
(1, 190)
(1, 190)
(190, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/spec_08_t.mat
(1, 113)
(1, 113)
(113, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 10)                1930      
_________________________________________________________________
activation_1 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 33        
=================================================================
Total params: 11,079
Trainable params: 11,079
Non-trainable params: 0
_________________________________________________________________
sub 8 with spec gave avg accuracy 0.6105263113975525/0.3469026552562692 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/wig_08.mat
(1, 190)
(1, 190)
(190, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/wig_08_t.mat
(1, 113)
(1, 113)
(113, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 10)                1930      
_________________________________________________________________
activation_2 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 33        
=================================================================
Total params: 11,079
Trainable params: 11,079
Non-trainable params: 0
_________________________________________________________________
sub 8 with wig gave avg accuracy 0.6210526376962662/0.32477876147073986 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/amb_08.mat
(1, 190)
(1, 190)
(190, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/amb_08_t.mat
(1, 113)
(1, 113)
(113, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 10)                3850      
_________________________________________________________________
activation_3 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 33        
=================================================================
Total params: 12,999
Trainable params: 12,999
Non-trainable params: 0
_________________________________________________________________
sub 8 with amb gave avg accuracy 0.6263157933950424/0.3415929209078307 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/cwt_08.mat
(1, 190)
(1, 190)
(190, 192, 47, 31)
(192, 47, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/cwt_08_t.mat
(1, 113)
(1, 113)
(113, 192, 47, 31)
(192, 47, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 192, 47, 31)       0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 192, 47, 4)        3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 192, 47, 4)        0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 48, 47, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 48, 47, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 48, 47, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 48, 47, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 12, 47, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 12, 47, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 12, 47, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 12, 47, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 3, 47, 16)         0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 3, 47, 16)         0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 2256)              0         
_________________________________________________________________
dense_7 (Dense)              (None, 10)                22570     
_________________________________________________________________
activation_4 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 33        
=================================================================
Total params: 31,719
Trainable params: 31,719
Non-trainable params: 0
_________________________________________________________________
sub 8 with cwt gave avg accuracy 0.6526315867900848/0.30000000135824745 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/slep_08.mat
(1, 190)
(1, 190)
(190, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/slep_08_t.mat
(1, 113)
(1, 113)
(113, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_5 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_13 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_13 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_13 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_13 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_14 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_14 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_14 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_14 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_15 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_15 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_15 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_15 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_5 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_9 (Dense)              (None, 10)                1930      
_________________________________________________________________
activation_5 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_10 (Dense)             (None, 3)                 33        
=================================================================
Total params: 11,079
Trainable params: 11,079
Non-trainable params: 0
_________________________________________________________________
sub 8 with slep gave avg accuracy 0.5999999970197678/0.3336283190225341 over 10 splits
2018-05-04 00:02:24.483801: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-04 00:02:24.715491: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-04 00:02:24.863666: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-04 00:02:25.013105: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-04 00:02:25.148999: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-04 00:02:25.149715: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-04 00:02:25.149832: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-04 00:02:25.149861: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-04 00:02:25.149881: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-04 00:02:25.149899: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-04 00:02:25.149917: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-04 00:02:25.149945: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-04 00:02:25.149989: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-04 00:02:25.150014: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-04 00:02:25.150036: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-04 00:03:06.578533: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-04 00:03:06.578658: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-04 00:03:06.578682: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-04 00:03:06.578715: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 13466723863419831701
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 9678705018128270510
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 11692501718793192516
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 7093918503889250166
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 7767584157022618264
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.700617/DATA/Modified/spectogram/spec_09.mat
(1, 186)
(1, 186)
(186, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/spec_09_t.mat
(1, 83)
(1, 83)
(83, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 10)                1930      
_________________________________________________________________
activation_1 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 33        
=================================================================
Total params: 11,079
Trainable params: 11,079
Non-trainable params: 0
_________________________________________________________________
sub 9 with spec gave avg accuracy 0.49269005954265593/0.35180723017238713 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/wig_09.mat
(1, 186)
(1, 186)
(186, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/wig_09_t.mat
(1, 83)
(1, 83)
(83, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 10)                1930      
_________________________________________________________________
activation_2 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 33        
=================================================================
Total params: 11,079
Trainable params: 11,079
Non-trainable params: 0
_________________________________________________________________
sub 9 with wig gave avg accuracy 0.5792397797107697/0.31927710863122016 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/amb_09.mat
(1, 186)
(1, 186)
(186, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/amb_09_t.mat
(1, 83)
(1, 83)
(83, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 10)                3850      
_________________________________________________________________
activation_3 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 33        
=================================================================
Total params: 12,999
Trainable params: 12,999
Non-trainable params: 0
_________________________________________________________________
sub 9 with amb gave avg accuracy 0.651169604063034/0.31807228919253283 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/cwt_09.mat
(1, 186)
(1, 186)
(186, 192, 47, 31)
(192, 47, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/cwt_09_t.mat
(1, 83)
(1, 83)
(83, 192, 47, 31)
(192, 47, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 192, 47, 31)       0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 192, 47, 4)        3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 192, 47, 4)        0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 48, 47, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 48, 47, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 48, 47, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 48, 47, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 12, 47, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 12, 47, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 12, 47, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 12, 47, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 3, 47, 16)         0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 3, 47, 16)         0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 2256)              0         
_________________________________________________________________
dense_7 (Dense)              (None, 10)                22570     
_________________________________________________________________
activation_4 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 33        
=================================================================
Total params: 31,719
Trainable params: 31,719
Non-trainable params: 0
_________________________________________________________________
sub 9 with cwt gave avg accuracy 0.6453216403722764/0.34096385524215467 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/slep_09.mat
(1, 186)
(1, 186)
(186, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/slep_09_t.mat
(1, 83)
(1, 83)
(83, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_5 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_13 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_13 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_13 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_13 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_14 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_14 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_14 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_14 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_15 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_15 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_15 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_15 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_5 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_9 (Dense)              (None, 10)                1930      
_________________________________________________________________
activation_5 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_10 (Dense)             (None, 3)                 33        
=================================================================
Total params: 11,079
Trainable params: 11,079
Non-trainable params: 0
_________________________________________________________________
sub 9 with slep gave avg accuracy 0.5280701816082001/0.3433734946581254 over 10 splits
2018-05-04 03:45:21.436442: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-04 03:45:21.669153: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-04 03:45:21.792538: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-04 03:45:21.955481: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-04 03:45:22.091947: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-04 03:45:22.092648: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-04 03:45:22.092770: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-04 03:45:22.092799: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-04 03:45:22.092820: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-04 03:45:22.092839: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-04 03:45:22.092857: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-04 03:45:22.092886: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-04 03:45:22.092910: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-04 03:45:22.092931: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-04 03:45:22.092951: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-04 03:46:04.979224: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-04 03:46:04.979361: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-04 03:46:04.979386: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-04 03:46:04.979404: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 7978720784712976757
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 5448399495242017520
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 2431476990584824303
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 162441922941360287
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 13163274912559533377
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.700617/DATA/Modified/spectogram/spec_11.mat
(1, 182)
(1, 182)
(182, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/spec_11_t.mat
(1, 98)
(1, 98)
(98, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 10)                1930      
_________________________________________________________________
activation_1 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 33        
=================================================================
Total params: 11,079
Trainable params: 11,079
Non-trainable params: 0
_________________________________________________________________
sub 11 with spec gave avg accuracy 0.5602339237928391/0.2928571428571428 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/wig_11.mat
(1, 182)
(1, 182)
(182, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/wig_11_t.mat
(1, 98)
(1, 98)
(98, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 10)                1930      
_________________________________________________________________
activation_2 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 33        
=================================================================
Total params: 11,079
Trainable params: 11,079
Non-trainable params: 0
_________________________________________________________________
sub 11 with wig gave avg accuracy 0.4827485427260399/0.3081632653061225 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/amb_11.mat
(1, 182)
(1, 182)
(182, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/amb_11_t.mat
(1, 98)
(1, 98)
(98, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 10)                3850      
_________________________________________________________________
activation_3 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 33        
=================================================================
Total params: 12,999
Trainable params: 12,999
Non-trainable params: 0
_________________________________________________________________
sub 11 with amb gave avg accuracy 0.5105263233184815/0.3142857142857142 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/cwt_11.mat
(1, 182)
(1, 182)
(182, 192, 47, 31)
(192, 47, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/cwt_11_t.mat
(1, 98)
(1, 98)
(98, 192, 47, 31)
(192, 47, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 192, 47, 31)       0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 192, 47, 4)        3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 192, 47, 4)        0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 48, 47, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 48, 47, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 48, 47, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 48, 47, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 12, 47, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 12, 47, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 12, 47, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 12, 47, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 3, 47, 16)         0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 3, 47, 16)         0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 2256)              0         
_________________________________________________________________
dense_7 (Dense)              (None, 10)                22570     
_________________________________________________________________
activation_4 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 33        
=================================================================
Total params: 31,719
Trainable params: 31,719
Non-trainable params: 0
_________________________________________________________________
sub 11 with cwt gave avg accuracy 0.4616959124803543/0.3377551020408163 over 10 splits
/local/slurmtmp.700617/DATA/Modified/spectogram/slep_11.mat
(1, 182)
(1, 182)
(182, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.700617/DATA/Modified/spectogram/slep_11_t.mat
(1, 98)
(1, 98)
(98, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_5 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_13 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_13 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_13 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_13 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_14 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_14 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_14 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_14 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_15 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_15 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_15 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_15 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_5 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_9 (Dense)              (None, 10)                1930      
_________________________________________________________________
activation_5 (Activation)    (None, 10)                0         
_________________________________________________________________
dense_10 (Dense)             (None, 3)                 33        
=================================================================
Total params: 11,079
Trainable params: 11,079
Non-trainable params: 0
_________________________________________________________________
sub 11 with slep gave avg accuracy 0.549415209889412/0.3030612244897959 over 10 splits
2018-05-04 07:31:59.477615: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-04 07:31:59.954565: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-04 07:32:00.103627: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-04 07:32:00.252837: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-04 07:32:00.414283: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-04 07:32:00.414981: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-04 07:32:00.415100: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-04 07:32:00.415152: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-04 07:32:00.415175: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-04 07:32:00.415194: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-04 07:32:00.415212: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-04 07:32:00.415242: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-04 07:32:00.415265: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-04 07:32:00.415286: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-04 07:32:00.415306: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-04 07:32:55.070362: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-04 07:32:55.070484: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-04 07:32:55.070509: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-04 07:32:55.070528: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
