data dir
/lunarc/nobackup/users/albheim/EEG-klassificering
script
#!/bin/sh
#SBATCH -t 99:00:00
#SBATCH -J c2d_fix
#SBATCH -A lu2018-2-3
#// SBATCH -o stdout_%j.out
#// SBATCH -e stderr_%j.err

# shold be lu or gpu
#SBATCH -p gpu

# how many gpus, 4 per node, using many seems to crash more often so stick with 1
#SBATCH --gres=gpu:4

# use 5 cores per GPU
#SBATCH -n 20
#SBATCH --mem-per-cpu=3100

DATA_DIR="$(cat ../data_location.txt)"
echo "data dir"
echo $DATA_DIR

echo "script"
cat $0

PY_FILE="conv2d_spect.py"
echo "py file"
cat $PY_FILE

echo "data file"
cat "data.py"

echo "mat file"
cat "../matlab/save transformed/savetf.m"

echo "nvidia smi"
nvidia-smi

echo "start time"
date

cp -r "${DATA_DIR}/DATA" $SNIC_TMP
ls $SNIC_TMP
du -h "${SNIC_TMP}/DATA"

echo "copy done time"
date

#matlab -nodisplay -nosplash -nodesktop -r "run('../matlab/save transformed/savetf.m');"
idxs=(1 2 3 4 5 6 7 8 9 11 12 13 14 15 16 17 18 19)
for i in ${idxs[@]}; do
    python $PY_FILE $SNIC_TMP $i
done

echo "end time"
date
py file
import sys
from datetime import datetime

import numpy as np
from scipy import io

import tensorflow as tf

from keras.models import Model
from keras.layers import Dense, Dropout, Input, GaussianNoise, BatchNormalization
from keras.layers import Lambda
from keras.layers import Conv2D, MaxPooling2D, AveragePooling2D
from keras.layers import ELU, Activation, Flatten

from keras import backend as K
from keras import regularizers as rg

from tensorflow.python.client import device_lib
print(device_lib.list_local_devices())

import data
import util

funcs = ["spec", "wig", "amb", "slep"]#["spec", "wig", "amb", "cwt", "slep"]
sub = int(sys.argv[2])

splits = 10

for func in funcs:
    xt, yt = data.load_transform([sub], func)
    x, y = data.load_transform([sub], func, test=True)

    m_in = Input(shape=x[0][0].shape)

    m_t = Conv2D(4, (8, 4), padding='same')(m_in) #, kernel_regularizer=rg.l1(0.01)
    #m_t = BatchNormalization()(m_t)
    m_t = ELU()(m_t)
    m_t = AveragePooling2D((4, 4))(m_t)
    m_t = Dropout(0.2)(m_t)

    m_t = Conv2D(8, (8, 4), padding='same')(m_t)
    #m_t = BatchNormalization()(m_t)
    m_t = ELU()(m_t)
    m_t = AveragePooling2D((4, 4))(m_t)
    m_t = Dropout(0.3)(m_t)

    m_t = Conv2D(16, (8, 4), padding='same')(m_t)
    #m_t = BatchNormalization()(m_t)
    m_t = ELU()(m_t)
    m_t = AveragePooling2D((4, 4))(m_t)
    m_t = Dropout(0.3)(m_t)

    m_t = Flatten()(m_t)
    m_t = Dense(15, kernel_regularizer=rg.l1(0.01))(m_t)
    #m_t = BatchNormalization()(m_t)
    m_t = Activation('tanh')(m_t)
    m_out = Dense(3, activation='softmax')(m_t)

    model = Model(inputs=m_in, outputs=m_out)

    m_save = model.get_config()
    model.summary()

    acc = 0
    acc2 = 0
    for tr, val in util.kfold(len(x[0]), splits, shuffle=True):

        model = Model.from_config(m_save)
        model.compile(loss='categorical_crossentropy',
                      optimizer='adam',
                      metrics=['accuracy'])
        # fit with next kfold data
        h = model.fit(x[0][tr], y[0][tr],
                      #validation_data=(x[0][val], y[0][val]),
                      batch_size=16, epochs=50, verbose=0)

        _, a = model.evaluate(x[0][val], y[0][val], verbose=0)
        _, a2 = model.evaluate(xt[0], yt[0], verbose=0)
        acc += a
        acc2 += a2

    acc /= splits
    acc2 /= splits

    print("sub {} with {} gave avg accuracy {}/{} over {} splits".format(sub, func, acc, acc2, splits))
data file
import sys

import numpy as np
from scipy import io
import h5py


def load_single_sub(sub, cut=True, study=True, shuffle=True, visual=True, transpose=False, user="Albin"):
    if user=="Damir":
        snic_tmp = "/Users/damir/Documents/EEG-data"
    else:
        snic_tmp = "C:/Users/Albin Heimerson/Desktop/exjobb/DATA"
    if len(sys.argv) > 1:
        snic_tmp = str(sys.argv[1]) + "/DATA"
    xn = None
    yn = None
    names = ["FA", "LM", "OB"]
    for i in range(3):
        name = "Subj{:02}_CleanData_{}_{}".format(sub,
                                                  'study' if study else 'test',
                                                  names[i])
        if not study:
            name += "_{}".format("visual" if visual else "lexical")

        print("loading: ", name)

        m = io.loadmat('{}/{}/{}.mat'.format(snic_tmp,
                                                  "Visual" if visual else "Verbal",
                                                  name))
        trials = m[name][0][0][2][0]
        for j in range(trials.shape[0]):
            if cut is True:
                trials[j] = trials[j][:, 768:1536]
            elif cut is not False:
                trials[j] = trials[j][:, cut[0]:cut[1]]
            if transpose:
                trials[j] = trials[j].T
        labels = np.zeros((trials.shape[0], 3))
        labels[:, i] = 1
        if xn is None:
            xn = trials
            yn = labels
        else:
            xn = np.concatenate((xn, trials), axis=0)
            yn = np.concatenate((yn, labels), axis=0)

    xn = np.stack(xn, axis=0)
    n = xn.shape[0]
    s = np.arange(n)
    if shuffle:
        np.random.shuffle(s)

    return (xn[s], yn[s])


def load_single(idx=None, cut=True, shuffle=True, visual=True, transpose=False,
                study=True):
    x = []
    y = []

    if idx is None:
        if visual:
            idx = [i if i < 10 else i + 1 for i in range(1, 19)]
        else:
            idx = [1, 2, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22]

    for sub in idx:
        xn, yn = load_single_sub(sub, cut, study, shuffle, visual, transpose)
        x.append(xn)
        y.append(yn)

    return (x, y)


def load_all(cut=True, visual=True, study=True, transpose=False):
    x = None
    y = None

    if visual:
        subs = [i if i < 10 else i + 1 for i in range(1, 19)]
    else:
        subs = [1, 2, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22]

    for sub in subs:  # 19 is max
        xn, yn = load_single_sub(sub, cut, study, False, visual, transpose)
        if x is None:
            x = xn
            y = yn
        else:
            x = np.concatenate((x, xn), axis=0)
            y = np.concatenate((y, yn), axis=0)

    print(x.shape, y.shape)
    x = np.stack(x, axis=0)
    print(x.shape)
    s = np.arange(x.shape[0])
    np.random.shuffle(s)

    return (x[s], y[s])


def load_marg(cut=None, visual=True, shuffle=True):
    snic_tmp = "C:/Users/Albin Heimerson/Desktop/exjobb"
    if len(sys.argv) > 1:
        snic_tmp = str(sys.argv[1])
    x = []
    y = []
    if visual:
        subs = [i if i < 10 else i + 1 for i in range(1, 19)]
    else:
        subs = [1, 2, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22]
    for sub in subs:
        xn = None
        yn = None
        for i in range(3):
            name = "Subj{:02}_{}_marg".format(sub, "Visual" if visual else "Verbal")
            print("loading: ", name)
            m = io.loadmat('{}/DATA/Modified/marginal/{}.mat'.format(snic_tmp, name))

            trials = m['data'][0][0][i][:, 0]
            if cut is not None:
                for j in range(trials.shape[0]):
                    trials[j] = trials[j][:, cut[0]:cut[1]]
            labels = np.zeros((trials.shape[0], 3))
            labels[:, i] = 1
            if xn is None:
                xn = trials
                yn = labels
            else:
                xn = np.concatenate((xn, trials), axis=0)
                yn = np.concatenate((yn, labels), axis=0)

        xn = np.stack(xn, axis=0)
        n = xn.shape[0]
        s = np.arange(n)
        if shuffle:
            np.random.shuffle(s)
        x.append(xn[s])
        y.append(yn[s])

    print(x[0].shape)
    return (x, y)


def cut(data, cut=[768, 1536], tcut = None):
    if tcut is not None:
        cut[0] = int(512 * tcut[0] + 768)
        cut[1] = int(512 * tcut[1] + 768)
    print(cut)
    for sub in range(len(data)):
        data[sub] = data[sub][:, :, cut[0]:cut[1]]


def modify(x, y, n, nmult=0, displacement=0, cut=[768, 1536]):
    mdata = [None for i in range(len(x))]
    my = [None for i in range(len(x))]
    for sub in range(len(mdata)):
        s = x[sub].shape[0]
        my[sub] = np.zeros((s * n, 3))
        for j in range(0, s * n, s):
            my[sub][j:j + s] = y[sub]
        mdata[sub] = np.zeros((s * n, x[sub].shape[1], cut[1] - cut[0]))
        mdata[sub][:s, :, :] = x[sub][:, :, cut[0]:cut[1]]
        for j in range(s, s * n, s):
            for i in range(len(x[sub])):
                if displacement > 0:
                    d = np.random.randint(-displacement, displacement + 1)
                    mdata[sub][j:j + s, :, :] = x[sub][:, :, cut[0] + d:cut[1] + d]

                if nmult != 0:
                    for k in range(mdata[sub][i].shape[0]):
                        mdata[sub][j + i, k] += nmult * np.std(mdata[sub][i, k]) * np.random.ranf(mdata[sub][i, k].shape)

    return mdata, my


def load_transform(idx, trans, test=False):
    snic_tmp = "C:/Users/Albin Heimerson/Desktop/exjobb"
    if len(sys.argv) > 1:
        snic_tmp = str(sys.argv[1])
    x = []
    y = []
    for sub in idx:
        fname = '{}/DATA/Modified/spectogram/{}_{:02}{}.mat'.format(snic_tmp, trans, sub, 
                                                                    '_t' if test else '')
        print(fname)
        with h5py.File(fname) as f:
            t = f['Y']
            print(t.shape)
            yn = np.zeros((t.shape[1], 3))
            for i in range(t.shape[1]):
                yn[i, int(t[0, i]) - 1] = 1

            y.append(yn)

            t = f['Xt']
            print(t.shape)
            xn = [None for i in range(t.shape[1])]
            for i in range(t.shape[1]):
                xn[i] = np.array(f[t[0, i]])

            xn = np.stack(xn, 0)

            if len(xn.shape) < 4:
                xn = xn[:, :, :, np.newaxis]
            else:
                xn = np.transpose(xn, (0, 2, 3, 1))

            print(xn.shape)
            print(xn[0].shape)
            x.append(xn)

    return (x, y)


def load_spect_downsample(visual=True, shuffle=True, ds=8):
    snic_tmp = "C:/Users/Albin Heimerson/Desktop/exjobb"
    if len(sys.argv) > 1:
        snic_tmp = str(sys.argv[1])
    x = []
    y = []
    if visual:
        subs = [i if i < 10 else i + 1 for i in range(2, 19)] # change to 1
    else:
        subs = [1, 2, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22]
    for sub in subs:
        xn = None
        yn = None
        for i in range(3):
            name = "Subj{:02}_{}_spec{}".format(sub, "Visual" if visual else "Verbal", ds)
            print("loading: ", name)
            m = io.loadmat('{}/DATA/Modified/spect_downsample/{}.mat'.format(snic_tmp, name))

            trials = m['data'][0][0][i][:, 0]
            labels = np.zeros((trials.shape[0], 3))
            labels[:, i] = 1
            if xn is None:
                xn = trials
                yn = labels
            else:
                xn = np.concatenate((xn, trials), axis=0)
                yn = np.concatenate((yn, labels), axis=0)

        xn = np.stack(xn, axis=0)
        n = xn.shape[0]
        s = np.arange(n)
        if shuffle:
            np.random.shuffle(s)
        x.append(xn[s])
        y.append(yn[s])

    print(x[0].shape)
    return (x, y)
mat file
clear; clc; close all
addpath('..')
addpath('../borrowed code')

for idx = [1 2 3 4 5 6 7 8 9 11 12 13 14 15 16 17 18 19]
    sub = sprintf('%02d', idx);
    [X,Y,n] = aux_load('Visual',sub,1);

    param.L = 32; param.Fs = 512; param.NFFT = 512; param.NSTEP = 1; 
    param.method = 'wig'; param.NW = 3;

    %X = aux_chan(X,[5 24 29]);
    X = aux_extr(X, 769:1536);
    X = aux_deci(X,4);
    %X = aux_svd(X, 1);

    ms = ["spec", "slep", "wig", "amb"];%["spec", "wig", "amb", "cwt", "slep"]
    for method = ms
        Xt = aux_transform(X, method, param);

        for i = 1:length(Xt)
            Xt{i} = real(permute(Xt{i}, [2 3 1]));
        end
        method
        size(Xt{1})

        %save(sprintf('C:\\Users\\Albin Heimerson\\Desktop\\exjobb\\DATA\\Modified\\spectogram\\%s_%s.mat', method, sub), 'Xt', 'Y', '-v7.3')

        save(sprintf('/lunarc/nobackup/users/albheim/EEG-klassificering/DATA/Modified/spectogram/%s_%s_t.mat', method, sub), 'Xt', 'Y', '-v7.3')
    end
end

nvidia smi
Tue May 29 22:28:24 2018       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 390.46                 Driver Version: 390.46                    |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 00000000:04:00.0 Off |                    0 |
| N/A   38C    P8    28W / 149W |      0MiB / 11441MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 00000000:05:00.0 Off |                    0 |
| N/A   61C    P8    33W / 149W |      0MiB / 11441MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   2  Tesla K80           On   | 00000000:84:00.0 Off |                    0 |
| N/A   40C    P8    26W / 149W |      0MiB / 11441MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   3  Tesla K80           On   | 00000000:85:00.0 Off |                    0 |
| N/A   63C    P8    32W / 149W |      0MiB / 11441MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
start time
Tue May 29 22:28:24 CEST 2018
DATA
2.4G	/local/slurmtmp.843369/DATA/Visual
2.4G	/local/slurmtmp.843369/DATA/Verbal
388M	/local/slurmtmp.843369/DATA/Modified/marginal
302G	/local/slurmtmp.843369/DATA/Modified/spectogram
302G	/local/slurmtmp.843369/DATA/Modified
307G	/local/slurmtmp.843369/DATA
copy done time
Tue May 29 23:38:07 CEST 2018
2018-05-29 23:39:01.426460: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-29 23:39:04.065057: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-29 23:39:04.220656: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-29 23:39:04.377754: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-29 23:39:04.542582: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-29 23:39:04.543717: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-29 23:39:04.543856: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-29 23:39:04.543888: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-29 23:39:04.543910: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-29 23:39:04.543931: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-29 23:39:04.543981: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-29 23:39:04.544024: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-29 23:39:04.544053: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-29 23:39:04.544076: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-29 23:39:04.544098: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-29 23:41:17.537408: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-29 23:41:17.537526: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-29 23:41:17.537549: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-29 23:41:17.537566: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 10652698408975095965
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 302629559225802624
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 5797542776009047207
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 3069284455545376408
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 9092329026729693515
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.843369/DATA/Modified/spectogram/spec_01.mat
(1, 185)
(1, 185)
(185, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/spec_01_t.mat
(1, 90)
(1, 90)
(90, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 1 with spec gave avg accuracy 0.26666667237877845/0.3340540542715305 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/wig_01.mat
(1, 185)
(1, 185)
(185, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/wig_01_t.mat
(1, 90)
(1, 90)
(90, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 1 with wig gave avg accuracy 0.3333333395421505/0.3010810813227215 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/amb_01.mat
(1, 185)
(1, 185)
(185, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/amb_01_t.mat
(1, 90)
(1, 90)
(90, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 1 with amb gave avg accuracy 0.4111111223697662/0.29621621650215746 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/slep_01.mat
(1, 185)
(1, 185)
(185, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/slep_01_t.mat
(1, 90)
(1, 90)
(90, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 1 with slep gave avg accuracy 0.32222222834825515/0.308108108047698 over 10 splits
2018-05-30 01:33:21.542313: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-30 01:33:21.777968: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 01:33:21.901890: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 01:33:22.047614: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 01:33:22.181652: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 01:33:22.182343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-30 01:33:22.182463: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-30 01:33:22.182492: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-30 01:33:22.182512: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-30 01:33:22.182553: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-30 01:33:22.182575: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-30 01:33:22.182605: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-30 01:33:22.182633: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-30 01:33:22.182654: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-30 01:33:22.182674: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-30 01:34:10.222349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-30 01:34:10.222469: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-30 01:34:10.222493: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-30 01:34:10.222510: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 13190689031918918637
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 15313545664994973876
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 9875623278408472185
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 14488799430083828561
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 5038591682411363096
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.843369/DATA/Modified/spectogram/spec_02.mat
(1, 187)
(1, 187)
(187, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/spec_02_t.mat
(1, 74)
(1, 74)
(74, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 2 with spec gave avg accuracy 0.25714286267757414/0.35882352919262994 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/wig_02.mat
(1, 187)
(1, 187)
(187, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/wig_02_t.mat
(1, 74)
(1, 74)
(74, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 2 with wig gave avg accuracy 0.42142857760190966/0.33048128301208035 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/amb_02.mat
(1, 187)
(1, 187)
(187, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/amb_02_t.mat
(1, 74)
(1, 74)
(74, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 2 with amb gave avg accuracy 0.3982142940163612/0.3502673796831287 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/slep_02.mat
(1, 187)
(1, 187)
(187, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/slep_02_t.mat
(1, 74)
(1, 74)
(74, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 2 with slep gave avg accuracy 0.2642857193946838/0.352406416450911 over 10 splits
2018-05-30 03:01:30.329979: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-30 03:01:30.542345: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 03:01:30.658920: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 03:01:30.803704: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 03:01:30.940357: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 03:01:30.941057: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-30 03:01:30.941176: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-30 03:01:30.941205: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-30 03:01:30.941225: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-30 03:01:30.941265: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-30 03:01:30.941286: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-30 03:01:30.941316: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-30 03:01:30.941344: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-30 03:01:30.941365: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-30 03:01:30.941384: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-30 03:02:22.959426: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-30 03:02:22.959547: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-30 03:02:22.959571: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-30 03:02:22.959589: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 3041458505461961459
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 15610302743610734351
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 919472212335653350
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 138372811117782118
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 3688707146039407244
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.843369/DATA/Modified/spectogram/spec_03.mat
(1, 186)
(1, 186)
(186, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/spec_03_t.mat
(1, 130)
(1, 130)
(130, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 3 with spec gave avg accuracy 0.3230769343674183/0.339247313061709 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/wig_03.mat
(1, 186)
(1, 186)
(186, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/wig_03_t.mat
(1, 130)
(1, 130)
(130, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 3 with wig gave avg accuracy 0.3384615480899811/0.28010752735839733 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/amb_03.mat
(1, 186)
(1, 186)
(186, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/amb_03_t.mat
(1, 130)
(1, 130)
(130, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 3 with amb gave avg accuracy 0.3307692378759384/0.3607526889611637 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/slep_03.mat
(1, 186)
(1, 186)
(186, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/slep_03_t.mat
(1, 130)
(1, 130)
(130, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 3 with slep gave avg accuracy 0.34615385681390765/0.30053763548212664 over 10 splits
2018-05-30 05:36:15.468396: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-30 05:36:15.740307: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 05:36:15.875741: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 05:36:16.034740: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 05:36:16.179344: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 05:36:16.180032: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-30 05:36:16.180143: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-30 05:36:16.180171: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-30 05:36:16.180190: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-30 05:36:16.180230: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-30 05:36:16.180250: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-30 05:36:16.180281: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-30 05:36:16.180303: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-30 05:36:16.180322: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-30 05:36:16.180340: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-30 05:37:07.066906: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-30 05:37:07.067035: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-30 05:37:07.067061: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-30 05:37:07.067081: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 14767882307241116620
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 10332096937910580693
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 15077162137708318384
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 4803559519449208836
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 4583546000134561418
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.843369/DATA/Modified/spectogram/spec_04.mat
(1, 185)
(1, 185)
(185, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/spec_04_t.mat
(1, 96)
(1, 96)
(96, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 4 with spec gave avg accuracy 0.3444444514811039/0.33729729693080934 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/wig_04.mat
(1, 185)
(1, 185)
(185, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/wig_04_t.mat
(1, 96)
(1, 96)
(96, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 4 with wig gave avg accuracy 0.3088888987898827/0.33945945945543216 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/amb_04.mat
(1, 185)
(1, 185)
(185, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/amb_04_t.mat
(1, 96)
(1, 96)
(96, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 4 with amb gave avg accuracy 0.2722222298383713/0.3529729724131726 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/slep_04.mat
(1, 185)
(1, 185)
(185, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/slep_04_t.mat
(1, 96)
(1, 96)
(96, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 4 with slep gave avg accuracy 0.273333340883255/0.34162162120680556 over 10 splits
2018-05-30 07:35:58.659292: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-30 07:35:58.992268: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 07:35:59.137440: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 07:35:59.297716: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 07:35:59.444378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 07:35:59.445074: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-30 07:35:59.445195: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-30 07:35:59.445225: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-30 07:35:59.445267: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-30 07:35:59.445288: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-30 07:35:59.445306: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-30 07:35:59.445352: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-30 07:35:59.445380: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-30 07:35:59.445400: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-30 07:35:59.445419: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-30 07:36:52.103684: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-30 07:36:52.103812: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-30 07:36:52.103835: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-30 07:36:52.103852: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 10095888113582673129
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 3261525007107341458
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 7546014975140241846
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 1751202152833007186
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 8045706306138743811
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.843369/DATA/Modified/spectogram/spec_05.mat
(1, 187)
(1, 187)
(187, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/spec_05_t.mat
(1, 109)
(1, 109)
(109, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 5 with spec gave avg accuracy 0.2654545530676842/0.3470588228839604 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/wig_05.mat
(1, 187)
(1, 187)
(187, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/wig_05_t.mat
(1, 109)
(1, 109)
(109, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 5 with wig gave avg accuracy 0.3209091007709503/0.34759358299129145 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/amb_05.mat
(1, 187)
(1, 187)
(187, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/amb_05_t.mat
(1, 109)
(1, 109)
(109, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 5 with amb gave avg accuracy 0.3763636440038681/0.3636363638833882 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/slep_05.mat
(1, 187)
(1, 187)
(187, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/slep_05_t.mat
(1, 109)
(1, 109)
(109, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 5 with slep gave avg accuracy 0.29181819036602974/0.34064171157259354 over 10 splits
2018-05-30 09:47:46.701641: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-30 09:47:46.936208: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 09:47:47.062772: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 09:47:47.209823: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 09:47:47.344368: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 09:47:47.345065: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-30 09:47:47.345184: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-30 09:47:47.345214: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-30 09:47:47.345257: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-30 09:47:47.345278: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-30 09:47:47.345296: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-30 09:47:47.345326: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-30 09:47:47.345355: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-30 09:47:47.345377: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-30 09:47:47.345397: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-30 09:48:50.723095: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-30 09:48:50.723210: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-30 09:48:50.723235: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-30 09:48:50.723253: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 3335887298880155222
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 14071883560805017734
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 11850134483075313884
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 14308808430616131110
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 7167871887524572753
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.843369/DATA/Modified/spectogram/spec_06.mat
(1, 184)
(1, 184)
(184, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/spec_06_t.mat
(1, 121)
(1, 121)
(121, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 6 with spec gave avg accuracy 0.41474359184503556/0.34293478225236357 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/wig_06.mat
(1, 184)
(1, 184)
(184, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/wig_06_t.mat
(1, 121)
(1, 121)
(121, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 6 with wig gave avg accuracy 0.33076923340559006/0.35543478286784624 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/amb_06.mat
(1, 184)
(1, 184)
(184, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/amb_06_t.mat
(1, 121)
(1, 121)
(121, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 6 with amb gave avg accuracy 0.3044871799647808/0.3445652175856674 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/slep_06.mat
(1, 184)
(1, 184)
(184, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/slep_06_t.mat
(1, 121)
(1, 121)
(121, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 6 with slep gave avg accuracy 0.33076923340559006/0.3331521737186805 over 10 splits
2018-05-30 12:12:34.804153: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-30 12:12:35.048074: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 12:12:35.172354: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 12:12:35.331636: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 12:12:35.469378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 12:12:35.470087: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-30 12:12:35.470213: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-30 12:12:35.470256: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-30 12:12:35.470299: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-30 12:12:35.470320: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-30 12:12:35.470338: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-30 12:12:35.470367: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-30 12:12:35.470395: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-30 12:12:35.470416: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-30 12:12:35.470436: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-30 12:13:27.795758: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-30 12:13:27.795883: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-30 12:13:27.795910: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-30 12:13:27.795932: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 10847041001792297359
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 12306572528067803866
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 14054775276438438385
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 3623035150905249043
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 10865827624753278573
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.843369/DATA/Modified/spectogram/spec_07.mat
(1, 188)
(1, 188)
(188, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/spec_07_t.mat
(1, 87)
(1, 87)
(87, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 7 with spec gave avg accuracy 0.3013888902962208/0.3297872341693716 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/wig_07.mat
(1, 188)
(1, 188)
(188, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/wig_07_t.mat
(1, 87)
(1, 87)
(87, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 7 with wig gave avg accuracy 0.2250000037252903/0.353723404405916 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/amb_07.mat
(1, 188)
(1, 188)
(188, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/amb_07_t.mat
(1, 87)
(1, 87)
(87, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 7 with amb gave avg accuracy 0.2750000052154064/0.3340425532628247 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/slep_07.mat
(1, 188)
(1, 188)
(188, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/slep_07_t.mat
(1, 87)
(1, 87)
(87, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 7 with slep gave avg accuracy 0.30416667014360427/0.29680851092363925 over 10 splits
2018-05-30 14:00:55.640546: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-30 14:00:55.873969: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 14:00:55.998992: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 14:00:56.142095: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 14:00:56.283384: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 14:00:56.284077: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-30 14:00:56.284197: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-30 14:00:56.284250: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-30 14:00:56.284272: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-30 14:00:56.284291: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-30 14:00:56.284308: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-30 14:00:56.284338: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-30 14:00:56.284366: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-30 14:00:56.284387: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-30 14:00:56.284406: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-30 14:01:48.486633: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-30 14:01:48.486759: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-30 14:01:48.486783: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-30 14:01:48.486800: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 8382252163168157633
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 16810559067430293941
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 4299596454275901369
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 2072731872496163741
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 2276792621879227483
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.843369/DATA/Modified/spectogram/spec_08.mat
(1, 190)
(1, 190)
(190, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/spec_08_t.mat
(1, 113)
(1, 113)
(113, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 8 with spec gave avg accuracy 0.4515151590108871/0.3905263167305996 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/wig_08.mat
(1, 190)
(1, 190)
(190, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/wig_08_t.mat
(1, 113)
(1, 113)
(113, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 8 with wig gave avg accuracy 0.35757576674222946/0.32947368464187576 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/amb_08.mat
(1, 190)
(1, 190)
(190, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/amb_08_t.mat
(1, 113)
(1, 113)
(113, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 8 with amb gave avg accuracy 0.41666667014360426/0.34368421038514685 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/slep_08.mat
(1, 190)
(1, 190)
(190, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/slep_08_t.mat
(1, 113)
(1, 113)
(113, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 8 with slep gave avg accuracy 0.4765151560306549/0.36631579083831683 over 10 splits
2018-05-30 16:16:39.172911: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-30 16:16:39.406188: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 16:16:39.530008: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 16:16:39.677162: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 16:16:39.812736: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 16:16:39.813461: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-30 16:16:39.813581: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-30 16:16:39.813633: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-30 16:16:39.813656: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-30 16:16:39.813674: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-30 16:16:39.813692: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-30 16:16:39.813725: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-30 16:16:39.813750: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-30 16:16:39.813771: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-30 16:16:39.813791: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-30 16:17:26.346792: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-30 16:17:26.346921: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-30 16:17:26.346945: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-30 16:17:26.346981: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 13139363870782978333
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 7111475058353720837
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 5353681958604435620
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 3863501710232459950
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 15569554722763201842
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.843369/DATA/Modified/spectogram/spec_09.mat
(1, 186)
(1, 186)
(186, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/spec_09_t.mat
(1, 83)
(1, 83)
(83, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 9 with spec gave avg accuracy 0.21944444477558137/0.32473118338854084 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/wig_09.mat
(1, 186)
(1, 186)
(186, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/wig_09_t.mat
(1, 83)
(1, 83)
(83, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 9 with wig gave avg accuracy 0.30000000074505806/0.35161290381464266 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/amb_09.mat
(1, 186)
(1, 186)
(186, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/amb_09_t.mat
(1, 83)
(1, 83)
(83, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 9 with amb gave avg accuracy 0.35972222685813904/0.360752688905084 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/slep_09.mat
(1, 186)
(1, 186)
(186, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/slep_09_t.mat
(1, 83)
(1, 83)
(83, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 9 with slep gave avg accuracy 0.2902777798473835/0.3080645169862496 over 10 splits
2018-05-30 18:00:15.619159: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-30 18:00:15.848556: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 18:00:15.971530: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 18:00:16.118611: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 18:00:16.254119: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 18:00:16.254805: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-30 18:00:16.254947: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-30 18:00:16.254987: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-30 18:00:16.255009: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-30 18:00:16.255027: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-30 18:00:16.255044: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-30 18:00:16.255078: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-30 18:00:16.255102: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-30 18:00:16.255122: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-30 18:00:16.255142: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-30 18:01:05.684516: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-30 18:01:05.684643: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-30 18:01:05.684667: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-30 18:01:05.684685: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 9386411022075054943
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 12578409021526943000
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 393499042921906251
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 4082374364567524655
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 5311852978664217864
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.843369/DATA/Modified/spectogram/spec_11.mat
(1, 182)
(1, 182)
(182, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/spec_11_t.mat
(1, 98)
(1, 98)
(98, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 11 with spec gave avg accuracy 0.25888889357447625/0.3219780227967671 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/wig_11.mat
(1, 182)
(1, 182)
(182, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/wig_11_t.mat
(1, 98)
(1, 98)
(98, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 11 with wig gave avg accuracy 0.3755555599927902/0.30604395540533486 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/amb_11.mat
(1, 182)
(1, 182)
(182, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/amb_11_t.mat
(1, 98)
(1, 98)
(98, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 11 with amb gave avg accuracy 0.29888889491558074/0.32692307644820473 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/slep_11.mat
(1, 182)
(1, 182)
(182, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/slep_11_t.mat
(1, 98)
(1, 98)
(98, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 11 with slep gave avg accuracy 0.31555556505918503/0.3368131877629312 over 10 splits
2018-05-30 20:00:41.149345: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-30 20:00:41.386973: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 20:00:41.511498: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 20:00:41.656872: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 20:00:41.793548: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 20:00:41.794278: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-30 20:00:41.794424: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-30 20:00:41.794455: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-30 20:00:41.794475: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-30 20:00:41.794493: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-30 20:00:41.794510: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-30 20:00:41.794543: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-30 20:00:41.794568: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-30 20:00:41.794589: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-30 20:00:41.794609: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-30 20:01:29.993062: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-30 20:01:29.993185: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-30 20:01:29.993208: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-30 20:01:29.993226: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 4464181871610764923
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 7942146352221178959
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 14119359383398089442
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 17599826204660110918
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 222813308368857152
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.843369/DATA/Modified/spectogram/spec_12.mat
(1, 190)
(1, 190)
(190, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/spec_12_t.mat
(1, 95)
(1, 95)
(95, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 12 with spec gave avg accuracy 0.25000000521540644/0.312105263785312 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/wig_12.mat
(1, 190)
(1, 190)
(190, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/wig_12_t.mat
(1, 95)
(1, 95)
(95, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 12 with wig gave avg accuracy 0.3344444505870342/0.3347368431954007 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/amb_12.mat
(1, 190)
(1, 190)
(190, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/amb_12_t.mat
(1, 95)
(1, 95)
(95, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 12 with amb gave avg accuracy 0.3788888968527317/0.34263158014730405 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/slep_12.mat
(1, 190)
(1, 190)
(190, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/slep_12_t.mat
(1, 95)
(1, 95)
(95, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 12 with slep gave avg accuracy 0.33555556312203405/0.31368421178115036 over 10 splits
2018-05-30 21:57:48.342233: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-30 21:57:48.555209: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 21:57:48.675455: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 21:57:48.823309: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 21:57:48.957337: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-30 21:57:48.958042: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-30 21:57:48.958185: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-30 21:57:48.958215: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-30 21:57:48.958235: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-30 21:57:48.958253: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-30 21:57:48.958271: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-30 21:57:48.958304: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-30 21:57:48.958329: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-30 21:57:48.958351: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-30 21:57:48.958370: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-30 21:58:42.931654: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-30 21:58:42.931777: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-30 21:58:42.931801: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-30 21:58:42.931818: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 7864507970695664430
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 11094990282834083348
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 13870452602179402111
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 16408810805088212995
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 4222457076933993358
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.843369/DATA/Modified/spectogram/spec_13.mat
(1, 188)
(1, 188)
(188, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/spec_13_t.mat
(1, 113)
(1, 113)
(113, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 13 with spec gave avg accuracy 0.3522727280855179/0.3388297871627072 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/wig_13.mat
(1, 188)
(1, 188)
(188, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/wig_13_t.mat
(1, 113)
(1, 113)
(113, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 13 with wig gave avg accuracy 0.3212121292948723/0.32819148981349267 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/amb_13.mat
(1, 188)
(1, 188)
(188, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/amb_13_t.mat
(1, 113)
(1, 113)
(113, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 13 with amb gave avg accuracy 0.3689393997192383/0.3712765962598806 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/slep_13.mat
(1, 188)
(1, 188)
(188, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/slep_13_t.mat
(1, 113)
(1, 113)
(113, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 13 with slep gave avg accuracy 0.3545454636216164/0.39148936219354896 over 10 splits
2018-05-31 00:16:00.449659: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-31 00:16:00.684669: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 00:16:00.808523: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 00:16:00.952812: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 00:16:01.086718: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 00:16:01.087442: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-31 00:16:01.087565: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-31 00:16:01.087594: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-31 00:16:01.087613: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-31 00:16:01.087631: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-31 00:16:01.087648: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-31 00:16:01.087680: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-31 00:16:01.087705: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-31 00:16:01.087726: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-31 00:16:01.087745: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-31 00:16:50.242475: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-31 00:16:50.242604: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-31 00:16:50.242628: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-31 00:16:50.242646: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 8746398686362586758
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 1269189843515439140
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 15376606702709076944
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 18306271979843966941
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 15979859801546545037
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.843369/DATA/Modified/spectogram/spec_14.mat
(1, 191)
(1, 191)
(191, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/spec_14_t.mat
(1, 74)
(1, 74)
(74, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 14 with spec gave avg accuracy 0.3250000074505806/0.34764397754407056 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/wig_14.mat
(1, 191)
(1, 191)
(191, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/wig_14_t.mat
(1, 74)
(1, 74)
(74, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 14 with wig gave avg accuracy 0.37678572088479995/0.3246073294372459 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/amb_14.mat
(1, 191)
(1, 191)
(191, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/amb_14_t.mat
(1, 74)
(1, 74)
(74, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 14 with amb gave avg accuracy 0.3625000059604645/0.38167539182757826 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/slep_14.mat
(1, 191)
(1, 191)
(191, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/slep_14_t.mat
(1, 74)
(1, 74)
(74, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 14 with slep gave avg accuracy 0.3410714343190193/0.3565445014787594 over 10 splits
2018-05-31 01:47:04.631057: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-31 01:47:04.865738: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 01:47:04.988311: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 01:47:05.133325: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 01:47:05.268481: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 01:47:05.269202: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-31 01:47:05.269322: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-31 01:47:05.269352: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-31 01:47:05.269372: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-31 01:47:05.269391: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-31 01:47:05.269410: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-31 01:47:05.269440: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-31 01:47:05.269468: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-31 01:47:05.269491: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-31 01:47:05.269511: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-31 01:48:01.941306: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-31 01:48:01.941434: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-31 01:48:01.941459: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-31 01:48:01.941477: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 3757234414959510023
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 4551580182704454346
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 14598141630855525561
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 6979713243933775620
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 1805567634923364589
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.843369/DATA/Modified/spectogram/spec_15.mat
(1, 181)
(1, 181)
(181, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/spec_15_t.mat
(1, 125)
(1, 125)
(125, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 15 with spec gave avg accuracy 0.30320513248443604/0.3596685095962899 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/wig_15.mat
(1, 181)
(1, 181)
(181, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/wig_15_t.mat
(1, 125)
(1, 125)
(125, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 15 with wig gave avg accuracy 0.373076930642128/0.3524861886521071 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/amb_15.mat
(1, 181)
(1, 181)
(181, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/amb_15_t.mat
(1, 125)
(1, 125)
(125, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 15 with amb gave avg accuracy 0.30192308202385904/0.3718232055704074 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/slep_15.mat
(1, 181)
(1, 181)
(181, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/slep_15_t.mat
(1, 125)
(1, 125)
(125, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 15 with slep gave avg accuracy 0.25705128610134126/0.3690607746167736 over 10 splits
2018-05-31 04:19:29.240322: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-31 04:19:29.470579: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 04:19:29.595668: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 04:19:29.742668: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 04:19:29.877313: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 04:19:29.878033: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-31 04:19:29.878153: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-31 04:19:29.878183: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-31 04:19:29.878202: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-31 04:19:29.878220: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-31 04:19:29.878237: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-31 04:19:29.878265: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-31 04:19:29.878293: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-31 04:19:29.878313: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-31 04:19:29.878332: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-31 04:20:12.766245: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-31 04:20:12.766369: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-31 04:20:12.766393: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-31 04:20:12.766411: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 5031416484552536885
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 9473486369898364949
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 6864565557514363230
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 11699870865702935043
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 13935095911756952129
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.843369/DATA/Modified/spectogram/spec_16.mat
(1, 192)
(1, 192)
(192, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/spec_16_t.mat
(1, 62)
(1, 62)
(62, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 16 with spec gave avg accuracy 0.27380952835083006/0.321875 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/wig_16.mat
(1, 192)
(1, 192)
(192, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/wig_16_t.mat
(1, 62)
(1, 62)
(62, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 16 with wig gave avg accuracy 0.340476194024086/0.30937500000000007 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/amb_16.mat
(1, 192)
(1, 192)
(192, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/amb_16_t.mat
(1, 62)
(1, 62)
(62, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 16 with amb gave avg accuracy 0.38809524327516554/0.3197916666666667 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/slep_16.mat
(1, 192)
(1, 192)
(192, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/slep_16_t.mat
(1, 62)
(1, 62)
(62, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 16 with slep gave avg accuracy 0.1904761955142021/0.35052083333333334 over 10 splits
2018-05-31 05:40:13.210449: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-31 05:40:13.469194: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 05:40:13.589680: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 05:40:13.750879: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 05:40:13.888089: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 05:40:13.888822: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-31 05:40:13.888943: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-31 05:40:13.888990: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-31 05:40:13.889012: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-31 05:40:13.889031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-31 05:40:13.889049: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-31 05:40:13.889081: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-31 05:40:13.889110: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-31 05:40:13.889133: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-31 05:40:13.889154: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-31 05:41:01.938042: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-31 05:41:01.938164: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-31 05:41:01.938189: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-31 05:41:01.938208: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 7880266994839557944
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 2222991945044752177
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 7018938911985745522
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 5618041899772300854
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 4280547230975155563
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.843369/DATA/Modified/spectogram/spec_17.mat
(1, 190)
(1, 190)
(190, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/spec_17_t.mat
(1, 68)
(1, 68)
(68, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 17 with spec gave avg accuracy 0.22142858058214188/0.35052631676981316 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/wig_17.mat
(1, 190)
(1, 190)
(190, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/wig_17_t.mat
(1, 68)
(1, 68)
(68, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 17 with wig gave avg accuracy 0.27857143729925155/0.3010526321397016 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/amb_17.mat
(1, 190)
(1, 190)
(190, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/amb_17_t.mat
(1, 68)
(1, 68)
(68, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 17 with amb gave avg accuracy 0.2500000074505806/0.2873684219153304 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/slep_17.mat
(1, 190)
(1, 190)
(190, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/slep_17_t.mat
(1, 68)
(1, 68)
(68, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 17 with slep gave avg accuracy 0.15952381640672683/0.3631578960701039 over 10 splits
2018-05-31 07:07:37.395512: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-31 07:07:37.745020: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 07:07:37.882261: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 07:07:38.042292: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 07:07:38.190713: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 07:07:38.191459: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-31 07:07:38.191577: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-31 07:07:38.191606: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-31 07:07:38.191625: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-31 07:07:38.191643: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-31 07:07:38.191660: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-31 07:07:38.191698: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-31 07:07:38.191724: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-31 07:07:38.191745: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-31 07:07:38.191765: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-31 07:08:21.019335: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-31 07:08:21.019460: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-31 07:08:21.019484: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-31 07:08:21.019502: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 14582788764219261029
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 11467995436744528870
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 13688224574772570017
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 5809246718031870074
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 9917659366654251452
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.843369/DATA/Modified/spectogram/spec_18.mat
(1, 185)
(1, 185)
(185, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/spec_18_t.mat
(1, 70)
(1, 70)
(70, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 18 with spec gave avg accuracy 0.3000000089406967/0.33675675686146767 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/wig_18.mat
(1, 185)
(1, 185)
(185, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/wig_18_t.mat
(1, 70)
(1, 70)
(70, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 18 with wig gave avg accuracy 0.3285714387893677/0.29621621604304055 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/amb_18.mat
(1, 185)
(1, 185)
(185, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/amb_18_t.mat
(1, 70)
(1, 70)
(70, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 18 with amb gave avg accuracy 0.40000001043081285/0.31945945914935414 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/slep_18.mat
(1, 185)
(1, 185)
(185, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/slep_18_t.mat
(1, 70)
(1, 70)
(70, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 18 with slep gave avg accuracy 0.4142857238650322/0.34486486502595853 over 10 splits
2018-05-31 08:38:37.812941: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-31 08:38:38.121379: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 08:38:38.256575: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 08:38:38.419105: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 08:38:38.566739: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-05-31 08:38:38.567461: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-05-31 08:38:38.567580: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 2 3 
2018-05-31 08:38:38.567609: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y N N 
2018-05-31 08:38:38.567628: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y N N 
2018-05-31 08:38:38.567645: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 2:   N N Y Y 
2018-05-31 08:38:38.567662: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 3:   N N Y Y 
2018-05-31 08:38:38.567695: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-31 08:38:38.567720: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-31 08:38:38.567740: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-31 08:38:38.567759: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
2018-05-31 08:39:25.843999: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-05-31 08:39:25.844125: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-05-31 08:39:25.844150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-05-31 08:39:25.844168: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/test/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 8673294553872163604
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11325135258
locality {
  bus_id: 1
}
incarnation: 10313748110756311650
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 1
}
incarnation: 2740984517309811456
physical_device_desc: "device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 11325010740
locality {
  bus_id: 2
}
incarnation: 9009180471498870873
physical_device_desc: "device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 11323142964
locality {
  bus_id: 2
}
incarnation: 11308615267970949476
physical_device_desc: "device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7"
]
/local/slurmtmp.843369/DATA/Modified/spectogram/spec_19.mat
(1, 181)
(1, 181)
(181, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/spec_19_t.mat
(1, 91)
(1, 91)
(91, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_1 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_1 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_2 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_2 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_3 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_3 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_1 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 19 with spec gave avg accuracy 0.36444445326924324/0.3232044214537131 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/wig_19.mat
(1, 181)
(1, 181)
(181, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/wig_19_t.mat
(1, 91)
(1, 91)
(91, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_4 (ELU)                  (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_4 (Average (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_5 (ELU)                  (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_5 (Average (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_6 (ELU)                  (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_2 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 19 with wig gave avg accuracy 0.3300000071525574/0.3392265214198861 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/amb_19.mat
(1, 181)
(1, 181)
(181, 192, 512, 31)
(192, 512, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/amb_19_t.mat
(1, 91)
(1, 91)
(91, 192, 512, 31)
(192, 512, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 192, 512, 31)      0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 192, 512, 4)       3972      
_________________________________________________________________
elu_7 (ELU)                  (None, 192, 512, 4)       0         
_________________________________________________________________
average_pooling2d_7 (Average (None, 48, 128, 4)        0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 48, 128, 4)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 48, 128, 8)        1032      
_________________________________________________________________
elu_8 (ELU)                  (None, 48, 128, 8)        0         
_________________________________________________________________
average_pooling2d_8 (Average (None, 12, 32, 8)         0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 12, 32, 8)         0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 12, 32, 16)        4112      
_________________________________________________________________
elu_9 (ELU)                  (None, 12, 32, 16)        0         
_________________________________________________________________
average_pooling2d_9 (Average (None, 3, 8, 16)          0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 3, 8, 16)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 384)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 15)                5775      
_________________________________________________________________
activation_3 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 48        
=================================================================
Total params: 14,939
Trainable params: 14,939
Non-trainable params: 0
_________________________________________________________________
sub 19 with amb gave avg accuracy 0.2944444492459297/0.3160221007153474 over 10 splits
/local/slurmtmp.843369/DATA/Modified/spectogram/slep_19.mat
(1, 181)
(1, 181)
(181, 256, 192, 31)
(256, 192, 31)
/local/slurmtmp.843369/DATA/Modified/spectogram/slep_19_t.mat
(1, 91)
(1, 91)
(91, 256, 192, 31)
(256, 192, 31)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 256, 192, 31)      0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 256, 192, 4)       3972      
_________________________________________________________________
elu_10 (ELU)                 (None, 256, 192, 4)       0         
_________________________________________________________________
average_pooling2d_10 (Averag (None, 64, 48, 4)         0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 64, 48, 4)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 64, 48, 8)         1032      
_________________________________________________________________
elu_11 (ELU)                 (None, 64, 48, 8)         0         
_________________________________________________________________
average_pooling2d_11 (Averag (None, 16, 12, 8)         0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 16, 12, 8)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 16, 12, 16)        4112      
_________________________________________________________________
elu_12 (ELU)                 (None, 16, 12, 16)        0         
_________________________________________________________________
average_pooling2d_12 (Averag (None, 4, 3, 16)          0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 4, 3, 16)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 192)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 15)                2895      
_________________________________________________________________
activation_4 (Activation)    (None, 15)                0         
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 48        
=================================================================
Total params: 12,059
Trainable params: 12,059
Non-trainable params: 0
_________________________________________________________________
sub 19 with slep gave avg accuracy 0.30555556192994116/0.3497237579433957 over 10 splits
end time
Thu May 31 10:30:39 CEST 2018
