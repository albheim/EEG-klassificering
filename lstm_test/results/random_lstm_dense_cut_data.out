data dir
/lunarc/nobackup/users/albheim/EEG-klassificering/DATA
script
#!/bin/sh
#SBATCH -t 10:00:00
#SBATCH -J lstm_eeg
#SBATCH -A lu2018-2-3
#// SBATCH -o stdout_%j.out
#// SBATCH -e stderr_%j.err

# shold be lu or gpu
#SBATCH -p gpu

# how many gpus, 4 per node, using many seems to crash more often so stick with 1
#SBATCH --gres=gpu:1

#SBATCH --mem-per-cpu=3100

DATA_DIR="$(cat ../data_location.txt)"
echo "data dir"
echo $DATA_DIR

echo "script"
cat $0

PY_FILE="test.py"
echo "py file"
cat $PY_FILE

echo "nvidia smi"
nvidia-smi

echo "start time"
date

cp -r $DATA_DIR $SNIC_TMP
ls $SNIC_TMP
du -h "${SNIC_TMP}/DATA"

echo "copy done time"
date

python $PY_FILE $SNIC_TMP

echo "end time"
date
py file
import sys
from datetime import datetime

import numpy as np
from scipy import io

import tensorflow as tf

from keras.models import Sequential
from keras.layers import Dense, Dropout, Input
from keras.layers import TimeDistributed
from keras.layers import SimpleRNN, RNN, LSTM, GRU

from keras.optimizers import SGD, Adam, RMSprop, Nadam
from keras import backend as K

from tensorflow.python.client import device_lib
print("here comes devices list")
print(device_lib.list_local_devices())
print("finished with device list")
print(str(datetime.now()))

import models
import data
import util


x, y = data.load_single(cut=True)


def get_random_setting():
    second_layer = np.random.choice([True, False])
    second_layer_type = np.random.choice([LSTM, Dense])
    second_layer_nodes = np.random.randint(10, 100)
    second_layer_dropout = np.random.ranf() * 0.5 + 0.25

    first_layer_nodes = np.random.randint(10, 100)
    first_layer_dropout = np.random.ranf() * 0.5 + 0.25
    if second_layer:
        first_layer_return_seq = np.random.choice([True, False])
    else:
        first_layer_return_seq = False

    output = np.random.choice([Dense])

    epochs = np.random.randint(10, 100)

    return {"first_layer_nodes": first_layer_nodes,
            "first_layer_dropout": first_layer_dropout,
            "first_layer_return_seq": first_layer_return_seq,
            "second_layer": second_layer,
            "second_layer_type": second_layer_type,
            "second_layer_nodes": second_layer_nodes,
            "second_layer_dropout": second_layer_dropout,
            "output_type": output,
            "epochs": epochs}

splits = 5
n_subs = len(x)
n_models = 20


for _ in range(n_models):
    first_layer_nodes = np.random.randint(10, 60)
    second_layer_nodes = np.random.randint(5, 30)
    dropout_prob = np.random.ranf() * 0.75
    model = models.lstm_dense(x[0][0].shape,
                              first_layer_nodes,
                              second_layer_nodes,
                              dropout_prob)

    model.summary()
    print("first {}, second {}, dropout {}".format(first_layer_nodes,
                                                   second_layer_nodes,
                                                   dropout_prob))
    w_save = model.get_weights()
    avgacc = 0
    for i in range(n_subs):
        n = x[i].shape[0]
        acc = 0
        for tr, val in util.kfold(n, splits):
            # reset to initial weights
            model.set_weights(w_save)

            # fit with next kfold data
            model.fit(x[i][tr], y[i][tr],
                      batch_size=64, epochs=50, verbose=0)

            loss, accuracy = model.evaluate(x[i][val], y[i][val], verbose=0)
            acc += accuracy

        acc /= splits
        avgacc += acc

        print("subject {}, avg accuracy {} over {} splits".format(i + 1 if i + 1 < 10 else i + 2, acc, splits))

    avgacc /= n_subs
    print("avg accuracy over all subjects {}".format(avgacc))


nvidia smi
Mon Feb 19 23:04:15 2018       
+------------------------------------------------------+                       
| NVIDIA-SMI 352.93     Driver Version: 384.81         |                       
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla K80           On   | 0000:04:00.0     Off |                    0 |
| N/A   40C    P8    27W / 149W |      1MiB / 11439MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K80           On   | 0000:05:00.0     Off |                    0 |
| N/A   53C    P8    31W / 149W |      1MiB / 11439MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   2  Tesla K80           On   | 0000:84:00.0     Off |                    0 |
| N/A   23C    P8    26W / 149W |      1MiB / 11439MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   3  Tesla K80           On   | 0000:85:00.0     Off |                    0 |
| N/A   28C    P8    29W / 149W |      1MiB / 11439MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID  Type  Process name                               Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
start time
Mon Feb 19 23:04:15 CET 2018
DATA
2.4G	/local/slurmtmp.470798/DATA/Visual
2.4G	/local/slurmtmp.470798/DATA/Verbal
4.7G	/local/slurmtmp.470798/DATA
copy done time
Mon Feb 19 23:06:22 CET 2018
2018-02-19 23:06:28.989754: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-02-19 23:06:29.547822: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:04:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-02-19 23:06:29.547935: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
2018-02-19 23:07:14.464193: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)
/home/albheim/.conda/envs/keras-gpu/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
here comes devices list
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 12457753976737759673
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 11324823962
locality {
  bus_id: 1
}
incarnation: 8666388116065202597
physical_device_desc: "device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7"
]
finished with device list
2018-02-19 23:06:30.640122
loading  Subj01_CleanData_study_FA
loading  Subj01_CleanData_study_LM
loading  Subj01_CleanData_study_OB
loading  Subj02_CleanData_study_FA
loading  Subj02_CleanData_study_LM
loading  Subj02_CleanData_study_OB
loading  Subj03_CleanData_study_FA
loading  Subj03_CleanData_study_LM
loading  Subj03_CleanData_study_OB
loading  Subj04_CleanData_study_FA
loading  Subj04_CleanData_study_LM
loading  Subj04_CleanData_study_OB
loading  Subj05_CleanData_study_FA
loading  Subj05_CleanData_study_LM
loading  Subj05_CleanData_study_OB
loading  Subj06_CleanData_study_FA
loading  Subj06_CleanData_study_LM
loading  Subj06_CleanData_study_OB
loading  Subj07_CleanData_study_FA
loading  Subj07_CleanData_study_LM
loading  Subj07_CleanData_study_OB
loading  Subj08_CleanData_study_FA
loading  Subj08_CleanData_study_LM
loading  Subj08_CleanData_study_OB
loading  Subj09_CleanData_study_FA
loading  Subj09_CleanData_study_LM
loading  Subj09_CleanData_study_OB
loading  Subj11_CleanData_study_FA
loading  Subj11_CleanData_study_LM
loading  Subj11_CleanData_study_OB
loading  Subj12_CleanData_study_FA
loading  Subj12_CleanData_study_LM
loading  Subj12_CleanData_study_OB
loading  Subj13_CleanData_study_FA
loading  Subj13_CleanData_study_LM
loading  Subj13_CleanData_study_OB
loading  Subj14_CleanData_study_FA
loading  Subj14_CleanData_study_LM
loading  Subj14_CleanData_study_OB
loading  Subj15_CleanData_study_FA
loading  Subj15_CleanData_study_LM
loading  Subj15_CleanData_study_OB
loading  Subj16_CleanData_study_FA
loading  Subj16_CleanData_study_LM
loading  Subj16_CleanData_study_OB
loading  Subj17_CleanData_study_FA
loading  Subj17_CleanData_study_LM
loading  Subj17_CleanData_study_OB
loading  Subj18_CleanData_study_FA
loading  Subj18_CleanData_study_LM
loading  Subj18_CleanData_study_OB
loading  Subj19_CleanData_study_FA
loading  Subj19_CleanData_study_LM
loading  Subj19_CleanData_study_OB
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 57)                188328    
_________________________________________________________________
dropout_1 (Dropout)          (None, 57)                0         
_________________________________________________________________
dense_1 (Dense)              (None, 18)                1044      
_________________________________________________________________
dense_2 (Dense)              (None, 3)                 57        
=================================================================
Total params: 189,429
Trainable params: 189,429
Non-trainable params: 0
_________________________________________________________________
first 57, second 18, dropout 0.13350237872517529
subject 1, avg accuracy 0.5027027046358263 over 5 splits
subject 2, avg accuracy 0.36899004322960227 over 5 splits
subject 3, avg accuracy 0.41450924728791705 over 5 splits
subject 4, avg accuracy 0.34594594659032046 over 5 splits
subject 5, avg accuracy 0.5076813672421497 over 5 splits
subject 6, avg accuracy 0.5061561571227179 over 5 splits
subject 7, avg accuracy 0.45746799621354806 over 5 splits
subject 8, avg accuracy 0.410526316416891 over 5 splits
subject 9, avg accuracy 0.41322901969190007 over 5 splits
subject 11, avg accuracy 0.37957957966012634 over 5 splits
subject 12, avg accuracy 0.4000000015685433 over 5 splits
subject 13, avg accuracy 0.4092460897704785 over 5 splits
subject 14, avg accuracy 0.48205128453681995 over 5 splits
subject 15, avg accuracy 0.38153153169262516 over 5 splits
subject 16, avg accuracy 0.38974359036296324 over 5 splits
subject 17, avg accuracy 0.4263157913559361 over 5 splits
subject 18, avg accuracy 0.3513513518346322 over 5 splits
subject 19, avg accuracy 0.3807807808613276 over 5 splits
avg accuracy over all subjects 0.4182116000041291
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_2 (LSTM)                (None, 49)                160328    
_________________________________________________________________
dropout_2 (Dropout)          (None, 49)                0         
_________________________________________________________________
dense_3 (Dense)              (None, 24)                1200      
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 75        
=================================================================
Total params: 161,603
Trainable params: 161,603
Non-trainable params: 0
_________________________________________________________________
first 49, second 24, dropout 0.735343446594051
subject 1, avg accuracy 0.4432432443708986 over 5 splits
subject 2, avg accuracy 0.3536273126454645 over 5 splits
subject 3, avg accuracy 0.392745377672346 over 5 splits
subject 4, avg accuracy 0.37297297393953477 over 5 splits
subject 5, avg accuracy 0.4605974412193339 over 5 splits
subject 6, avg accuracy 0.4950450465754345 over 5 splits
subject 7, avg accuracy 0.42645803793395737 over 5 splits
subject 8, avg accuracy 0.4789473709307218 over 5 splits
subject 9, avg accuracy 0.37596017158302775 over 5 splits
subject 11, avg accuracy 0.42372372436809835 over 5 splits
subject 12, avg accuracy 0.4210526336180537 over 5 splits
subject 13, avg accuracy 0.3988620202325995 over 5 splits
subject 14, avg accuracy 0.5126855611358738 over 5 splits
subject 15, avg accuracy 0.3812312315534185 over 5 splits
subject 16, avg accuracy 0.4203778697491979 over 5 splits
subject 17, avg accuracy 0.5368421074591185 over 5 splits
subject 18, avg accuracy 0.3135135144800753 over 5 splits
subject 19, avg accuracy 0.4199699700505167 over 5 splits
avg accuracy over all subjects 0.4237697560843151
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_3 (LSTM)                (None, 32)                102528    
_________________________________________________________________
dropout_3 (Dropout)          (None, 32)                0         
_________________________________________________________________
dense_5 (Dense)              (None, 5)                 165       
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 18        
=================================================================
Total params: 102,711
Trainable params: 102,711
Non-trainable params: 0
_________________________________________________________________
first 32, second 5, dropout 0.09206296377486903
subject 1, avg accuracy 0.43783783864330605 over 5 splits
subject 2, avg accuracy 0.33641536328650135 over 5 splits
subject 3, avg accuracy 0.3873399725891279 over 5 splits
subject 4, avg accuracy 0.38918919023629783 over 5 splits
subject 5, avg accuracy 0.4594594608202767 over 5 splits
subject 6, avg accuracy 0.4623123133594209 over 5 splits
subject 7, avg accuracy 0.43058321630293406 over 5 splits
subject 8, avg accuracy 0.49473684398751505 over 5 splits
subject 9, avg accuracy 0.34893314486970944 over 5 splits
subject 11, avg accuracy 0.3573573575989978 over 5 splits
subject 12, avg accuracy 0.4210526326769276 over 5 splits
subject 13, avg accuracy 0.38819345654668036 over 5 splits
subject 14, avg accuracy 0.5076923079818849 over 5 splits
subject 15, avg accuracy 0.4306306307917243 over 5 splits
subject 16, avg accuracy 0.4272604591450711 over 5 splits
subject 17, avg accuracy 0.41052631704430836 over 5 splits
subject 18, avg accuracy 0.34054054166819603 over 5 splits
subject 19, avg accuracy 0.4310810811616279 over 5 splits
avg accuracy over all subjects 0.41450789603947263
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_4 (LSTM)                (None, 25)                79400     
_________________________________________________________________
dropout_4 (Dropout)          (None, 25)                0         
_________________________________________________________________
dense_7 (Dense)              (None, 7)                 182       
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 24        
=================================================================
Total params: 79,606
Trainable params: 79,606
Non-trainable params: 0
_________________________________________________________________
first 25, second 7, dropout 0.5608990240151451
subject 1, avg accuracy 0.40540540717743545 over 5 splits
subject 2, avg accuracy 0.3745376968705977 over 5 splits
subject 3, avg accuracy 0.4142247519528713 over 5 splits
subject 4, avg accuracy 0.3513513531233813 over 5 splits
subject 5, avg accuracy 0.4715504992991728 over 5 splits
subject 6, avg accuracy 0.4729729734562539 over 5 splits
subject 7, avg accuracy 0.4678520629110919 over 5 splits
subject 8, avg accuracy 0.4315789479958384 over 5 splits
subject 9, avg accuracy 0.32773826554269236 over 5 splits
subject 11, avg accuracy 0.40600600673092735 over 5 splits
subject 12, avg accuracy 0.3842105272569154 over 5 splits
subject 13, avg accuracy 0.41422475138904363 over 5 splits
subject 14, avg accuracy 0.4246963578197155 over 5 splits
subject 15, avg accuracy 0.4424924924924925 over 5 splits
subject 16, avg accuracy 0.457624832073204 over 5 splits
subject 17, avg accuracy 0.39473684336009784 over 5 splits
subject 18, avg accuracy 0.3675675685341293 over 5 splits
subject 19, avg accuracy 0.37642642642642643 over 5 splits
avg accuracy over all subjects 0.4102887646895715
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_5 (LSTM)                (None, 13)                40664     
_________________________________________________________________
dropout_5 (Dropout)          (None, 13)                0         
_________________________________________________________________
dense_9 (Dense)              (None, 20)                280       
_________________________________________________________________
dense_10 (Dense)             (None, 3)                 63        
=================================================================
Total params: 41,007
Trainable params: 41,007
Non-trainable params: 0
_________________________________________________________________
first 13, second 20, dropout 0.37554810815226125
subject 1, avg accuracy 0.4702702722033939 over 5 splits
subject 2, avg accuracy 0.30938833650111475 over 5 splits
subject 3, avg accuracy 0.3334281657235551 over 5 splits
subject 4, avg accuracy 0.35135135239846 over 5 splits
subject 5, avg accuracy 0.4122332874436466 over 5 splits
subject 6, avg accuracy 0.5003003018306899 over 5 splits
subject 7, avg accuracy 0.42048364241804875 over 5 splits
subject 8, avg accuracy 0.4578947379400856 over 5 splits
subject 9, avg accuracy 0.34395448136041373 over 5 splits
subject 11, avg accuracy 0.37852852877016896 over 5 splits
subject 12, avg accuracy 0.36842105341585063 over 5 splits
subject 13, avg accuracy 0.29174964549616084 over 5 splits
subject 14, avg accuracy 0.43468286185531635 over 5 splits
subject 15, avg accuracy 0.36996997005051685 over 5 splits
subject 16, avg accuracy 0.4381916344809307 over 5 splits
subject 17, avg accuracy 0.4631578958348224 over 5 splits
subject 18, avg accuracy 0.3459459469930546 over 5 splits
subject 19, avg accuracy 0.36456456456456454 over 5 splits
avg accuracy over all subjects 0.39191759329337744
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_6 (LSTM)                (None, 13)                40664     
_________________________________________________________________
dropout_6 (Dropout)          (None, 13)                0         
_________________________________________________________________
dense_11 (Dense)             (None, 28)                392       
_________________________________________________________________
dense_12 (Dense)             (None, 3)                 87        
=================================================================
Total params: 41,143
Trainable params: 41,143
Non-trainable params: 0
_________________________________________________________________
first 13, second 28, dropout 0.37738229148489166
subject 1, avg accuracy 0.4702702719617534 over 5 splits
subject 2, avg accuracy 0.3578947383555376 over 5 splits
subject 3, avg accuracy 0.3490753920666693 over 5 splits
subject 4, avg accuracy 0.4378378396904147 over 5 splits
subject 5, avg accuracy 0.5184921778197987 over 5 splits
subject 6, avg accuracy 0.4947447463556811 over 5 splits
subject 7, avg accuracy 0.39431010037024705 over 5 splits
subject 8, avg accuracy 0.4947368427326805 over 5 splits
subject 9, avg accuracy 0.37681365672334666 over 5 splits
subject 11, avg accuracy 0.4174174182228857 over 5 splits
subject 12, avg accuracy 0.36315789536425946 over 5 splits
subject 13, avg accuracy 0.3405405414901451 over 5 splits
subject 14, avg accuracy 0.39784075682945097 over 5 splits
subject 15, avg accuracy 0.4364864866475801 over 5 splits
subject 16, avg accuracy 0.39595141785669263 over 5 splits
subject 17, avg accuracy 0.40000000188225193 over 5 splits
subject 18, avg accuracy 0.34594594699305453 over 5 splits
subject 19, avg accuracy 0.37552552560607233 over 5 splits
avg accuracy over all subjects 0.40928009760936235
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_7 (LSTM)                (None, 21)                66360     
_________________________________________________________________
dropout_7 (Dropout)          (None, 21)                0         
_________________________________________________________________
dense_13 (Dense)             (None, 5)                 110       
_________________________________________________________________
dense_14 (Dense)             (None, 3)                 18        
=================================================================
Total params: 66,488
Trainable params: 66,488
Non-trainable params: 0
_________________________________________________________________
first 21, second 5, dropout 0.19099179886465945
subject 1, avg accuracy 0.4378378396904147 over 5 splits
subject 2, avg accuracy 0.36301564858275154 over 5 splits
subject 3, avg accuracy 0.4140825053239784 over 5 splits
subject 4, avg accuracy 0.40000000128874913 over 5 splits
subject 5, avg accuracy 0.5036984363965595 over 5 splits
subject 6, avg accuracy 0.5001501522443673 over 5 splits
subject 7, avg accuracy 0.46287340097881824 over 5 splits
subject 8, avg accuracy 0.5052631597769888 over 5 splits
subject 9, avg accuracy 0.3654338557850755 over 5 splits
subject 11, avg accuracy 0.3897897905952579 over 5 splits
subject 12, avg accuracy 0.31052631626003663 over 5 splits
subject 13, avg accuracy 0.3456614529976295 over 5 splits
subject 14, avg accuracy 0.43981106814183046 over 5 splits
subject 15, avg accuracy 0.4755255261699001 over 5 splits
subject 16, avg accuracy 0.411605939305263 over 5 splits
subject 17, avg accuracy 0.44210526409902073 over 5 splits
subject 18, avg accuracy 0.30810810867193583 over 5 splits
subject 19, avg accuracy 0.3917417418222885 over 5 splits
avg accuracy over all subjects 0.41484612267393695
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_8 (LSTM)                (None, 21)                66360     
_________________________________________________________________
dropout_8 (Dropout)          (None, 21)                0         
_________________________________________________________________
dense_15 (Dense)             (None, 24)                528       
_________________________________________________________________
dense_16 (Dense)             (None, 3)                 75        
=================================================================
Total params: 66,963
Trainable params: 66,963
Non-trainable params: 0
_________________________________________________________________
first 21, second 24, dropout 0.6305655967785622
subject 1, avg accuracy 0.38378378595854784 over 5 splits
subject 2, avg accuracy 0.3526315805371082 over 5 splits
subject 3, avg accuracy 0.41963015751513105 over 5 splits
subject 4, avg accuracy 0.3513513519151791 over 5 splits
subject 5, avg accuracy 0.4544807980147059 over 5 splits
subject 6, avg accuracy 0.4241741757045637 over 5 splits
subject 7, avg accuracy 0.4733997171583081 over 5 splits
subject 8, avg accuracy 0.47894737061701315 over 5 splits
subject 9, avg accuracy 0.39217638771021857 over 5 splits
subject 11, avg accuracy 0.3785285292534499 over 5 splits
subject 12, avg accuracy 0.3105263161031824 over 5 splits
subject 13, avg accuracy 0.4418207689335471 over 5 splits
subject 14, avg accuracy 0.47139001364006533 over 5 splits
subject 15, avg accuracy 0.4141141147584887 over 5 splits
subject 16, avg accuracy 0.43225371275353525 over 5 splits
subject 17, avg accuracy 0.48421052694320676 over 5 splits
subject 18, avg accuracy 0.32972973013246376 over 5 splits
subject 19, avg accuracy 0.40405405405405403 over 5 splits
avg accuracy over all subjects 0.4109557273168205
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_9 (LSTM)                (None, 11)                34320     
_________________________________________________________________
dropout_9 (Dropout)          (None, 11)                0         
_________________________________________________________________
dense_17 (Dense)             (None, 16)                192       
_________________________________________________________________
dense_18 (Dense)             (None, 3)                 51        
=================================================================
Total params: 34,563
Trainable params: 34,563
Non-trainable params: 0
_________________________________________________________________
first 11, second 16, dropout 0.08243382923665163
subject 1, avg accuracy 0.4540540559066309 over 5 splits
subject 2, avg accuracy 0.4064011389381685 over 5 splits
subject 3, avg accuracy 0.36458037192078774 over 5 splits
subject 4, avg accuracy 0.34054054094327463 over 5 splits
subject 5, avg accuracy 0.4322901859688725 over 5 splits
subject 6, avg accuracy 0.5055555569248515 over 5 splits
subject 7, avg accuracy 0.44679943149323825 over 5 splits
subject 8, avg accuracy 0.4263157910422275 over 5 splits
subject 9, avg accuracy 0.40782361524457783 over 5 splits
subject 11, avg accuracy 0.34039039055148407 over 5 splits
subject 12, avg accuracy 0.2947368439875151 over 5 splits
subject 13, avg accuracy 0.4149359902141782 over 5 splits
subject 14, avg accuracy 0.4398110670518939 over 5 splits
subject 15, avg accuracy 0.3701201202812137 over 5 splits
subject 16, avg accuracy 0.4168690962749615 over 5 splits
subject 17, avg accuracy 0.473684213035985 over 5 splits
subject 18, avg accuracy 0.3189189199660275 over 5 splits
subject 19, avg accuracy 0.43138138146192817 over 5 splits
avg accuracy over all subjects 0.4047338172893231
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_10 (LSTM)               (None, 37)                119288    
_________________________________________________________________
dropout_10 (Dropout)         (None, 37)                0         
_________________________________________________________________
dense_19 (Dense)             (None, 17)                646       
_________________________________________________________________
dense_20 (Dense)             (None, 3)                 54        
=================================================================
Total params: 119,988
Trainable params: 119,988
Non-trainable params: 0
_________________________________________________________________
first 37, second 17, dropout 0.7110973716796012
subject 1, avg accuracy 0.4594594607482085 over 5 splits
subject 2, avg accuracy 0.33044096838529213 over 5 splits
subject 3, avg accuracy 0.387197724756272 over 5 splits
subject 4, avg accuracy 0.3729729745839093 over 5 splits
subject 5, avg accuracy 0.4871977257864234 over 5 splits
subject 6, avg accuracy 0.4348348360430371 over 5 splits
subject 7, avg accuracy 0.4364153640071834 over 5 splits
subject 8, avg accuracy 0.5210526322063647 over 5 splits
subject 9, avg accuracy 0.44082503676584056 over 5 splits
subject 11, avg accuracy 0.35120120192612253 over 5 splits
subject 12, avg accuracy 0.2894736851516523 over 5 splits
subject 13, avg accuracy 0.3991465158855932 over 5 splits
subject 14, avg accuracy 0.45546558751107546 over 5 splits
subject 15, avg accuracy 0.40345345353400025 over 5 splits
subject 16, avg accuracy 0.39014844927791 over 5 splits
subject 17, avg accuracy 0.5473684229348835 over 5 splits
subject 18, avg accuracy 0.3837837842670647 over 5 splits
subject 19, avg accuracy 0.3540540541346008 over 5 splits
avg accuracy over all subjects 0.41358288210585736
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_11 (LSTM)               (None, 55)                181280    
_________________________________________________________________
dropout_11 (Dropout)         (None, 55)                0         
_________________________________________________________________
dense_21 (Dense)             (None, 22)                1232      
_________________________________________________________________
dense_22 (Dense)             (None, 3)                 69        
=================================================================
Total params: 182,581
Trainable params: 182,581
Non-trainable params: 0
_________________________________________________________________
first 55, second 22, dropout 0.49548379722709435
subject 1, avg accuracy 0.481081082450377 over 5 splits
subject 2, avg accuracy 0.28335704196398154 over 5 splits
subject 3, avg accuracy 0.4679943116214842 over 5 splits
subject 4, avg accuracy 0.4270270280741356 over 5 splits
subject 5, avg accuracy 0.4974395460797577 over 5 splits
subject 6, avg accuracy 0.44609609762648567 over 5 splits
subject 7, avg accuracy 0.46273115221331496 over 5 splits
subject 8, avg accuracy 0.4473684235623009 over 5 splits
subject 9, avg accuracy 0.4246088203927701 over 5 splits
subject 11, avg accuracy 0.39624624632679306 over 5 splits
subject 12, avg accuracy 0.310526316887454 over 5 splits
subject 13, avg accuracy 0.4247510677253878 over 5 splits
subject 14, avg accuracy 0.5188933874672723 over 5 splits
subject 15, avg accuracy 0.5142642644253579 over 5 splits
subject 16, avg accuracy 0.4269905551403318 over 5 splits
subject 17, avg accuracy 0.45263158051591174 over 5 splits
subject 18, avg accuracy 0.335135135618416 over 5 splits
subject 19, avg accuracy 0.4471471471471472 over 5 splits
avg accuracy over all subjects 0.4313494002910378
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_12 (LSTM)               (None, 32)                102528    
_________________________________________________________________
dropout_12 (Dropout)         (None, 32)                0         
_________________________________________________________________
dense_23 (Dense)             (None, 19)                627       
_________________________________________________________________
dense_24 (Dense)             (None, 3)                 60        
=================================================================
Total params: 103,215
Trainable params: 103,215
Non-trainable params: 0
_________________________________________________________________
first 32, second 19, dropout 0.14317520257890012
subject 1, avg accuracy 0.41081081201901304 over 5 splits
subject 2, avg accuracy 0.3473684218496212 over 5 splits
subject 3, avg accuracy 0.41365576207129073 over 5 splits
subject 4, avg accuracy 0.31351351472171574 over 5 splits
subject 5, avg accuracy 0.5196301574388236 over 5 splits
subject 6, avg accuracy 0.5106606619494097 over 5 splits
subject 7, avg accuracy 0.45163584653802147 over 5 splits
subject 8, avg accuracy 0.4894736859359239 over 5 splits
subject 9, avg accuracy 0.4240398310580599 over 5 splits
subject 11, avg accuracy 0.3735735738957609 over 5 splits
subject 12, avg accuracy 0.2842105271000611 over 5 splits
subject 13, avg accuracy 0.37766714241901467 over 5 splits
subject 14, avg accuracy 0.512820514521779 over 5 splits
subject 15, avg accuracy 0.44189189253626643 over 5 splits
subject 16, avg accuracy 0.3696356294045725 over 5 splits
subject 17, avg accuracy 0.4000000001568543 over 5 splits
subject 18, avg accuracy 0.32972973013246387 over 5 splits
subject 19, avg accuracy 0.3539039042260912 over 5 splits
avg accuracy over all subjects 0.40690120044304134
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_13 (LSTM)               (None, 57)                188328    
_________________________________________________________________
dropout_13 (Dropout)         (None, 57)                0         
_________________________________________________________________
dense_25 (Dense)             (None, 29)                1682      
_________________________________________________________________
dense_26 (Dense)             (None, 3)                 90        
=================================================================
Total params: 190,100
Trainable params: 190,100
Non-trainable params: 0
_________________________________________________________________
first 57, second 29, dropout 0.7402778137126241
subject 1, avg accuracy 0.4594594607482086 over 5 splits
subject 2, avg accuracy 0.3530583222848423 over 5 splits
subject 3, avg accuracy 0.38179231991893364 over 5 splits
subject 4, avg accuracy 0.4486486504206786 over 5 splits
subject 5, avg accuracy 0.4923186355345958 over 5 splits
subject 6, avg accuracy 0.4839339349810425 over 5 splits
subject 7, avg accuracy 0.4307254629403056 over 5 splits
subject 8, avg accuracy 0.48421052913916734 over 5 splits
subject 9, avg accuracy 0.46728307318212636 over 5 splits
subject 11, avg accuracy 0.3136636639053041 over 5 splits
subject 12, avg accuracy 0.3684210532589962 over 5 splits
subject 13, avg accuracy 0.463157896161249 over 5 splits
subject 14, avg accuracy 0.5028340102689951 over 5 splits
subject 15, avg accuracy 0.3647147147952615 over 5 splits
subject 16, avg accuracy 0.4064777341891236 over 5 splits
subject 17, avg accuracy 0.4842105275706241 over 5 splits
subject 18, avg accuracy 0.36756756821194203 over 5 splits
subject 19, avg accuracy 0.4417417418222886 over 5 splits
avg accuracy over all subjects 0.42856773885187127
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_14 (LSTM)               (None, 29)                92568     
_________________________________________________________________
dropout_14 (Dropout)         (None, 29)                0         
_________________________________________________________________
dense_27 (Dense)             (None, 28)                840       
_________________________________________________________________
dense_28 (Dense)             (None, 3)                 87        
=================================================================
Total params: 93,495
Trainable params: 93,495
Non-trainable params: 0
_________________________________________________________________
first 29, second 28, dropout 0.07438418076930392
subject 1, avg accuracy 0.5243243253714329 over 5 splits
subject 2, avg accuracy 0.3627311527644249 over 5 splits
subject 3, avg accuracy 0.3598862031911888 over 5 splits
subject 4, avg accuracy 0.42162162274927706 over 5 splits
subject 5, avg accuracy 0.4544807977052366 over 5 splits
subject 6, avg accuracy 0.46246246407339875 over 5 splits
subject 7, avg accuracy 0.45177809365443444 over 5 splits
subject 8, avg accuracy 0.44210526504014674 over 5 splits
subject 9, avg accuracy 0.39288762518725384 over 5 splits
subject 11, avg accuracy 0.33498498522662545 over 5 splits
subject 12, avg accuracy 0.31052631547576504 over 5 splits
subject 13, avg accuracy 0.3456614515605047 over 5 splits
subject 14, avg accuracy 0.4506072904054935 over 5 splits
subject 15, avg accuracy 0.3755255261699001 over 5 splits
subject 16, avg accuracy 0.4005398123048739 over 5 splits
subject 17, avg accuracy 0.44736842293488355 over 5 splits
subject 18, avg accuracy 0.30810810867193583 over 5 splits
subject 19, avg accuracy 0.3636636636636637 over 5 splits
avg accuracy over all subjects 0.40051461811946887
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_15 (LSTM)               (None, 31)                99200     
_________________________________________________________________
dropout_15 (Dropout)         (None, 31)                0         
_________________________________________________________________
dense_29 (Dense)             (None, 13)                416       
_________________________________________________________________
dense_30 (Dense)             (None, 3)                 42        
=================================================================
Total params: 99,658
Trainable params: 99,658
Non-trainable params: 0
_________________________________________________________________
first 31, second 13, dropout 0.012902234542206847
subject 1, avg accuracy 0.45945946090930223 over 5 splits
subject 2, avg accuracy 0.38406827951732436 over 5 splits
subject 3, avg accuracy 0.4194879101655561 over 5 splits
subject 4, avg accuracy 0.4648648659925203 over 5 splits
subject 5, avg accuracy 0.4605974412998807 over 5 splits
subject 6, avg accuracy 0.5009009017869158 over 5 splits
subject 7, avg accuracy 0.4305832157348671 over 5 splits
subject 8, avg accuracy 0.45789473841064854 over 5 splits
subject 9, avg accuracy 0.39729729953565096 over 5 splits
subject 11, avg accuracy 0.3189189190800126 over 5 splits
subject 12, avg accuracy 0.31578947431162785 over 5 splits
subject 13, avg accuracy 0.3561877683631726 over 5 splits
subject 14, avg accuracy 0.4294197040329739 over 5 splits
subject 15, avg accuracy 0.46936936953046293 over 5 splits
subject 16, avg accuracy 0.38083670839526557 over 5 splits
subject 17, avg accuracy 0.3894736848379436 over 5 splits
subject 18, avg accuracy 0.2648648654286926 over 5 splits
subject 19, avg accuracy 0.331381381542475 over 5 splits
avg accuracy over all subjects 0.4017442216041829
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_16 (LSTM)               (None, 43)                139664    
_________________________________________________________________
dropout_16 (Dropout)         (None, 43)                0         
_________________________________________________________________
dense_31 (Dense)             (None, 29)                1276      
_________________________________________________________________
dense_32 (Dense)             (None, 3)                 90        
=================================================================
Total params: 141,030
Trainable params: 141,030
Non-trainable params: 0
_________________________________________________________________
first 43, second 29, dropout 0.2945545833296873
subject 1, avg accuracy 0.47027027204230026 over 5 splits
subject 2, avg accuracy 0.4219061166556767 over 5 splits
subject 3, avg accuracy 0.3815078244185549 over 5 splits
subject 4, avg accuracy 0.43243243356008787 over 5 splits
subject 5, avg accuracy 0.48762446736882453 over 5 splits
subject 6, avg accuracy 0.5490991007100355 over 5 splits
subject 7, avg accuracy 0.44110953145227255 over 5 splits
subject 8, avg accuracy 0.5052631588358627 over 5 splits
subject 9, avg accuracy 0.381081082450377 over 5 splits
subject 11, avg accuracy 0.3686186187797123 over 5 splits
subject 12, avg accuracy 0.3368421062042839 over 5 splits
subject 13, avg accuracy 0.3405405414095983 over 5 splits
subject 14, avg accuracy 0.40323886701211265 over 5 splits
subject 15, avg accuracy 0.39819819827874503 over 5 splits
subject 16, avg accuracy 0.34412955574178505 over 5 splits
subject 17, avg accuracy 0.500000000941126 over 5 splits
subject 18, avg accuracy 0.3675675681313953 over 5 splits
subject 19, avg accuracy 0.3818318318318318 over 5 splits
avg accuracy over all subjects 0.41729229310136573
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_17 (LSTM)               (None, 14)                43848     
_________________________________________________________________
dropout_17 (Dropout)         (None, 14)                0         
_________________________________________________________________
dense_33 (Dense)             (None, 24)                360       
_________________________________________________________________
dense_34 (Dense)             (None, 3)                 75        
=================================================================
Total params: 44,283
Trainable params: 44,283
Non-trainable params: 0
_________________________________________________________________
first 14, second 24, dropout 0.4134779720055446
subject 1, avg accuracy 0.3783783805531424 over 5 splits
subject 2, avg accuracy 0.37951635918440896 over 5 splits
subject 3, avg accuracy 0.3489331451918967 over 5 splits
subject 4, avg accuracy 0.32432432512979253 over 5 splits
subject 5, avg accuracy 0.3908961610002165 over 5 splits
subject 6, avg accuracy 0.456456457100831 over 5 splits
subject 7, avg accuracy 0.3674253217229463 over 5 splits
subject 8, avg accuracy 0.4263157901011015 over 5 splits
subject 9, avg accuracy 0.3769559043188013 over 5 splits
subject 11, avg accuracy 0.33513513529622874 over 5 splits
subject 12, avg accuracy 0.3894736857790696 over 5 splits
subject 13, avg accuracy 0.37780938904790756 over 5 splits
subject 14, avg accuracy 0.4549257764449486 over 5 splits
subject 15, avg accuracy 0.43603603619712966 over 5 splits
subject 16, avg accuracy 0.3333333349622052 over 5 splits
subject 17, avg accuracy 0.42631579010110154 over 5 splits
subject 18, avg accuracy 0.34594594699305453 over 5 splits
subject 19, avg accuracy 0.35885885893940567 over 5 splits
avg accuracy over all subjects 0.38372421100356596
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_18 (LSTM)               (None, 19)                59888     
_________________________________________________________________
dropout_18 (Dropout)         (None, 19)                0         
_________________________________________________________________
dense_35 (Dense)             (None, 25)                500       
_________________________________________________________________
dense_36 (Dense)             (None, 3)                 78        
=================================================================
Total params: 60,466
Trainable params: 60,466
Non-trainable params: 0
_________________________________________________________________
first 19, second 25, dropout 0.19583517656089572
subject 1, avg accuracy 0.42162162266873027 over 5 splits
subject 2, avg accuracy 0.40099573488510176 over 5 splits
subject 3, avg accuracy 0.45135135344556865 over 5 splits
subject 4, avg accuracy 0.3945945955611564 over 5 splits
subject 5, avg accuracy 0.486913229997772 over 5 splits
subject 6, avg accuracy 0.4729729741006284 over 5 splits
subject 7, avg accuracy 0.4844950222782526 over 5 splits
subject 8, avg accuracy 0.4684210534158506 over 5 splits
subject 9, avg accuracy 0.3759601722274023 over 5 splits
subject 11, avg accuracy 0.3674174176590579 over 5 splits
subject 12, avg accuracy 0.33157894846640135 over 5 splits
subject 13, avg accuracy 0.38378378433913285 over 5 splits
subject 14, avg accuracy 0.4554655881384928 over 5 splits
subject 15, avg accuracy 0.37582582590637265 over 5 splits
subject 16, avg accuracy 0.3956815127097322 over 5 splits
subject 17, avg accuracy 0.38947368389681764 over 5 splits
subject 18, avg accuracy 0.37837837918384654 over 5 splits
subject 19, avg accuracy 0.3924924926535861 over 5 splits
avg accuracy over all subjects 0.41263463286299457
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_19 (LSTM)               (None, 19)                59888     
_________________________________________________________________
dropout_19 (Dropout)         (None, 19)                0         
_________________________________________________________________
dense_37 (Dense)             (None, 28)                560       
_________________________________________________________________
dense_38 (Dense)             (None, 3)                 87        
=================================================================
Total params: 60,535
Trainable params: 60,535
Non-trainable params: 0
_________________________________________________________________
first 19, second 28, dropout 0.7221051537465807
subject 1, avg accuracy 0.4378378402542423 over 5 splits
subject 2, avg accuracy 0.3475106693560504 over 5 splits
subject 3, avg accuracy 0.3544807977857834 over 5 splits
subject 4, avg accuracy 0.4000000015303895 over 5 splits
subject 5, avg accuracy 0.47624466636272444 over 5 splits
subject 6, avg accuracy 0.4783783804725957 over 5 splits
subject 7, avg accuracy 0.4729729740921497 over 5 splits
subject 8, avg accuracy 0.46315789661909407 over 5 splits
subject 9, avg accuracy 0.40384068488226854 over 5 splits
subject 11, avg accuracy 0.30255255255255253 over 5 splits
subject 12, avg accuracy 0.3263157901011015 over 5 splits
subject 13, avg accuracy 0.40455192144785296 over 5 splits
subject 14, avg accuracy 0.38758434672989506 over 5 splits
subject 15, avg accuracy 0.3321321321321321 over 5 splits
subject 16, avg accuracy 0.3593792190596804 over 5 splits
subject 17, avg accuracy 0.45263158051591174 over 5 splits
subject 18, avg accuracy 0.30810810923576354 over 5 splits
subject 19, avg accuracy 0.4138138144581884 over 5 splits
avg accuracy over all subjects 0.395638520977132
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_20 (LSTM)               (None, 42)                136248    
_________________________________________________________________
dropout_20 (Dropout)         (None, 42)                0         
_________________________________________________________________
dense_39 (Dense)             (None, 10)                430       
_________________________________________________________________
dense_40 (Dense)             (None, 3)                 33        
=================================================================
Total params: 136,711
Trainable params: 136,711
Non-trainable params: 0
_________________________________________________________________
first 42, second 10, dropout 0.6187497937740736
subject 1, avg accuracy 0.5081081103634191 over 5 splits
subject 2, avg accuracy 0.37354196388470495 over 5 splits
subject 3, avg accuracy 0.36543385642945003 over 5 splits
subject 4, avg accuracy 0.48108108269201744 over 5 splits
subject 5, avg accuracy 0.4551920354027158 over 5 splits
subject 6, avg accuracy 0.4729729746644561 over 5 splits
subject 7, avg accuracy 0.46827880545581557 over 5 splits
subject 8, avg accuracy 0.4789473679504896 over 5 splits
subject 9, avg accuracy 0.4674253212651013 over 5 splits
subject 11, avg accuracy 0.4283783791032997 over 5 splits
subject 12, avg accuracy 0.31052631641689094 over 5 splits
subject 13, avg accuracy 0.388051210769888 over 5 splits
subject 14, avg accuracy 0.4245614043654379 over 5 splits
subject 15, avg accuracy 0.4193693694499162 over 5 splits
subject 16, avg accuracy 0.42672064885517197 over 5 splits
subject 17, avg accuracy 0.5263157886894125 over 5 splits
subject 18, avg accuracy 0.3567567574011313 over 5 splits
subject 19, avg accuracy 0.40900900917010263 over 5 splits
avg accuracy over all subjects 0.4311483556849678
end time
Tue Feb 20 02:21:40 CET 2018
slurmstepd: error: Exceeded step memory limit at some point.
